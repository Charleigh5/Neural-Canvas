[{"filePath":"C:\\Users\\cweir\\Downloads\\neural-canvas\\components\\AssetsView.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":290,"column":30,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":290,"endColumn":33,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[10619,10622],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[10619,10622],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react/jsx-no-comment-textnodes","severity":2,"message":"Comments inside children section of tag should be placed inside braces","line":343,"column":69,"nodeType":"JSXText","messageId":"putCommentInBraces","endLine":343,"endColumn":72}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useRef, useState, useEffect } from \"react\";\nimport { useStore } from \"../store/useStore\";\nimport { TiltCard } from \"./ui/TiltCard\";\nimport {\n  Upload,\n  Box,\n  Clock,\n  Tag,\n  Cloud,\n  CloudLightning,\n  Camera,\n  CheckCircle2,\n  Loader2,\n  UploadCloud,\n} from \"lucide-react\";\nimport { GooglePhotosBrowser } from \"./GooglePhotosBrowser\";\nimport { useImage } from \"../hooks/useImage\";\nimport { motion, AnimatePresence } from \"framer-motion\";\n\n// --- SMART THUMBNAIL COMPONENT ---\n// Resolves secure IDB blobs into viewable URLs or draws ImageBitmap\nconst AssetThumbnail = ({\n  url,\n  className,\n}: {\n  url: string;\n  className: string;\n}) => {\n  const [img, status] = useImage(url);\n  const canvasRef = useRef<HTMLCanvasElement>(null);\n\n  useEffect(() => {\n    if (\n      status === \"loaded\" &&\n      img instanceof ImageBitmap &&\n      canvasRef.current\n    ) {\n      const ctx = canvasRef.current.getContext(\"2d\");\n      if (ctx) {\n        // Ensure canvas resolution matches image\n        canvasRef.current.width = img.width;\n        canvasRef.current.height = img.height;\n        ctx.drawImage(img, 0, 0);\n      }\n    }\n  }, [img, status]);\n\n  if (status === \"loading\")\n    return <div className=\"absolute inset-0 bg-white/5 animate-pulse\" />;\n  if (status === \"failed\" || !img)\n    return (\n      <div className=\"absolute inset-0 bg-rose-900/20 flex items-center justify-center text-[8px] text-rose-500\">\n        ERR\n      </div>\n    );\n\n  if (img instanceof ImageBitmap) {\n    return <canvas ref={canvasRef} className={className} />;\n  }\n\n  return (\n    <img\n      src={(img as HTMLImageElement).src}\n      className={className}\n      alt=\"asset\"\n    />\n  );\n};\n\nexport const AssetsView: React.FC = () => {\n  const { images, addImage, selectedIds, setSelectedIds, setCameraOpen } =\n    useStore();\n  const fileInputRef = useRef<HTMLInputElement>(null);\n  const [showGooglePhotos, setShowGooglePhotos] = useState(false);\n  const [isDragging, setIsDragging] = useState(false);\n\n  const handleFileProcess = (files: FileList | File[]) => {\n    const fileArray = Array.from(files).filter((f) =>\n      f.type.startsWith(\"image/\")\n    );\n\n    // GRID CONFIG\n    const COLS = 5;\n    const CELL_SIZE = 250;\n\n    fileArray.forEach((file: File, index) => {\n      const col = index % COLS;\n      const row = Math.floor(index / COLS);\n      const x = 100 + col * CELL_SIZE;\n      const y = 100 + row * CELL_SIZE;\n\n      const reader = new FileReader();\n      reader.onload = (ev) => {\n        const src = ev.target?.result as string;\n        const imgObj = new window.Image();\n        imgObj.src = src;\n        imgObj.onload = () => {\n          addImage({\n            id: Math.random().toString(36).substring(2, 11),\n            url: src,\n            file: file,\n            width: 200,\n            height: 200 * (imgObj.height / imgObj.width),\n            x: x,\n            y: y,\n            rotation: 0,\n            scale: 1,\n            tags: [\"imported\"],\n            analyzed: false,\n            timestamp: Date.now(),\n          });\n        };\n      };\n      reader.readAsDataURL(file);\n    });\n  };\n\n  const handleFileUpload = (e: React.ChangeEvent<HTMLInputElement>) => {\n    if (e.target.files && e.target.files.length > 0) {\n      handleFileProcess(e.target.files);\n    }\n  };\n\n  const handleDragOver = (e: React.DragEvent) => {\n    e.preventDefault();\n    setIsDragging(true);\n  };\n\n  const handleDragLeave = (e: React.DragEvent) => {\n    // Only disable if we are leaving the main container\n    if (!e.currentTarget.contains(e.relatedTarget as Node)) {\n      setIsDragging(false);\n    }\n  };\n\n  const handleDrop = (e: React.DragEvent) => {\n    e.preventDefault();\n    setIsDragging(false);\n    if (e.dataTransfer.files && e.dataTransfer.files.length > 0) {\n      handleFileProcess(e.dataTransfer.files);\n    }\n  };\n\n  const toggleSelection = (id: string, event: React.MouseEvent) => {\n    if (event.shiftKey || event.ctrlKey || event.metaKey) {\n      setSelectedIds(\n        selectedIds.includes(id)\n          ? selectedIds.filter((sid) => sid !== id)\n          : [...selectedIds, id]\n      );\n    } else {\n      setSelectedIds([id]);\n    }\n  };\n\n  return (\n    <div\n      className=\"w-full h-full p-8 overflow-y-auto custom-scrollbar bg-[#050505] relative\"\n      onDragOver={handleDragOver}\n      onDragLeave={handleDragLeave}\n      onDrop={handleDrop}\n    >\n      {showGooglePhotos && (\n        <GooglePhotosBrowser onClose={() => setShowGooglePhotos(false)} />\n      )}\n\n      {/* DRAG OVERLAY */}\n      <AnimatePresence>\n        {isDragging && (\n          <motion.div\n            initial={{ opacity: 0 }}\n            animate={{ opacity: 1 }}\n            exit={{ opacity: 0 }}\n            className=\"absolute inset-0 z-50 bg-indigo-500/20 backdrop-blur-sm border-4 border-dashed border-indigo-400/50 flex flex-col items-center justify-center pointer-events-none rounded-3xl m-4\"\n          >\n            <div className=\"bg-black/80 p-8 rounded-3xl border border-white/10 flex flex-col items-center animate-bounce shadow-2xl backdrop-blur-md\">\n              <UploadCloud size={64} className=\"text-indigo-400 mb-4\" />\n              <span className=\"text-xl font-black text-white uppercase tracking-[0.2em]\">\n                Release Payload\n              </span>\n              <span className=\"text-xs font-mono text-indigo-300 mt-2\">\n                Ingesting assets to secure vault...\n              </span>\n            </div>\n          </motion.div>\n        )}\n      </AnimatePresence>\n\n      <div className=\"max-w-7xl mx-auto\">\n        <div className=\"flex items-center justify-between mb-8 border-b border-white/5 pb-6\">\n          <div className=\"flex flex-col\">\n            <h2 className=\"text-3xl font-black tracking-tighter text-white flex items-center gap-4\">\n              <Box className=\"text-indigo-500\" size={28} />\n              INVENTORY_MANIFEST\n            </h2>\n            <div className=\"flex items-center gap-4 mt-2\">\n              <p className=\"text-[10px] font-mono text-slate-500 uppercase tracking-[0.4em]\">\n                Secure_Asset_Vault // System_Ready\n              </p>\n              {showGooglePhotos && (\n                <div className=\"flex items-center gap-2 px-3 py-1 bg-indigo-500/10 border border-indigo-500/20 rounded-full animate-in slide-in-from-left-2\">\n                  <Loader2 size={10} className=\"text-indigo-400 animate-spin\" />\n                  <span className=\"text-[8px] font-black text-indigo-400 uppercase tracking-widest\">\n                    Quantum_Bridge_Active\n                  </span>\n                </div>\n              )}\n            </div>\n          </div>\n          <div className=\"flex items-center gap-6\">\n            <div className=\"text-right\">\n              <div className=\"text-[8px] font-black text-slate-500 uppercase tracking-widest\">\n                Total_indexed\n              </div>\n              <div className=\"text-lg font-mono text-indigo-400\">\n                {images.length}\n              </div>\n            </div>\n            {selectedIds.length > 0 && (\n              <div className=\"text-right border-l border-white/10 pl-6\">\n                <div className=\"text-[8px] font-black text-rose-500 uppercase tracking-widest\">\n                  Selected_nodes\n                </div>\n                <div className=\"text-lg font-mono text-rose-500\">\n                  {selectedIds.length}\n                </div>\n              </div>\n            )}\n          </div>\n        </div>\n\n        <div className=\"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-5 gap-6\">\n          {/* --- PROMINENT UPLOAD BUTTON --- */}\n          <button\n            onClick={() => fileInputRef.current?.click()}\n            className=\"aspect-square bg-white/5 border-2 border-dashed border-indigo-500/20 rounded-2xl flex flex-col items-center justify-center group hover:bg-indigo-500/10 hover:border-indigo-500/50 transition-all cursor-pointer\"\n            aria-label=\"Upload images\"\n          >\n            <div className=\"w-12 h-12 bg-indigo-500/10 rounded-full flex items-center justify-center mb-4 group-hover:scale-110 group-hover:bg-indigo-500/20 transition-all duration-500 shadow-xl\">\n              <Upload className=\"text-indigo-400\" size={24} />\n            </div>\n            <span className=\"text-[10px] font-black text-indigo-300 tracking-[0.3em] uppercase\">\n              Ingest_Data\n            </span>\n          </button>\n          <input\n            type=\"file\"\n            ref={fileInputRef}\n            className=\"hidden\"\n            multiple\n            accept=\"image/*\"\n            onChange={handleFileUpload}\n            aria-label=\"Select images to upload\"\n          />\n\n          {/* --- GOOGLE PHOTOS CONNECT --- */}\n          <button\n            onClick={() => setShowGooglePhotos(true)}\n            className=\"aspect-square bg-white/5 border-2 border-dashed border-slate-700 rounded-2xl flex flex-col items-center justify-center group hover:bg-slate-800/30 hover:border-slate-500 transition-all cursor-pointer\"\n          >\n            <div className=\"w-12 h-12 bg-white/5 rounded-full flex items-center justify-center mb-4 group-hover:scale-110 transition-all duration-500\">\n              <Cloud className=\"text-slate-400\" size={24} />\n            </div>\n            <span className=\"text-[10px] font-black text-slate-500 tracking-[0.2em] uppercase text-center px-4 leading-relaxed\">\n              Connect_Cloud\n            </span>\n          </button>\n\n          {/* --- CAMERA INPUT --- */}\n          <button\n            onClick={() => setCameraOpen(true)}\n            className=\"aspect-square bg-rose-500/5 border-2 border-dashed border-rose-500/20 rounded-2xl flex flex-col items-center justify-center group hover:bg-rose-500/10 hover:border-rose-500/50 transition-all cursor-pointer\"\n          >\n            <div className=\"w-12 h-12 bg-rose-500/10 rounded-full flex items-center justify-center mb-4 group-hover:scale-110 group-hover:bg-rose-500/20 transition-all duration-500 shadow-xl\">\n              <Camera className=\"text-rose-500\" size={24} />\n            </div>\n            <span className=\"text-[10px] font-black text-rose-400 tracking-[0.2em] uppercase text-center px-4 leading-relaxed\">\n              Neural_Optic\n            </span>\n          </button>\n\n          {/* --- ASSET LIST --- */}\n          {images.map((img) => {\n            const isSelected = selectedIds.includes(img.id);\n            return (\n              <TiltCard\n                key={img.id}\n                className=\"aspect-square flex flex-col p-0 rounded-2xl group\"\n                selected={isSelected}\n                onClick={(e: any) => toggleSelection(img.id, e)}\n              >\n                <div className=\"flex-1 relative overflow-hidden bg-black/40\">\n                  <AssetThumbnail\n                    url={img.url}\n                    className={`absolute inset-0 w-full h-full object-cover transition-all duration-700 ${\n                      isSelected\n                        ? \"scale-110 opacity-100\"\n                        : \"opacity-60 group-hover:opacity-90\"\n                    }`}\n                  />\n\n                  {/* Selection Overlay */}\n                  {isSelected && (\n                    <div className=\"absolute top-3 left-3 z-30 bg-indigo-500 text-white p-1 rounded-full shadow-lg border border-indigo-400 animate-in zoom-in duration-200\">\n                      <CheckCircle2 size={14} />\n                    </div>\n                  )}\n\n                  {img.analyzed ? (\n                    <div className=\"absolute top-3 right-3 w-2 h-2 bg-emerald-500 rounded-full shadow-[0_0_10px_#10b981]\" />\n                  ) : (\n                    <div className=\"absolute top-3 right-3 w-2 h-2 bg-amber-500 rounded-full animate-pulse shadow-[0_0_10px_#f59e0b]\" />\n                  )}\n\n                  {img.variantType === \"edit\" && (\n                    <div className=\"absolute bottom-3 left-3 px-2 py-1 bg-indigo-900/80 border border-indigo-500/50 rounded-md text-[8px] text-indigo-200 font-mono flex items-center gap-1.5 backdrop-blur-md\">\n                      <CloudLightning size={10} className=\"text-indigo-400\" />{\" \"}\n                      REMIX_V1\n                    </div>\n                  )}\n                </div>\n                <div\n                  className={`h-20 border-t transition-colors duration-300 p-4 flex flex-col justify-center gap-1.5 ${\n                    isSelected\n                      ? \"bg-indigo-950/40 border-indigo-500/30\"\n                      : \"bg-slate-900/20 border-white/5\"\n                  }`}\n                >\n                  <div className=\"flex items-center gap-2 text-[10px] text-white font-black tracking-widest uppercase truncate\">\n                    <Tag\n                      size={12}\n                      className={\n                        isSelected ? \"text-indigo-400\" : \"text-slate-600\"\n                      }\n                    />\n                    <span className=\"truncate\">\n                      {img.tags[0] || \"INDEXING...\"}\n                    </span>\n                  </div>\n                  <div className=\"flex items-center gap-2 text-[9px] text-slate-500 font-mono tracking-tighter\">\n                    <Clock size={10} className=\"opacity-50\" />\n                    <span>\n                      {new Date(img.timestamp).toLocaleTimeString()} //{\" \"}\n                      {img.width}x{img.height}\n                    </span>\n                  </div>\n                </div>\n              </TiltCard>\n            );\n          })}\n        </div>\n      </div>\n      {/* Ambient Background Grid Spacing */}\n      <div className=\"h-40\" />\n    </div>\n  );\n};\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\cweir\\Downloads\\neural-canvas\\components\\AudioController.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\cweir\\Downloads\\neural-canvas\\components\\AudioWaveform.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\cweir\\Downloads\\neural-canvas\\components\\CameraCapture.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Video' is defined but never used. Allowed unused vars must match /^_/u.","line":7,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":7,"endColumn":8},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Camera' is defined but never used. Allowed unused vars must match /^_/u.","line":8,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":8,"endColumn":9},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Zap' is defined but never used. Allowed unused vars must match /^_/u.","line":12,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":12,"endColumn":6},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Activity' is defined but never used. Allowed unused vars must match /^_/u.","line":13,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":13,"endColumn":11},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":59,"column":19,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":59,"endColumn":22,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1679,1682],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1679,1682],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":90,"column":19,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":90,"endColumn":22,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2437,2440],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2437,2440],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'startCamera'. Either include it or remove the dependency array.","line":97,"column":6,"nodeType":"ArrayExpression","endLine":97,"endColumn":18,"suggestions":[{"desc":"Update the dependencies array to be: [facingMode, startCamera]","fix":{"range":[2571,2583],"text":"[facingMode, startCamera]"}}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":106,"column":43,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":106,"endColumn":46,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2811,2814],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2811,2814],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'e' is defined but never used.","line":123,"column":14,"nodeType":null,"messageId":"unusedVar","endLine":123,"endColumn":15}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":9,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useRef, useState, useEffect } from \"react\";\nimport {\n  X,\n  RefreshCw,\n  AlertTriangle,\n  Cpu,\n  Video,\n  Camera,\n  Square,\n  Eye,\n  EyeOff,\n  Zap,\n  Activity,\n  CheckCircle2,\n  Loader2,\n  Sparkles,\n  Image as ImageIcon,\n} from \"lucide-react\";\nimport { useStore } from \"../store/useStore\";\nimport { AppMode, ImageAsset } from \"../types\";\nimport { motion, AnimatePresence } from \"framer-motion\";\n\nexport const CameraCapture: React.FC<{ onClose: () => void }> = ({\n  onClose,\n}) => {\n  const videoRef = useRef<HTMLVideoElement>(null);\n  const canvasRef = useRef<HTMLCanvasElement>(null);\n  const mediaRecorderRef = useRef<MediaRecorder | null>(null);\n  const chunksRef = useRef<Blob[]>([]);\n\n  const { addImage, images, processingIds, setCameraOpen, setMode } =\n    useStore();\n\n  const [stream, setStream] = useState<MediaStream | null>(null);\n  const [facingMode, setFacingMode] = useState<\"user\" | \"environment\">(\n    \"environment\"\n  );\n  const [error, setError] = useState<string | null>(null);\n  const [flash, setFlash] = useState(false);\n  const [mode, setModeState] = useState<\"photo\" | \"video\">(\"photo\");\n  const [isRecording, setIsRecording] = useState(false);\n  const [recordingTime, setRecordingTime] = useState(0);\n  const [showHud, setShowHud] = useState(true);\n\n  // Track IDs captured in this session for the local HUD\n  const [sessionCaptures, setSessionCaptures] = useState<string[]>([]);\n\n  useEffect(() => {\n    setCameraOpen(true);\n    return () => {\n      setCameraOpen(false);\n      if (stream) {\n        stream.getTracks().forEach((track) => track.stop());\n      }\n    };\n  }, [setCameraOpen, stream]);\n\n  useEffect(() => {\n    let interval: any;\n    if (isRecording) {\n      interval = setInterval(() => {\n        setRecordingTime((prev) => prev + 1);\n      }, 1000);\n    } else {\n      setRecordingTime(0);\n    }\n    return () => clearInterval(interval);\n  }, [isRecording]);\n\n  const startCamera = async () => {\n    try {\n      if (stream) {\n        stream.getTracks().forEach((track) => track.stop());\n      }\n\n      const newStream = await navigator.mediaDevices.getUserMedia({\n        video: {\n          facingMode: facingMode,\n          width: { ideal: 1920 },\n          height: { ideal: 1080 },\n        },\n        audio: true,\n      });\n\n      setStream(newStream);\n      if (videoRef.current) {\n        videoRef.current.srcObject = newStream;\n      }\n      setError(null);\n    } catch (err: any) {\n      setError(err.message || \"SENSORY_INPUT_FAILURE: ACCESS DENIED\");\n    }\n  };\n\n  useEffect(() => {\n    startCamera();\n  }, [facingMode]);\n\n  const toggleCamera = () => {\n    setFacingMode((prev) => (prev === \"user\" ? \"environment\" : \"user\"));\n  };\n\n  const playShutterSound = () => {\n    try {\n      const AudioContext =\n        window.AudioContext || (window as any).webkitAudioContext;\n      const ctx = new AudioContext();\n      const osc = ctx.createOscillator();\n      const gain = ctx.createGain();\n\n      osc.type = \"sine\";\n      osc.frequency.setValueAtTime(880, ctx.currentTime);\n      osc.frequency.exponentialRampToValueAtTime(110, ctx.currentTime + 0.1);\n\n      gain.gain.setValueAtTime(0.3, ctx.currentTime);\n      gain.gain.exponentialRampToValueAtTime(0.01, ctx.currentTime + 0.1);\n\n      osc.connect(gain);\n      gain.connect(ctx.destination);\n\n      osc.start();\n      osc.stop(ctx.currentTime + 0.1);\n    } catch (e) {\n      /* Fallback for browser restrictions */\n    }\n  };\n\n  const capturePhoto = async () => {\n    if (!videoRef.current || !canvasRef.current) return;\n\n    const video = videoRef.current;\n    const canvas = canvasRef.current;\n    const context = canvas.getContext(\"2d\");\n\n    if (context) {\n      canvas.width = video.videoWidth;\n      canvas.height = video.videoHeight;\n\n      context.save();\n      if (facingMode === \"user\") {\n        context.translate(canvas.width, 0);\n        context.scale(-1, 1);\n      }\n      context.drawImage(video, 0, 0, canvas.width, canvas.height);\n      context.restore();\n\n      const dataUrl = canvas.toDataURL(\"image/jpeg\", 0.95);\n\n      setFlash(true);\n      playShutterSound();\n      setTimeout(() => setFlash(false), 100);\n\n      const id = Math.random().toString(36).substring(2, 11);\n      const newItem: ImageAsset = {\n        id,\n        url: dataUrl,\n        width: canvas.width,\n        height: canvas.height,\n        x: 100 + Math.random() * 200,\n        y: 100 + Math.random() * 200,\n        rotation: 0,\n        scale: 1,\n        tags: [\"camera_capture\", \"neural_optic\"],\n        analyzed: false,\n        timestamp: Date.now(),\n        primaryTag: \"NEURAL_STILL\",\n        mediaType: \"image\",\n      };\n\n      setSessionCaptures((prev) => [id, ...prev]);\n      await addImage(newItem);\n    }\n  };\n\n  const toggleRecording = () => {\n    if (isRecording) {\n      mediaRecorderRef.current?.stop();\n      setIsRecording(false);\n    } else {\n      if (!stream) return;\n      const mediaRecorder = new MediaRecorder(stream);\n      mediaRecorderRef.current = mediaRecorder;\n      chunksRef.current = [];\n\n      mediaRecorder.ondataavailable = (e) => {\n        if (e.data.size > 0) chunksRef.current.push(e.data);\n      };\n\n      mediaRecorder.onstop = async () => {\n        const blob = new Blob(chunksRef.current, { type: \"video/webm\" });\n        const url = URL.createObjectURL(blob);\n        const id = Math.random().toString(36).substring(2, 11);\n\n        const newItem: ImageAsset = {\n          id,\n          url: url,\n          width: 400,\n          height: 300,\n          x: 100 + Math.random() * 200,\n          y: 100 + Math.random() * 200,\n          rotation: 0,\n          scale: 1,\n          tags: [\"video_log\", \"neural_clip\"],\n          analyzed: false,\n          timestamp: Date.now(),\n          primaryTag: \"NEURAL_VIDEO\",\n          mediaType: \"video\",\n        };\n        setSessionCaptures((prev) => [id, ...prev]);\n        await addImage(newItem);\n      };\n\n      mediaRecorder.start();\n      setIsRecording(true);\n    }\n  };\n\n  const capturedItems = sessionCaptures\n    .map((id) => images.find((img) => img.id === id))\n    .filter(Boolean) as ImageAsset[];\n\n  return (\n    <div className=\"fixed inset-0 z-[200] bg-black flex flex-col animate-in fade-in duration-500 overflow-hidden select-none\">\n      <AnimatePresence>\n        {flash && (\n          <motion.div\n            initial={{ opacity: 0 }}\n            animate={{ opacity: 1 }}\n            exit={{ opacity: 0 }}\n            className=\"absolute inset-0 bg-white z-[300] pointer-events-none\"\n          />\n        )}\n      </AnimatePresence>\n\n      <div className=\"flex-1 relative bg-[#05080f] overflow-hidden flex items-center justify-center\">\n        {error ? (\n          <div className=\"z-50 flex flex-col items-center gap-6 p-12 border border-rose-500/30 bg-rose-950/20 backdrop-blur-2xl rounded-2xl max-w-lg text-center\">\n            <AlertTriangle size={64} className=\"text-rose-500 animate-pulse\" />\n            <div className=\"space-y-2\">\n              <h2 className=\"text-rose-400 font-mono font-black tracking-[0.2em]\">\n                SENSOR_DENIED_ERROR\n              </h2>\n              <p className=\"text-rose-500/60 text-xs font-mono\">{error}</p>\n            </div>\n            <div className=\"flex gap-4\">\n              <button\n                onClick={startCamera}\n                className=\"px-8 py-3 bg-rose-500 text-black font-black text-[10px] tracking-widest rounded uppercase\"\n              >\n                Retry_System\n              </button>\n              <button\n                onClick={onClose}\n                className=\"px-8 py-3 border border-rose-500/50 text-rose-500 font-black text-[10px] tracking-widest rounded uppercase\"\n              >\n                Terminate\n              </button>\n            </div>\n          </div>\n        ) : (\n          <>\n            <video\n              ref={videoRef}\n              autoPlay\n              playsInline\n              muted\n              className={`w-full h-full object-cover transition-opacity duration-1000 ${\n                facingMode === \"user\" ? \"scale-x-[-1]\" : \"\"\n              }`}\n            />\n\n            <AnimatePresence>\n              {showHud && (\n                <motion.div\n                  initial={{ opacity: 0 }}\n                  animate={{ opacity: 1 }}\n                  exit={{ opacity: 0 }}\n                  className=\"absolute inset-0 pointer-events-none z-20\"\n                >\n                  <div className=\"absolute inset-0 bg-[radial-gradient(circle_at_center,transparent_40%,rgba(0,0,0,0.6)_100%)]\" />\n\n                  {/* Telemetry Layer */}\n                  <div className=\"absolute top-10 left-10 right-10 flex justify-between items-start font-mono text-[10px] tracking-[0.15em] uppercase\">\n                    <div className=\"flex flex-col gap-2\">\n                      <div className=\"flex items-center gap-2\">\n                        <div className=\"bg-[#121b2d]/90 border border-cyan-500/40 px-3 py-1.5 rounded-[2px] flex items-center gap-2 backdrop-blur-sm shadow-xl\">\n                          <Cpu size={12} className=\"text-cyan-400\" />\n                          <span className=\"text-cyan-400 font-black\">\n                            NEURAL_OPTIC_LIVE\n                          </span>\n                        </div>\n                      </div>\n                    </div>\n                    <div className=\"text-right text-slate-400/60 font-bold bg-black/40 backdrop-blur-sm p-3 rounded-[2px] border border-white/5\">\n                      STREAMING_RESOLUTION: 1080P\n                      <br />\n                      FPS: 60.0 &nbsp; LATENCY: 12ms\n                      <br />\n                      {isRecording ? (\n                        <span className=\"text-rose-500 font-bold\">\n                          REC_TIME: {formatTime(recordingTime)}\n                        </span>\n                      ) : (\n                        \"STANDBY\"\n                      )}\n                    </div>\n                  </div>\n\n                  {/* RETICLE */}\n                  <div className=\"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-[450px] h-[450px] flex items-center justify-center opacity-40\">\n                    <div className=\"w-16 h-16 border border-white/20 relative\">\n                      <div className=\"absolute top-1/2 left-0 right-0 h-px bg-white/40\" />\n                      <div className=\"absolute left-1/2 top-0 bottom-0 w-px bg-white/40\" />\n                    </div>\n                    <svg\n                      className=\"absolute inset-0 w-full h-full\"\n                      viewBox=\"0 0 100 100\"\n                    >\n                      <circle\n                        cx=\"50\"\n                        cy=\"50\"\n                        r=\"48\"\n                        fill=\"none\"\n                        stroke=\"white\"\n                        strokeWidth=\"0.1\"\n                        strokeDasharray=\"1 3\"\n                      />\n                      <circle\n                        cx=\"50\"\n                        cy=\"50\"\n                        r=\"40\"\n                        fill=\"none\"\n                        stroke=\"cyan\"\n                        strokeWidth=\"0.05\"\n                        strokeDasharray=\"10 5\"\n                      />\n                    </svg>\n                  </div>\n                </motion.div>\n              )}\n            </AnimatePresence>\n\n            {/* --- RECENT CAPTURES TRAY --- */}\n            <div className=\"absolute bottom-4 left-0 right-0 z-30 pointer-events-none flex justify-center\">\n              <div className=\"flex gap-3 px-6 py-4 bg-black/60 backdrop-blur-3xl border border-white/10 rounded-[32px] pointer-events-auto max-w-[90vw] overflow-x-auto custom-scrollbar shadow-2xl\">\n                <AnimatePresence mode=\"popLayout\">\n                  {capturedItems.map((item, idx) => (\n                    <motion.div\n                      key={item.id}\n                      layout\n                      initial={{ scale: 0, opacity: 0, x: 50 }}\n                      animate={{ scale: 1, opacity: 1, x: 0 }}\n                      className=\"relative group shrink-0\"\n                    >\n                      <div className=\"w-20 h-20 rounded-2xl overflow-hidden border border-white/10 relative shadow-lg\">\n                        <img\n                          src={item.url}\n                          alt={`Captured ${item.mediaType || 'image'} ${idx + 1}`}\n                          className=\"w-full h-full object-cover opacity-80\"\n                        />\n                        <div className=\"absolute inset-0 bg-black/20\" />\n                        {processingIds.includes(item.id) ? (\n                          <div className=\"absolute inset-0 flex items-center justify-center bg-black/40\">\n                            <Loader2\n                              className=\"text-cyan-400 animate-spin\"\n                              size={20}\n                            />\n                          </div>\n                        ) : (\n                          <div className=\"absolute top-1.5 right-1.5 bg-emerald-500 rounded-full p-0.5 shadow-lg\">\n                            <CheckCircle2 size={10} className=\"text-white\" />\n                          </div>\n                        )}\n                      </div>\n                      <span className=\"absolute -bottom-1 -right-1 bg-indigo-600 text-white text-[8px] font-black w-5 h-5 flex items-center justify-center rounded-full border border-black\">\n                        {capturedItems.length - idx}\n                      </span>\n                    </motion.div>\n                  ))}\n                  {capturedItems.length === 0 && (\n                    <div className=\"w-20 h-20 rounded-2xl border-2 border-dashed border-white/5 flex flex-col items-center justify-center gap-1.5 text-slate-700\">\n                      <ImageIcon size={18} />\n                      <span className=\"text-[7px] font-black uppercase tracking-tighter\">\n                        Empty_Roll\n                      </span>\n                    </div>\n                  )}\n                </AnimatePresence>\n              </div>\n            </div>\n          </>\n        )}\n      </div>\n\n      {/* --- CONTROL CONSOLE --- */}\n      <div className=\"h-44 bg-[#04060a] border-t border-white/10 relative z-50 flex items-center justify-between px-12 pb-4\">\n        {/* AUX CONTROLS */}\n        <div className=\"flex items-center gap-4 flex-1\">\n          <button\n            onClick={toggleCamera}\n            className=\"flex flex-col items-center justify-center gap-2 w-20 h-20 bg-[#0d131f] border border-white/5 rounded-2xl group transition-all hover:bg-[#121b2d] hover:border-cyan-500/30\"\n          >\n            <RefreshCw\n              size={22}\n              className=\"text-slate-500 group-hover:text-cyan-400 group-hover:rotate-180 transition-all duration-700\"\n            />\n            <span className=\"text-[9px] font-black font-mono text-slate-600 tracking-tighter group-hover:text-cyan-600 uppercase\">\n              Flip\n            </span>\n          </button>\n\n          <button\n            onClick={() => setShowHud(!showHud)}\n            className={`flex flex-col items-center justify-center gap-2 w-20 h-20 bg-[#0d131f] border border-white/5 rounded-2xl group transition-all hover:bg-[#121b2d] ${\n              showHud ? \"hover:border-cyan-500/30\" : \"border-rose-500/30\"\n            }`}\n          >\n            {showHud ? (\n              <Eye size={22} className=\"text-cyan-400\" />\n            ) : (\n              <EyeOff size={22} className=\"text-rose-400\" />\n            )}\n            <span\n              className={`text-[9px] font-black font-mono tracking-tighter uppercase ${\n                showHud ? \"text-cyan-600\" : \"text-rose-600\"\n              }`}\n            >\n              Hud\n            </span>\n          </button>\n        </div>\n\n        {/* PRIMARY SHUTTER */}\n        <div className=\"relative flex items-center justify-center flex-1\">\n          <div className=\"absolute w-32 h-32 border border-white/5 rounded-full animate-ping opacity-10\" />\n          <motion.button\n            whileHover={{ scale: 1.05 }}\n            whileTap={{ scale: 0.9 }}\n            onClick={mode === \"photo\" ? capturePhoto : toggleRecording}\n            className=\"relative w-28 h-28 rounded-full border-[6px] border-white flex items-center justify-center p-2 transition-all shadow-[0_0_50px_rgba(255,255,255,0.1)] group\"\n          >\n            <div\n              className={`\n                        transition-all duration-500\n                        ${\n                          mode === \"photo\"\n                            ? \"w-full h-full bg-white rounded-full group-active:scale-95\"\n                            : isRecording\n                            ? \"w-14 h-14 bg-rose-600 rounded-[8px]\"\n                            : \"w-20 h-20 bg-rose-600 rounded-full shadow-[0_0_25px_rgba(225,29,72,0.4)]\"\n                        }\n                    `}\n            >\n              {isRecording && (\n                <div className=\"w-full h-full flex items-center justify-center\">\n                  <Square size={24} className=\"text-white fill-white\" />\n                </div>\n              )}\n            </div>\n          </motion.button>\n\n          {/* MODE TOGGLE RADIOS */}\n          <div className=\"absolute -top-12 flex items-center gap-6 bg-black/40 border border-white/5 px-4 py-1.5 rounded-full backdrop-blur-md\">\n            <button\n              onClick={() => setModeState(\"photo\")}\n              className={`text-[9px] font-black uppercase tracking-[0.2em] transition-colors ${\n                mode === \"photo\"\n                  ? \"text-white\"\n                  : \"text-slate-600 hover:text-slate-400\"\n              }`}\n            >\n              Photo\n            </button>\n            <div className=\"w-1 h-1 bg-white/10 rounded-full\" />\n            <button\n              onClick={() => setModeState(\"video\")}\n              className={`text-[9px] font-black uppercase tracking-[0.2em] transition-colors ${\n                mode === \"video\"\n                  ? \"text-rose-500\"\n                  : \"text-slate-600 hover:text-slate-400\"\n              }`}\n            >\n              Video\n            </button>\n          </div>\n        </div>\n\n        {/* TERMINATION / TRANSITION */}\n        <div className=\"flex items-center gap-4 flex-1 justify-end\">\n          <button\n            onClick={() => {\n              setMode(AppMode.CANVAS);\n              onClose();\n            }}\n            className=\"flex flex-col items-center justify-center gap-2 w-20 h-20 bg-indigo-600/10 border border-indigo-500/20 rounded-2xl group transition-all hover:bg-indigo-600/20 hover:border-indigo-400\"\n          >\n            <Sparkles\n              size={22}\n              className=\"text-indigo-400 group-hover:scale-110 transition-transform\"\n            />\n            <span className=\"text-[9px] font-black font-mono text-indigo-500 tracking-tighter group-hover:text-indigo-300 uppercase\">\n              Canvas\n            </span>\n          </button>\n\n          <button\n            onClick={onClose}\n            className=\"flex flex-col items-center justify-center gap-2 w-20 h-20 bg-[#0d131f] border border-white/5 rounded-2xl group transition-all hover:bg-[#1d1214] hover:border-rose-500/30\"\n          >\n            <X\n              size={22}\n              className=\"text-slate-500 group-hover:text-rose-400 transition-colors\"\n            />\n            <span className=\"text-[9px] font-black font-mono text-slate-600 tracking-tighter group-hover:text-rose-600 uppercase\">\n              Close\n            </span>\n          </button>\n        </div>\n      </div>\n      <canvas ref={canvasRef} className=\"hidden\" />\n    </div>\n  );\n};\n\nconst formatTime = (seconds: number) => {\n  const mins = Math.floor(seconds / 60);\n  const secs = seconds % 60;\n  return `${mins}:${secs.toString().padStart(2, \"0\")}`;\n};\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\cweir\\Downloads\\neural-canvas\\components\\CommandDeck.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\cweir\\Downloads\\neural-canvas\\components\\CouncilLogs.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\cweir\\Downloads\\neural-canvas\\components\\ErrorBoundary.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\cweir\\Downloads\\neural-canvas\\components\\ExportModal.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\cweir\\Downloads\\neural-canvas\\components\\FloatingNanoForge.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Wand2' is defined but never used. Allowed unused vars must match /^_/u.","line":5,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":5,"endColumn":8},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Check' is defined but never used. Allowed unused vars must match /^_/u.","line":9,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":9,"endColumn":8},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'ImageIcon' is defined but never used. Allowed unused vars must match /^_/u.","line":12,"column":12,"nodeType":null,"messageId":"unusedVar","endLine":12,"endColumn":21},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Type' is defined but never used. Allowed unused vars must match /^_/u.","line":13,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":13,"endColumn":7},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Camera' is defined but never used. Allowed unused vars must match /^_/u.","line":14,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":14,"endColumn":9},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Gift' is defined but never used. Allowed unused vars must match /^_/u.","line":16,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":16,"endColumn":7},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Star' is defined but never used. Allowed unused vars must match /^_/u.","line":17,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":17,"endColumn":7},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'RefreshCw' is defined but never used. Allowed unused vars must match /^_/u.","line":18,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":18,"endColumn":12},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Languages' is defined but never used. Allowed unused vars must match /^_/u.","line":19,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":19,"endColumn":12},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Trash2' is defined but never used. Allowed unused vars must match /^_/u.","line":23,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":23,"endColumn":9},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'SunDim' is defined but never used. Allowed unused vars must match /^_/u.","line":33,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":33,"endColumn":9},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Wind' is defined but never used. Allowed unused vars must match /^_/u.","line":34,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":34,"endColumn":7},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Flame' is defined but never used. Allowed unused vars must match /^_/u.","line":40,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":40,"endColumn":8},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'ImageMinus' is defined but never used. Allowed unused vars must match /^_/u.","line":44,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":44,"endColumn":13},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Sliders' is defined but never used. Allowed unused vars must match /^_/u.","line":45,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":45,"endColumn":10},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Image' is defined but never used. Allowed unused vars must match /^_/u.","line":47,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":47,"endColumn":8},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'ArrowUpRight' is defined but never used. Allowed unused vars must match /^_/u.","line":57,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":57,"endColumn":15},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'applySmartCrop' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":96,"column":5,"nodeType":null,"messageId":"unusedVar","endLine":96,"endColumn":19},{"ruleId":"@typescript-eslint/no-non-null-assertion","severity":1,"message":"Forbidden non-null assertion.","line":460,"column":31,"nodeType":"TSNonNullExpression","messageId":"noNonNull","endLine":460,"endColumn":36,"suggestions":[{"messageId":"suggestOptionalChain","fix":{"range":[13068,13069],"text":"?"},"desc":"Consider using the optional chain operator `?.` instead. This operator includes runtime checks, so it is safer than the compile-only non-null assertion operator."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":1563,"column":58,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":1563,"endColumn":61,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[65335,65338],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[65335,65338],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":1583,"column":51,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":1583,"endColumn":54,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[66134,66137],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[66134,66137],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":1597,"column":76,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":1597,"endColumn":79,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[66600,66603],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[66600,66603],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":22,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useRef, useEffect } from 'react';\nimport { motion, AnimatePresence } from 'framer-motion';\nimport {\n  Sparkles,\n  Wand2,\n  Palette,\n  Zap,\n  X,\n  Check,\n  Loader2,\n  Eraser,\n  Image as ImageIcon,\n  Type,\n  Camera,\n  Snowflake,\n  Gift,\n  Star,\n  RefreshCw,\n  Languages,\n  Lightbulb,\n  PenTool,\n  Target,\n  Trash2,\n  PlusCircle,\n  Focus,\n  MousePointer2,\n  Brush,\n  Undo2,\n  Box,\n  Send,\n  Maximize2,\n  CloudRain,\n  SunDim,\n  Wind,\n  Upload,\n  Layers,\n  Crop,\n  RotateCcw,\n  BrainCircuit,\n  Flame,\n  Sun,\n  Moon,\n  CloudLightning,\n  ImageMinus,\n  Sliders,\n  Stars,\n  Image,\n  Ghost,\n  Zap as Lightning,\n  Grid,\n  Monitor,\n  Layout,\n  Film,\n  Video,\n  ArrowDown,\n  ArrowUp,\n  ArrowUpRight,\n  LayoutTemplate,\n  Scan,\n  Ratio,\n  LayoutGrid,\n} from 'lucide-react';\nimport { useStore } from '../store/useStore';\nimport { ImageAsset } from '../types';\nimport { refinePrompt } from '../services/geminiService';\nimport { assetDB } from '../services/db';\n\ninterface FloatingNanoForgeProps {\n  image: ImageAsset;\n  onClose: () => void;\n  initialTab?:\n    | 'forge'\n    | 'style'\n    | 'inpaint'\n    | 'prop'\n    | 'upscale'\n    | 'atmosphere'\n    | 'frame'\n    | 'backdrop'\n    | 'camera';\n  anchorPosition?: { x: number; y: number };\n}\n\nexport const FloatingNanoForge: React.FC<FloatingNanoForgeProps> = ({\n  image,\n  onClose,\n  initialTab = 'forge',\n  anchorPosition,\n}) => {\n  const {\n    performImageEdit,\n    performPropGeneration,\n    performUpscale,\n    applyFestiveOverdrive,\n    performStyleTransfer,\n    applySmartCrop,\n    resetCrop,\n    neuralTemperature,\n    reanalyzeImage,\n    performBackgroundGeneration,\n    images,\n    addToReel,\n    applyCompositionRule,\n  } = useStore();\n\n  const [prompt, setPrompt] = useState('');\n  const [command, setCommand] = useState('');\n  const [activeTab, setActiveTab] = useState(initialTab);\n  const [isRefining, setIsRefining] = useState(false);\n\n  // Upscale Creativity State\n  const [upscaleCreativity, setUpscaleCreativity] = useState(0.2);\n\n  const atmospheres = [\n    {\n      id: 'snow',\n      name: 'Blizzard Protocol',\n      mode: 'snow' as const,\n      desc: 'Volumetric snow and frost accumulation',\n      icon: Snowflake,\n    },\n    {\n      id: 'lights',\n      name: 'Magic String Lights',\n      mode: 'lights' as const,\n      desc: 'Warm bokeh and glowing holiday orbs',\n      icon: Stars,\n    },\n    {\n      id: 'magic',\n      name: 'Full Holiday Overdrive',\n      mode: 'magic' as const,\n      desc: 'Maximum festive spirit neural remix',\n      icon: Sparkles,\n    },\n  ];\n\n  const cameraAngles = [\n    {\n      id: 'dutch',\n      name: 'Dutch Angle',\n      prompt:\n        'Remix this image with a dramatic Dutch Angle (tilted horizon) to create dynamic tension and energy.',\n      icon: RotateCcw,\n      color: 'text-orange-400',\n    },\n    {\n      id: 'low',\n      name: 'Low Angle',\n      prompt:\n        \"Remix this image from a low angle looking up (worm's-eye view) to make the subject appear powerful and imposing.\",\n      icon: ArrowUp,\n      color: 'text-indigo-400',\n    },\n    {\n      id: 'overhead',\n      name: 'Overhead',\n      prompt:\n        \"Remix this image from a direct top-down overhead perspective (God's eye view/Flat Lay).\",\n      icon: ArrowDown,\n      color: 'text-cyan-400',\n    },\n    {\n      id: 'wide',\n      name: 'Ultra Wide',\n      prompt:\n        'Remix this image using a wide-angle lens to show more of the surrounding environment and create depth.',\n      icon: Maximize2,\n      color: 'text-emerald-400',\n    },\n    {\n      id: 'close',\n      name: 'Extreme Close-Up',\n      prompt:\n        'Remix this image as an extreme close-up detail shot, focusing intensely on the texture and features.',\n      icon: Focus,\n      color: 'text-rose-400',\n    },\n  ];\n\n  const stylePresets = [\n    {\n      id: 'cyber',\n      name: 'Cyberpunk',\n      prompt:\n        'Neural Cyberpunk Remix: Infuse with neon bioluminescence, rainy high-tech urban atmosphere, and chrome surfaces.',\n      icon: Zap,\n      color: 'text-cyan-400',\n      glow: 'shadow-cyan-500/20',\n    },\n    {\n      id: 'oil',\n      name: 'Oil Painting',\n      prompt:\n        'Classical Oil Painting: Re-render with thick impasto brushstrokes, rich pigment textures, and dramatic chiaroscuro lighting.',\n      icon: Palette,\n      color: 'text-amber-500',\n      glow: 'shadow-amber-500/20',\n    },\n    {\n      id: 'festive',\n      name: 'Festive Magic',\n      prompt:\n        'Holiday Enchantment: Add warm glowing bokeh, magical snowflakes, and a cozy cinematic Christmas atmosphere.',\n      icon: Snowflake,\n      color: 'text-rose-400',\n      glow: 'shadow-rose-500/20',\n    },\n    {\n      id: 'sketch',\n      name: 'Ink Sketch',\n      prompt:\n        'Architectural Ink Sketch: Convert to a detailed hand-drawn ink and charcoal illustration on vintage paper.',\n      icon: PenTool,\n      color: 'text-slate-400',\n      glow: 'shadow-slate-500/20',\n    },\n    {\n      id: 'ghibli',\n      name: 'Anime Studio',\n      prompt:\n        'Nostalgic Anime Style: Transform into a lush, hand-painted Ghibli-inspired world with vibrant blues and fluffy clouds.',\n      icon: Ghost,\n      color: 'text-emerald-400',\n      glow: 'shadow-emerald-500/20',\n    },\n    {\n      id: 'vapor',\n      name: 'Vaporwave',\n      prompt:\n        'Vaporwave Aesthetic: Apply a surreal retro-future remix with pink/purple gradients, digital artifacts, and lo-fi glow.',\n      icon: Sun,\n      color: 'text-fuchsia-400',\n      glow: 'shadow-fuchsia-500/20',\n    },\n    {\n      id: 'clay',\n      name: 'Claymation',\n      prompt:\n        'Plasticine Stop-Motion: Render as a tactile clay model with soft fingerprints, rounded edges, and studio lighting.',\n      icon: Box,\n      color: 'text-orange-400',\n      glow: 'shadow-orange-500/20',\n    },\n    {\n      id: 'pixel',\n      name: 'Pixel Art',\n      prompt:\n        '16-bit Pixel Art: Convert to a retro high-quality pixel art style with a limited color palette and dithering.',\n      icon: Grid,\n      color: 'text-purple-400',\n      glow: 'shadow-purple-500/20',\n    },\n  ];\n\n  const [styleRefBase64, setStyleRefBase64] = useState<string | null>(null);\n  const [styleRefMimeType, setStyleRefMimeType] = useState<string | null>(null);\n  const [styleIntensity, setStyleIntensity] = useState(0.8);\n  const [showCanvasPicker, setShowCanvasPicker] = useState(false);\n  const styleInputRef = useRef<HTMLInputElement>(null);\n\n  // --- BRUSH & MASK STATE ---\n  const [tool, setTool] = useState<'pointer' | 'brush'>('brush');\n  const [brushSize, setBrushSize] = useState(40);\n  const [maskOpacity, setMaskOpacity] = useState(0.5);\n  const [anchor, setAnchor] = useState<{ x: number; y: number } | null>(null);\n  const [isDrawing, setIsDrawing] = useState(false);\n  const [hasMaskData, setHasMaskData] = useState(false);\n  const [mousePos, setMousePos] = useState({ x: 0, y: 0 });\n\n  const thumbRef = useRef<HTMLDivElement>(null);\n  const canvasRef = useRef<HTMLCanvasElement>(null); // Visible overlay\n  const maskCanvasRef = useRef<HTMLCanvasElement | null>(null); // Hidden binary mask\n\n  // Initialize masks when switching to Inpaint tab\n  useEffect(() => {\n    if (!maskCanvasRef.current) {\n      maskCanvasRef.current = document.createElement('canvas');\n    }\n    // Small delay to allow DOM to settle\n    const timer = setTimeout(initMaskCanvases, 100);\n    return () => clearTimeout(timer);\n  }, [activeTab]);\n\n  const initMaskCanvases = () => {\n    if (!thumbRef.current || !canvasRef.current || !maskCanvasRef.current) return;\n    const rect = thumbRef.current.getBoundingClientRect();\n\n    canvasRef.current.width = rect.width;\n    canvasRef.current.height = rect.height;\n\n    maskCanvasRef.current.width = rect.width;\n    maskCanvasRef.current.height = rect.height;\n\n    const mCtx = maskCanvasRef.current.getContext('2d');\n    if (mCtx) {\n      mCtx.fillStyle = 'black';\n      mCtx.fillRect(0, 0, rect.width, rect.height);\n    }\n  };\n\n  const startDrawing = (e: React.MouseEvent) => {\n    if (tool !== 'brush' || !canvasRef.current || !maskCanvasRef.current) return;\n    setIsDrawing(true);\n    const rect = thumbRef.current?.getBoundingClientRect();\n    if (!rect) return;\n\n    const x = e.clientX - rect.left;\n    const y = e.clientY - rect.top;\n\n    const ctx = canvasRef.current.getContext('2d');\n    const mCtx = maskCanvasRef.current.getContext('2d');\n\n    if (ctx && mCtx) {\n      ctx.beginPath();\n      ctx.moveTo(x, y);\n      mCtx.beginPath();\n      mCtx.moveTo(x, y);\n    }\n    draw(e);\n  };\n\n  const stopDrawing = () => {\n    if (isDrawing) {\n      const ctx = canvasRef.current?.getContext('2d');\n      const mCtx = maskCanvasRef.current?.getContext('2d');\n      ctx?.closePath();\n      mCtx?.closePath();\n      setIsDrawing(false);\n    }\n  };\n\n  const draw = (e: React.MouseEvent) => {\n    const rect = thumbRef.current?.getBoundingClientRect();\n    if (!rect) return;\n    const x = e.clientX - rect.left;\n    const y = e.clientY - rect.top;\n    setMousePos({ x, y });\n\n    if (!isDrawing || !canvasRef.current || !maskCanvasRef.current) return;\n\n    const ctx = canvasRef.current.getContext('2d');\n    const mCtx = maskCanvasRef.current.getContext('2d');\n\n    if (ctx && mCtx) {\n      // Draw visual feedback (Red)\n      ctx.strokeStyle = 'rgba(244, 63, 94, 0.8)'; // Rose-500\n      ctx.lineWidth = brushSize;\n      ctx.lineCap = 'round';\n      ctx.lineJoin = 'round';\n      ctx.lineTo(x, y);\n      ctx.stroke();\n\n      // Draw semantic mask (White on Black)\n      mCtx.strokeStyle = 'white';\n      mCtx.lineWidth = brushSize;\n      mCtx.lineCap = 'round';\n      mCtx.lineJoin = 'round';\n      mCtx.lineTo(x, y);\n      mCtx.stroke();\n\n      setHasMaskData(true);\n    }\n  };\n\n  const clearMask = () => {\n    if (canvasRef.current && maskCanvasRef.current) {\n      const ctx = canvasRef.current.getContext('2d');\n      const mCtx = maskCanvasRef.current.getContext('2d');\n      ctx?.clearRect(0, 0, canvasRef.current.width, canvasRef.current.height);\n      if (mCtx) {\n        mCtx.fillStyle = 'black';\n        mCtx.fillRect(0, 0, maskCanvasRef.current.width, maskCanvasRef.current.height);\n      }\n    }\n    setAnchor(null);\n    setHasMaskData(false);\n  };\n\n  const handleThumbnailClick = (e: React.MouseEvent) => {\n    if (tool === 'brush') return;\n    if (!thumbRef.current) return;\n    const rect = thumbRef.current.getBoundingClientRect();\n    const x = ((e.clientX - rect.left) / rect.width) * 100;\n    const y = ((e.clientY - rect.top) / rect.height) * 100;\n    setAnchor({ x, y });\n    if (\n      activeTab !== 'inpaint' &&\n      activeTab !== 'upscale' &&\n      activeTab !== 'atmosphere' &&\n      activeTab !== 'camera' &&\n      activeTab !== 'frame'\n    )\n      setActiveTab('inpaint');\n  };\n\n  const handleApplyEdit = async (customPrompt?: string, modeOverride?: 'remix' | 'inpaint') => {\n    const basePrompt = customPrompt || prompt || command;\n    if (!basePrompt.trim() || neuralTemperature > 0) return;\n\n    const currentMode = modeOverride || (activeTab === 'inpaint' ? 'inpaint' : 'remix');\n    let maskBase64: string | undefined = undefined;\n\n    if (currentMode === 'inpaint' && maskCanvasRef.current && hasMaskData) {\n      maskBase64 = maskCanvasRef.current.toDataURL('image/png');\n    }\n\n    let finalPrompt = basePrompt;\n    if (currentMode === 'inpaint' && anchor && !maskBase64) {\n      finalPrompt = `INPAINT: Focus on (x:${Math.round(anchor.x)}%, y:${Math.round(anchor.y)}%). ${basePrompt}`;\n    }\n\n    await performImageEdit(image.id, finalPrompt, 'edit', 'gemini-2.0-flash', maskBase64);\n    setPrompt('');\n    setCommand('');\n    onClose();\n  };\n\n  const handleStyleUpload = (e: React.ChangeEvent<HTMLInputElement>) => {\n    const file = e.target.files?.[0];\n    if (!file) return;\n    const reader = new FileReader();\n    reader.onloadend = () => {\n      const result = reader.result as string;\n      setStyleRefBase64(result.split(',')[1]);\n      setStyleRefMimeType(file.type);\n    };\n    reader.readAsDataURL(file);\n  };\n\n  const handleCanvasStyleSelect = async (img: ImageAsset) => {\n    try {\n      let blob: Blob | null = null;\n      if (img.url.startsWith('local://')) {\n        const id = img.url.replace('local://', '');\n        const data = await assetDB.get(id);\n        if (data instanceof Blob) blob = data;\n        else if (typeof data === 'string') {\n          setStyleRefBase64(data.startsWith('data:') ? data.split(',')[1] : data);\n          setStyleRefMimeType('image/png');\n          setShowCanvasPicker(false);\n          return;\n        }\n      } else if (img.url.startsWith('data:')) {\n        setStyleRefBase64(img.url.split(',')[1]);\n        setStyleRefMimeType('image/png');\n        setShowCanvasPicker(false);\n        return;\n      } else {\n        // For remote URLs (rare in this app)\n        const res = await fetch(img.url);\n        blob = await res.blob();\n      }\n\n      if (blob) {\n        const reader = new FileReader();\n        reader.onloadend = () => {\n          const res = reader.result as string;\n          setStyleRefBase64(res.split(',')[1]);\n          setStyleRefMimeType(blob!.type);\n          setShowCanvasPicker(false);\n        };\n        reader.readAsDataURL(blob);\n      }\n    } catch (e) {\n      console.error('Canvas Style Select Failed', e);\n    }\n  };\n\n  const handleApplyStyle = async (specificPrompt?: string) => {\n    const base = specificPrompt || prompt || command;\n\n    if (styleRefBase64 && styleRefMimeType) {\n      const intensityPart = `Style Intensity: ${Math.round(styleIntensity * 100)}%.`;\n      const instr = base\n        ? base\n        : 'Transfer the style from the reference image to the source image.';\n      const finalPrompt = `${intensityPart} ${instr}`;\n\n      await performStyleTransfer(image.id, finalPrompt, styleRefBase64, styleRefMimeType);\n      onClose();\n    } else {\n      const fallbackPrompt = base || 'Apply a beautiful artistic style transfer.';\n      await handleApplyEdit(fallbackPrompt);\n    }\n  };\n\n  const handleForgeProp = async () => {\n    const propPrompt = prompt || command;\n    if (!propPrompt.trim() || neuralTemperature > 0) return;\n    await performPropGeneration(propPrompt, image.id);\n    setPrompt('');\n    setCommand('');\n    onClose();\n  };\n\n  const handleBackgroundGen = async () => {\n    if (neuralTemperature > 0) return;\n    await performBackgroundGeneration(image.id);\n    onClose();\n  };\n\n  const handleUpscaleTrigger = async () => {\n    if (neuralTemperature > 0) return;\n    await performUpscale(image.id, upscaleCreativity);\n    onClose();\n  };\n\n  const handleFestiveTrigger = async (mode: 'snow' | 'lights' | 'magic') => {\n    if (neuralTemperature > 0) return;\n    await applyFestiveOverdrive(image.id, mode);\n  };\n\n  const handleRefinePrompt = async () => {\n    const textToRefine = prompt || command;\n    if (!textToRefine.trim() || isRefining) return;\n    setIsRefining(true);\n    try {\n      // Using governed service call instead of direct instantiation\n      const refined = await refinePrompt(textToRefine);\n      if (refined) {\n        if (prompt) setPrompt(refined);\n        else setCommand(refined);\n      }\n    } catch (e) {\n      console.error('Prompt Refinement Failed', e);\n    } finally {\n      setIsRefining(false);\n    }\n  };\n\n  const positionStyle = anchorPosition\n    ? {\n        left: anchorPosition.x,\n        top: anchorPosition.y - 20,\n        transform: 'translate(-50%, -100%)',\n      }\n    : {\n        left: image.x + (image.width * image.scale) / 2,\n        top: image.y - 180,\n        transform: 'translateX(-50%)',\n      };\n\n  const hasAnalysis = !!image.composition;\n\n  return (\n    <motion.div\n      initial={{ opacity: 0, scale: 0.9, y: 20 }}\n      animate={{ opacity: 1, scale: 1, y: 0 }}\n      exit={{ opacity: 0, scale: 0.9, y: 20 }}\n      className=\"absolute z-[500] pointer-events-auto\"\n       \n      style={positionStyle}\n    >\n      <div className=\"relative p-1 bg-black/95 backdrop-blur-3xl border border-indigo-500/30 rounded-[32px] shadow-[0_0_80px_rgba(0,0,0,0.8)] flex flex-col w-[440px] overflow-hidden\">\n        {/* --- HEADER TABS --- */}\n        <div className=\"flex items-center justify-between px-6 py-4 border-b border-white/5 bg-white/5\">\n          <div className=\"flex gap-1 p-1 bg-black/40 rounded-full border border-white/5 relative overflow-x-auto custom-scrollbar max-w-[320px]\">\n            <TabItem\n              active={activeTab === 'forge'}\n              onClick={() => setActiveTab('forge')}\n              icon={PenTool}\n              label=\"Forge\"\n            />\n            <TabItem\n              active={activeTab === 'frame'}\n              onClick={() => setActiveTab('frame')}\n              icon={LayoutTemplate}\n              label=\"Frame\"\n            />\n            <TabItem\n              active={activeTab === 'style'}\n              onClick={() => setActiveTab('style')}\n              icon={Palette}\n              label=\"Remix\"\n            />\n            <TabItem\n              active={activeTab === 'camera'}\n              onClick={() => setActiveTab('camera')}\n              icon={Video}\n              label=\"Camera\"\n            />\n            <TabItem\n              active={activeTab === 'inpaint'}\n              onClick={() => setActiveTab('inpaint')}\n              icon={Target}\n              label=\"Inpaint\"\n            />\n            <TabItem\n              active={activeTab === 'backdrop'}\n              onClick={() => setActiveTab('backdrop')}\n              icon={Monitor}\n              label=\"Backdrop\"\n            />\n            <TabItem\n              active={activeTab === 'atmosphere'}\n              onClick={() => setActiveTab('atmosphere')}\n              icon={CloudRain}\n              label=\"FX\"\n            />\n            <TabItem\n              active={activeTab === 'upscale'}\n              onClick={() => setActiveTab('upscale')}\n              icon={Maximize2}\n              label=\"4K\"\n            />\n          </div>\n\n          <div className=\"flex items-center gap-1 ml-2\">\n            <motion.button\n              whileHover={{ scale: 1.1, backgroundColor: 'rgba(99, 102, 241, 0.2)' }}\n              whileTap={{ scale: 0.9 }}\n              onClick={() => addToReel([image.id])}\n              className=\"w-8 h-8 flex items-center justify-center bg-white/5 hover:text-indigo-400 rounded-full transition-all\"\n              title=\"Add to Reel\"\n            >\n              <Film size={14} />\n            </motion.button>\n\n            <motion.button\n              whileHover={{ scale: 1.1, backgroundColor: 'rgba(244, 63, 94, 0.2)' }}\n              whileTap={{ scale: 0.9 }}\n              onClick={onClose}\n              className=\"w-8 h-8 flex items-center justify-center bg-white/5 hover:text-rose-400 rounded-full transition-all\"\n            >\n              <X size={16} />\n            </motion.button>\n          </div>\n        </div>\n\n        {/* --- INPAINT EDITOR (BRUSH + MASK) --- */}\n        <AnimatePresence>\n          {activeTab === 'inpaint' && (\n            <motion.div\n              initial={{ height: 0, opacity: 0 }}\n              animate={{ height: 'auto', opacity: 1 }}\n              exit={{ height: 0, opacity: 0 }}\n              className=\"px-5 pt-5 overflow-hidden\"\n            >\n              <div className=\"space-y-4\">\n                <div className=\"flex justify-between items-center px-1\">\n                  <div className=\"flex gap-2 p-0.5 bg-black/40 rounded-lg border border-white/5\">\n                    <ToolBtn\n                      active={tool === 'pointer'}\n                      onClick={() => setTool('pointer')}\n                      icon={MousePointer2}\n                    />\n                    <ToolBtn\n                      active={tool === 'brush'}\n                      onClick={() => setTool('brush')}\n                      icon={Brush}\n                    />\n                  </div>\n\n                  <div className=\"flex items-center gap-4 bg-black/20 px-3 py-1 rounded-full border border-white/5\">\n                    <div className=\"flex items-center gap-2\">\n                      <span className=\"text-[7px] font-black text-slate-500 uppercase tracking-widest\">\n                        Size\n                      </span>\n                      <input\n                        type=\"range\"\n                        min=\"5\"\n                        max=\"100\"\n                        value={brushSize}\n                        onChange={e => setBrushSize(parseInt(e.target.value))}\n                        className=\"w-16 h-1 bg-slate-800 rounded-lg appearance-none cursor-pointer accent-rose-500\"\n                        aria-label=\"Brush Size\"\n                      />\n                    </div>\n                    <div className=\"flex items-center gap-2 border-l border-white/10 pl-2\">\n                      <span className=\"text-[7px] font-black text-slate-500 uppercase tracking-widest\">\n                        Viz\n                      </span>\n                      <input\n                        type=\"range\"\n                        min=\"0\"\n                        max=\"1\"\n                        step=\"0.1\"\n                        value={maskOpacity}\n                        onChange={e => setMaskOpacity(parseFloat(e.target.value))}\n                        className=\"w-16 h-1 bg-slate-800 rounded-lg appearance-none cursor-pointer accent-cyan-500\"\n                        aria-label=\"Mask Visibility\"\n                      />\n                    </div>\n                  </div>\n\n                  <motion.button\n                    whileHover={{ scale: 1.05 }}\n                    whileTap={{ scale: 0.95 }}\n                    onClick={clearMask}\n                    className=\"text-[8px] text-rose-500 hover:text-rose-400 uppercase font-black tracking-tighter flex items-center gap-1\"\n                  >\n                    <Undo2 size={10} /> Reset_Mask\n                  </motion.button>\n                </div>\n\n                <motion.div\n                  ref={thumbRef}\n                  onClick={handleThumbnailClick}\n                  onMouseDown={startDrawing}\n                  onMouseMove={draw}\n                  onMouseUp={stopDrawing}\n                  onMouseLeave={stopDrawing}\n                   \n                  style={{ aspectRatio: `${image.width} / ${image.height}` }}\n                  className={`relative w-full max-h-[300px] bg-slate-950 rounded-2xl overflow-hidden border border-white/10 shadow-inner group transition-all duration-300 ${tool === 'brush' ? 'cursor-none' : 'cursor-crosshair'}`}\n                >\n                  <img\n                    src={image.url}\n                    className=\"w-full h-full object-cover opacity-60 group-hover:opacity-80 transition-opacity pointer-events-none\"\n                    alt=\"Source image for inpainting\"\n                  />\n                  <canvas\n                    ref={canvasRef}\n                    className=\"absolute inset-0 w-full h-full pointer-events-none transition-opacity\"\n                     \n                    style={{ opacity: maskOpacity }}\n                  />\n\n                  {tool === 'brush' && (\n                    <div\n                      className=\"absolute border border-white/80 rounded-full pointer-events-none z-50 bg-rose-500/20 shadow-[0_0_10px_rgba(244,63,94,0.4)]\"\n                       \n                      style={{\n                        width: brushSize,\n                        height: brushSize,\n                        left: mousePos.x,\n                        top: mousePos.y,\n                        transform: 'translate(-50%, -50%)',\n                      }}\n                    />\n                  )}\n\n                  <AnimatePresence>\n                    {anchor && tool === 'pointer' && (\n                      <motion.div\n                        initial={{ scale: 0, opacity: 0 }}\n                        animate={{ scale: 1, opacity: 1 }}\n                        className=\"absolute w-8 h-8 -translate-x-1/2 -translate-y-1/2 pointer-events-none flex items-center justify-center\"\n                         \n                        style={{ left: `${anchor.x}%`, top: `${anchor.y}%` }}\n                      >\n                        <div className=\"absolute inset-0 bg-indigo-500 rounded-full blur-md opacity-40 animate-pulse\" />\n                        <Target\n                          size={24}\n                          className=\"text-indigo-400 relative z-10 drop-shadow-[0_0_8px_rgba(99,102,241,0.8)]\"\n                        />\n                      </motion.div>\n                    )}\n                  </AnimatePresence>\n                </motion.div>\n\n                <div className=\"grid grid-cols-2 gap-2\">\n                  <InpaintActionBtn\n                    icon={Eraser}\n                    label=\"Magic Eraser\"\n                    onClick={() =>\n                      handleApplyEdit(\n                        'Cleanly remove the objects within the marked area, blending the textures and lighting with the background.',\n                        'inpaint'\n                      )\n                    }\n                    color=\"rose\"\n                    disabled={!hasMaskData && !anchor}\n                  />\n                  <InpaintActionBtn\n                    icon={PlusCircle}\n                    label=\"Generative Fill\"\n                    onClick={() =>\n                      handleApplyEdit(\n                        `Integrate the following specifically into the marked region: ${prompt || command}. Match lighting and perspective perfectly.`,\n                        'inpaint'\n                      )\n                    }\n                    color=\"cyan\"\n                    disabled={(!prompt.trim() && !command.trim()) || (!hasMaskData && !anchor)}\n                  />\n                </div>\n              </div>\n            </motion.div>\n          )}\n        </AnimatePresence>\n\n        {/* --- FRAME / COMPOSITION TAB --- */}\n        <AnimatePresence>\n          {activeTab === 'frame' && (\n            <motion.div\n              key=\"frame\"\n              initial={{ opacity: 0, y: 10 }}\n              animate={{ opacity: 1, y: 0 }}\n              exit={{ opacity: 0, y: -10 }}\n              className=\"p-5 space-y-6\"\n            >\n              {!hasAnalysis ? (\n                <div className=\"flex flex-col items-center justify-center p-8 text-center space-y-4 bg-white/5 rounded-2xl border border-white/10\">\n                  <Scan size={32} className=\"text-indigo-400\" />\n                  <div className=\"space-y-1\">\n                    <h3 className=\"text-sm font-black uppercase text-white tracking-widest\">\n                      Composition_Unknown\n                    </h3>\n                    <p className=\"text-[9px] font-mono text-slate-500\">\n                      Run deep analysis to unlock smart framing.\n                    </p>\n                  </div>\n                  <motion.button\n                    whileHover={{ scale: 1.05 }}\n                    whileTap={{ scale: 0.95 }}\n                    onClick={() => reanalyzeImage(image.id)}\n                    disabled={neuralTemperature > 0}\n                    className=\"px-6 py-2 bg-indigo-600 hover:bg-indigo-500 text-white rounded-full text-[10px] font-black uppercase tracking-[0.2em] flex items-center gap-2 shadow-lg disabled:opacity-50\"\n                  >\n                    {neuralTemperature > 0 ? (\n                      <Loader2 size={12} className=\"animate-spin\" />\n                    ) : (\n                      <BrainCircuit size={12} />\n                    )}\n                    Analyze_Asset\n                  </motion.button>\n                </div>\n              ) : (\n                <>\n                  <div className=\"flex items-start gap-4 p-4 bg-indigo-500/10 border border-indigo-500/20 rounded-2xl\">\n                    <div className=\"flex flex-col items-center gap-1\">\n                      <div className=\"w-12 h-12 rounded-full border-2 border-indigo-500 flex items-center justify-center text-indigo-400 bg-indigo-500/10\">\n                        <span className=\"text-lg font-black\">\n                          {Math.round((image.composition?.aestheticScore || 0) * 10)}\n                        </span>\n                      </div>\n                      <span className=\"text-[7px] font-black uppercase text-indigo-300 tracking-widest\">\n                        Score\n                      </span>\n                    </div>\n                    <div className=\"flex-1 space-y-2\">\n                      <div className=\"flex justify-between items-center border-b border-indigo-500/20 pb-1\">\n                        <span className=\"text-[9px] font-black text-indigo-300 uppercase tracking-widest\">\n                          AI_Advisory\n                        </span>\n                        <span className=\"text-[8px] font-mono text-slate-400 uppercase bg-black/20 px-2 py-0.5 rounded\">\n                          {image.composition?.dominant_rule || 'Unstructured'}\n                        </span>\n                      </div>\n                      <p className=\"text-[9px] font-mono text-slate-300 leading-relaxed opacity-90\">\n                        {image.composition?.improvementAdvisory ||\n                          'Composition looks solid. Try exploring alternative crops for cinematic impact.'}\n                      </p>\n                    </div>\n                  </div>\n\n                  <div className=\"space-y-3\">\n                    <h3 className=\"text-[9px] font-black text-slate-500 uppercase tracking-widest px-1 flex items-center gap-2\">\n                      <Crop size={10} /> Smart Re-Framing\n                    </h3>\n                    <div className=\"grid grid-cols-3 gap-2\">\n                      <motion.button\n                        whileHover={{ scale: 1.05 }}\n                        whileTap={{ scale: 0.95 }}\n                        onClick={() => {\n                          applyCompositionRule(image.id, 'center');\n                          onClose();\n                        }}\n                        className=\"p-3 bg-white/5 border border-white/10 rounded-xl flex flex-col items-center gap-2 hover:bg-white/10 hover:border-white/20 transition-all group\"\n                      >\n                        <Focus\n                          size={18}\n                          className=\"text-cyan-400 group-hover:scale-110 transition-transform\"\n                        />\n                        <span className=\"text-[8px] font-black uppercase text-slate-400 group-hover:text-white tracking-wider\">\n                          Center\n                        </span>\n                      </motion.button>\n\n                      <motion.button\n                        whileHover={{ scale: 1.05 }}\n                        whileTap={{ scale: 0.95 }}\n                        onClick={() => {\n                          applyCompositionRule(image.id, 'thirds');\n                          onClose();\n                        }}\n                        className=\"p-3 bg-white/5 border border-white/10 rounded-xl flex flex-col items-center gap-2 hover:bg-white/10 hover:border-white/20 transition-all group\"\n                      >\n                        <LayoutGrid\n                          size={18}\n                          className=\"text-emerald-400 group-hover:scale-110 transition-transform\"\n                        />\n                        <span className=\"text-[8px] font-black uppercase text-slate-400 group-hover:text-white tracking-wider\">\n                          Thirds\n                        </span>\n                      </motion.button>\n\n                      <motion.button\n                        whileHover={{ scale: 1.05 }}\n                        whileTap={{ scale: 0.95 }}\n                        onClick={() => {\n                          applyCompositionRule(image.id, 'golden');\n                          onClose();\n                        }}\n                        className=\"p-3 bg-white/5 border border-white/10 rounded-xl flex flex-col items-center gap-2 hover:bg-white/10 hover:border-white/20 transition-all group\"\n                      >\n                        <Ratio\n                          size={18}\n                          className=\"text-amber-400 group-hover:scale-110 transition-transform\"\n                        />\n                        <span className=\"text-[8px] font-black uppercase text-slate-400 group-hover:text-white tracking-wider\">\n                          Golden\n                        </span>\n                      </motion.button>\n                    </div>\n                  </div>\n\n                  <div className=\"flex items-center justify-center pt-2\">\n                    <button\n                      onClick={() => {\n                        resetCrop(image.id);\n                        onClose();\n                      }}\n                      className=\"text-[9px] font-mono text-rose-500 hover:text-rose-400 uppercase tracking-widest flex items-center gap-2\"\n                    >\n                      <Undo2 size={10} /> Reset_Original_Ratio\n                    </button>\n                  </div>\n                </>\n              )}\n            </motion.div>\n          )}\n        </AnimatePresence>\n\n        {/* --- PROMPT INPUT (Hidden for Frame Tab) --- */}\n        {activeTab !== 'frame' && (\n          <div className=\"px-5 pt-5 pb-2\">\n            <div className=\"relative group\">\n              <div className=\"absolute left-4 top-1/2 -translate-y-1/2 text-indigo-400\">\n                <Lightning size={14} className={neuralTemperature > 0 ? 'animate-pulse' : ''} />\n              </div>\n              <input\n                type=\"text\"\n                value={command}\n                onChange={e => setCommand(e.target.value)}\n                onKeyDown={e =>\n                  e.key === 'Enter' &&\n                  (activeTab === 'style'\n                    ? handleApplyStyle()\n                    : activeTab === 'prop'\n                      ? handleForgeProp()\n                      : handleApplyEdit())\n                }\n                placeholder={\n                  activeTab === 'inpaint'\n                    ? 'Describe modifications for the mask...'\n                    : activeTab === 'style'\n                      ? 'Describe a custom artistic style...'\n                      : 'Enter custom neural command...'\n                }\n                className=\"w-full bg-black/40 border border-white/10 rounded-full pl-10 pr-24 py-3 text-[11px] font-mono text-white outline-none focus:border-indigo-500/50 focus:ring-1 focus:ring-indigo-500/20 shadow-inner transition-all\"\n              />\n              <div className=\"absolute right-2 top-1/2 -translate-y-1/2 flex items-center gap-1\">\n                <motion.button\n                  whileHover={{ scale: 1.1, backgroundColor: 'rgba(99, 102, 241, 0.2)' }}\n                  whileTap={{ scale: 0.9 }}\n                  onClick={handleRefinePrompt}\n                  disabled={!command.trim() || isRefining}\n                  className=\"p-1.5 bg-indigo-500/10 text-indigo-400 rounded-full transition-all disabled:opacity-0\"\n                  title=\"Refine Command\"\n                >\n                  {isRefining ? (\n                    <Loader2 size={12} className=\"animate-spin\" />\n                  ) : (\n                    <Sparkles size={12} />\n                  )}\n                </motion.button>\n                <motion.button\n                  whileHover={{\n                    scale: 1.05,\n                    backgroundColor: 'rgba(79, 70, 229, 1)',\n                    boxShadow: '0 0 15px rgba(99, 102, 241, 0.4)',\n                  }}\n                  whileTap={{ scale: 0.95 }}\n                  transition={{ type: 'spring', stiffness: 400, damping: 17 }}\n                  onClick={() =>\n                    activeTab === 'style'\n                      ? handleApplyStyle()\n                      : activeTab === 'prop'\n                        ? handleForgeProp()\n                        : handleApplyEdit()\n                  }\n                  disabled={!command.trim() || neuralTemperature > 0}\n                  className=\"px-3 py-1.5 bg-indigo-600 hover:bg-indigo-500 text-white rounded-full flex items-center gap-1.5 text-[9px] font-black uppercase tracking-widest transition-all disabled:opacity-30 shadow-lg shadow-indigo-600/20\"\n                >\n                  <Send size={10} /> RUN\n                </motion.button>\n              </div>\n            </div>\n          </div>\n        )}\n\n        <div className=\"p-5 flex flex-col gap-4\">\n          <AnimatePresence mode=\"wait\">\n            {activeTab === 'forge' && (\n              <motion.div\n                key=\"forge\"\n                initial={{ opacity: 0, y: 10 }}\n                animate={{ opacity: 1, y: 0 }}\n                exit={{ opacity: 0, y: -10 }}\n                className=\"space-y-6\"\n              >\n                <div className=\"space-y-3\">\n                  <div className=\"flex items-center justify-between\">\n                    <span className=\"text-[8px] font-black uppercase text-indigo-400 tracking-[0.2em]\">\n                      Neural Presets\n                    </span>\n                  </div>\n                  <div className=\"grid grid-cols-2 gap-2\">\n                    {[\n                      {\n                        id: 'hdr',\n                        name: 'Ultra HDR',\n                        prompt:\n                          'Enhance details, expand color range, and optimize micro-contrast for a vivid high-dynamic-range look.',\n                        icon: Lightning,\n                        color: 'text-cyan-400',\n                      },\n                      {\n                        id: 'cine',\n                        name: 'Cinematic',\n                        prompt:\n                          'Enhance the colors and add a cinematic bokeh effect with soft volumetric lighting.',\n                        icon: Film,\n                        color: 'text-fuchsia-400',\n                      },\n                      {\n                        id: 'night',\n                        name: 'Moonlight',\n                        prompt:\n                          'Transform into a serene moonlit night scene with deep blue shadows and soft volumetric light.',\n                        icon: Moon,\n                        color: 'text-indigo-400',\n                      },\n                      {\n                        id: 'sunset',\n                        name: 'Golden Hour',\n                        prompt:\n                          'Apply warm cinematic sunset lighting with long shadows and a glowing atmospheric haze.',\n                        icon: Sun,\n                        color: 'text-amber-500',\n                      },\n                      {\n                        id: 'storm',\n                        name: 'Stormy',\n                        prompt:\n                          'Moody storm atmosphere: dramatic dark clouds, cool color grading, and dynamic high-contrast lighting.',\n                        icon: CloudLightning,\n                        color: 'text-slate-400',\n                      },\n                    ].map(action => (\n                      <motion.button\n                        key={action.id}\n                        whileHover={{\n                          scale: 1.02,\n                          backgroundColor: 'rgba(255,255,255,0.08)',\n                          x: 4,\n                        }}\n                        whileTap={{ scale: 0.98 }}\n                        transition={{ type: 'spring', stiffness: 400, damping: 20 }}\n                        onClick={() => handleApplyEdit(action.prompt)}\n                        className=\"p-3 bg-white/5 border border-white/10 rounded-xl flex items-center gap-3 transition-all text-left\"\n                      >\n                        <action.icon size={16} className={action.color} />\n                        <span className=\"text-[9px] font-black uppercase text-slate-300 tracking-wider\">\n                          {action.name}\n                        </span>\n                      </motion.button>\n                    ))}\n                  </div>\n                </div>\n\n                <div className=\"h-px bg-white/10 my-1\" />\n\n                <div className=\"relative group\">\n                  <textarea\n                    value={prompt}\n                    onChange={e => setPrompt(e.target.value)}\n                    placeholder=\"Describe a full custom visual transformation...\"\n                    className=\"w-full h-24 bg-black/60 border border-white/10 rounded-2xl p-4 text-[11px] font-mono text-white outline-none focus:border-indigo-500/50 focus:ring-1 focus:ring-indigo-500/20 resize-none shadow-inner transition-all\"\n                  />\n                  <motion.button\n                    whileHover={{ scale: 1.1, y: -1, backgroundColor: 'rgba(99, 102, 241, 0.2)' }}\n                    whileTap={{ scale: 0.9 }}\n                    onClick={handleRefinePrompt}\n                    disabled={!prompt.trim() || isRefining}\n                    className=\"absolute bottom-3 right-3 p-2 bg-indigo-500/10 text-indigo-400 rounded-lg transition-all disabled:opacity-0\"\n                  >\n                    {isRefining ? (\n                      <Loader2 size={14} className=\"animate-spin\" />\n                    ) : (\n                      <Lightbulb size={14} />\n                    )}\n                  </motion.button>\n                </div>\n                <motion.button\n                  whileHover={{\n                    scale: 1.02,\n                    y: -2,\n                    backgroundColor: 'rgba(79, 70, 229, 0.9)',\n                    boxShadow: '0 10px 30px rgba(79, 70, 229, 0.4)',\n                  }}\n                  whileTap={{ scale: 0.98 }}\n                  transition={{ type: 'spring', stiffness: 400, damping: 17 }}\n                  onClick={() => handleApplyEdit()}\n                  disabled={!prompt.trim() || neuralTemperature > 0}\n                  className=\"w-full py-4 bg-indigo-600 hover:bg-indigo-500 rounded-full flex items-center justify-center gap-3 text-[11px] font-black uppercase tracking-[0.2em] text-white transition-all shadow-xl disabled:opacity-30\"\n                >\n                  {neuralTemperature > 0 ? (\n                    <Loader2 size={16} className=\"animate-spin\" />\n                  ) : (\n                    <Sparkles size={16} />\n                  )}\n                  Execute_Neural_Remix\n                </motion.button>\n              </motion.div>\n            )}\n\n            {activeTab === 'style' && (\n              <motion.div\n                key=\"style\"\n                initial={{ opacity: 0, y: 10 }}\n                animate={{ opacity: 1, y: 0 }}\n                exit={{ opacity: 0, y: -10 }}\n                className=\"space-y-6\"\n              >\n                {showCanvasPicker ? (\n                  <div className=\"space-y-3 animate-in slide-in-from-right duration-300\">\n                    <div className=\"flex items-center justify-between\">\n                      <span className=\"text-[8px] font-black uppercase text-indigo-400 tracking-[0.2em]\">\n                        Select Source\n                      </span>\n                      <button\n                        onClick={() => setShowCanvasPicker(false)}\n                        className=\"text-[8px] uppercase text-slate-500 hover:text-white\"\n                      >\n                        Cancel\n                      </button>\n                    </div>\n                    <div className=\"flex gap-2 overflow-x-auto pb-2 custom-scrollbar\">\n                      {images\n                        .filter(i => i.id !== image.id)\n                        .map(img => (\n                          <motion.button\n                            key={img.id}\n                            whileHover={{ scale: 1.05 }}\n                            onClick={() => handleCanvasStyleSelect(img)}\n                            className=\"relative w-20 h-20 shrink-0 rounded-lg overflow-hidden border border-white/10 group\"\n                          >\n                            <img\n                              src={img.url}\n                              className=\"w-full h-full object-cover opacity-60 group-hover:opacity-100 transition-opacity\"\n                              alt={img.tags?.[0] || 'Style reference'}\n                            />\n                          </motion.button>\n                        ))}\n                    </div>\n                  </div>\n                ) : (\n                  <>\n                    <div className=\"space-y-3\">\n                      <div className=\"flex items-center justify-between\">\n                        <span className=\"text-[8px] font-black uppercase text-indigo-400 tracking-[0.2em]\">\n                          Neural Style Fusion\n                        </span>\n                      </div>\n                      <div className=\"grid grid-cols-2 gap-3\">\n                        {stylePresets.map(s => (\n                          <motion.button\n                            key={s.id}\n                            whileHover={{\n                              scale: 1.05,\n                              backgroundColor: 'rgba(255,255,255,0.1)',\n                              y: -2,\n                            }}\n                            whileTap={{ scale: 0.95 }}\n                            transition={{ type: 'spring', stiffness: 500, damping: 20 }}\n                            onClick={() => handleApplyStyle(s.prompt)}\n                            className={`relative p-4 bg-white/5 border border-white/10 rounded-2xl flex flex-col items-center gap-2 group transition-all shadow-lg ${s.glow}`}\n                          >\n                            <div className=\"absolute inset-0 bg-gradient-to-tr from-transparent via-white/5 to-transparent -translate-x-full group-hover:translate-x-full transition-transform duration-1000 ease-in-out pointer-events-none rounded-2xl\" />\n                            <s.icon\n                              size={20}\n                              className={`${s.color} group-hover:scale-110 transition-transform`}\n                            />\n                            <span className=\"text-[9px] font-black uppercase text-slate-300 tracking-[0.1em] group-hover:text-white text-center\">\n                              {s.name}\n                            </span>\n                          </motion.button>\n                        ))}\n                      </div>\n                    </div>\n\n                    <div className=\"h-px bg-white/10 my-2\" />\n\n                    <div className=\"space-y-4\">\n                      <div className=\"flex items-center justify-between\">\n                        <span className=\"text-[8px] font-black uppercase text-indigo-400 tracking-[0.2em]\">\n                          Custom Reference\n                        </span>\n                        {styleRefBase64 && (\n                          <motion.button\n                            whileHover={{ scale: 1.1, color: '#f43f5e' }}\n                            onClick={() => setStyleRefBase64(null)}\n                            className=\"text-[8px] text-rose-500/60 hover:text-rose-500 font-black uppercase transition-colors\"\n                          >\n                            Clear_Reference\n                          </motion.button>\n                        )}\n                      </div>\n\n                      <div className=\"flex gap-2\">\n                        <motion.button\n                          onClick={() => setShowCanvasPicker(true)}\n                          whileHover={{ backgroundColor: 'rgba(99, 102, 241, 0.1)' }}\n                          className=\"flex-1 py-3 border border-dashed border-indigo-500/30 rounded-xl flex flex-col items-center justify-center gap-1 hover:border-indigo-500/60 transition-all group\"\n                        >\n                          <Layout\n                            size={14}\n                            className=\"text-indigo-400 group-hover:scale-110 transition-transform\"\n                          />\n                          <span className=\"text-[8px] font-black uppercase text-slate-500 group-hover:text-indigo-300\">\n                            From Canvas\n                          </span>\n                        </motion.button>\n                        <motion.button\n                          onClick={() => styleInputRef.current?.click()}\n                          whileHover={{ backgroundColor: 'rgba(99, 102, 241, 0.1)' }}\n                          className=\"flex-1 py-3 border border-dashed border-indigo-500/30 rounded-xl flex flex-col items-center justify-center gap-1 hover:border-indigo-500/60 transition-all group\"\n                        >\n                          <Upload\n                            size={14}\n                            className=\"text-indigo-400 group-hover:scale-110 transition-transform\"\n                          />\n                          <span className=\"text-[8px] font-black uppercase text-slate-500 group-hover:text-indigo-300\">\n                            Upload File\n                          </span>\n                        </motion.button>\n                        <input\n                          type=\"file\"\n                          ref={styleInputRef}\n                          className=\"hidden\"\n                          accept=\"image/*\"\n                          onChange={handleStyleUpload}\n                          aria-label=\"Upload style reference image\"\n                        />\n                      </div>\n\n                      {styleRefBase64 && (\n                        <div className=\"relative aspect-[4/1] w-full bg-slate-900 border border-indigo-500/50 rounded-lg overflow-hidden\">\n                          <img\n                            src={`data:${styleRefMimeType};base64,${styleRefBase64}`}\n                            className=\"w-full h-full object-cover opacity-60\"\n                            alt=\"Style reference preview\"\n                          />\n                          <div className=\"absolute inset-0 flex items-center justify-center bg-black/20\">\n                            <span className=\"text-[8px] font-black text-white uppercase tracking-widest bg-indigo-600/80 px-2 py-0.5 rounded shadow-sm\">\n                              Reference Active\n                            </span>\n                          </div>\n                        </div>\n                      )}\n\n                      <div className=\"space-y-2 group/slider\">\n                        <div className=\"flex justify-between items-center text-[9px] font-mono text-slate-500\">\n                          <span className=\"uppercase tracking-widest group-hover/slider:text-slate-300 transition-colors\">\n                            Fusion_Intensity\n                          </span>\n                          <span className=\"text-indigo-400 font-black\">\n                            {Math.round(styleIntensity * 100)}%\n                          </span>\n                        </div>\n                        <div className=\"h-1 bg-white/10 rounded-full relative cursor-pointer group\">\n                          <input\n                            type=\"range\"\n                            min=\"0.1\"\n                            max=\"1.0\"\n                            step=\"0.05\"\n                            value={styleIntensity}\n                            onChange={e => setStyleIntensity(parseFloat(e.target.value))}\n                            className=\"absolute inset-0 w-full opacity-0 cursor-pointer z-10\"\n                            aria-label=\"Style Fusion Intensity\"\n                          />\n                          <div\n                            className=\"h-full bg-indigo-500 rounded-full group-hover:bg-indigo-400 transition-all duration-200 shadow-[0_0_10px_rgba(99,102,241,0.5)]\"\n                             \n                            style={{ width: `${((styleIntensity - 0.1) / (1.0 - 0.1)) * 100}%` }}\n                          />\n                          <div\n                            className=\"absolute top-1/2 -translate-y-1/2 w-3 h-3 bg-white rounded-full shadow-md opacity-0 group-hover:opacity-100 transition-all duration-200 pointer-events-none group-hover:scale-125\"\n                             \n                            style={{\n                              left: `${((styleIntensity - 0.1) / (1.0 - 0.1)) * 100}%`,\n                              transform: 'translate(-50%, -50%)',\n                            }}\n                          />\n                        </div>\n                      </div>\n                    </div>\n\n                    <motion.button\n                      whileHover={{\n                        scale: 1.02,\n                        y: -2,\n                        backgroundColor: 'rgba(99, 102, 241, 1)',\n                        boxShadow: '0 10px 30px rgba(99, 102, 241, 0.4)',\n                      }}\n                      whileTap={{ scale: 0.98 }}\n                      transition={{ type: 'spring', stiffness: 400, damping: 17 }}\n                      onClick={() => handleApplyStyle()}\n                      disabled={\n                        (!styleRefBase64 && !prompt.trim() && !command.trim()) ||\n                        neuralTemperature > 0\n                      }\n                      className=\"w-full py-4 bg-gradient-to-r from-indigo-600 to-indigo-800 hover:from-indigo-500 hover:to-indigo-700 text-white rounded-full flex items-center justify-center gap-3 text-[11px] font-black uppercase tracking-[0.2em] shadow-xl transition-all disabled:opacity-30\"\n                    >\n                      {neuralTemperature > 0 ? (\n                        <Loader2 size={16} className=\"animate-spin\" />\n                      ) : (\n                        <Layers size={16} />\n                      )}\n                      Initiate_Fusion\n                    </motion.button>\n                  </>\n                )}\n              </motion.div>\n            )}\n\n            {activeTab === 'camera' && (\n              <motion.div\n                key=\"camera\"\n                initial={{ opacity: 0, y: 10 }}\n                animate={{ opacity: 1, y: 0 }}\n                exit={{ opacity: 0, y: -10 }}\n                className=\"space-y-6\"\n              >\n                <div className=\"space-y-1\">\n                  <h3 className=\"text-[10px] font-black text-slate-500 uppercase tracking-widest px-1\">\n                    Cinematic Perspectives\n                  </h3>\n                  <p className=\"text-[9px] font-mono text-slate-600 px-1\">\n                    Neural re-projection of the scene geometry.\n                  </p>\n                </div>\n                <div className=\"grid grid-cols-1 gap-3\">\n                  {cameraAngles.map(angle => (\n                    <motion.button\n                      key={angle.id}\n                      whileHover={{ scale: 1.02, backgroundColor: 'rgba(255,255,255,0.08)', x: 4 }}\n                      whileTap={{ scale: 0.98 }}\n                      transition={{ type: 'spring', stiffness: 400, damping: 20 }}\n                      onClick={() => handleApplyEdit(angle.prompt)}\n                      className=\"p-3 bg-white/5 border border-white/10 rounded-xl flex items-center gap-4 transition-all text-left group\"\n                    >\n                      <div className=\"w-10 h-10 rounded-lg bg-black/40 flex items-center justify-center border border-white/5\">\n                        <angle.icon size={18} className={angle.color} />\n                      </div>\n                      <div>\n                        <span className=\"text-[10px] font-black uppercase text-slate-300 tracking-wider group-hover:text-white block mb-0.5\">\n                          {angle.name}\n                        </span>\n                        <span className=\"text-[8px] font-mono text-slate-600 uppercase tracking-tight opacity-70\">\n                          AI Re-Framing Protocol\n                        </span>\n                      </div>\n                    </motion.button>\n                  ))}\n                </div>\n              </motion.div>\n            )}\n\n            {activeTab === 'atmosphere' && (\n              <motion.div\n                key=\"atmosphere\"\n                initial={{ opacity: 0, y: 10 }}\n                animate={{ opacity: 1, y: 0 }}\n                exit={{ opacity: 0, y: -10 }}\n                className=\"grid grid-cols-1 gap-3\"\n              >\n                {atmospheres.map(atm => (\n                  <motion.button\n                    key={atm.id}\n                    whileHover={{ scale: 1.02, backgroundColor: 'rgba(79, 70, 229, 0.15)', x: 6 }}\n                    whileTap={{ scale: 0.98 }}\n                    transition={{ type: 'spring', stiffness: 400, damping: 20 }}\n                    onClick={() => {\n                      handleFestiveTrigger(atm.mode);\n                      onClose();\n                    }}\n                    className=\"p-4 bg-white/5 border border-white/10 rounded-2xl flex items-center gap-4 text-left group\"\n                  >\n                    <div className=\"w-12 h-12 rounded-xl bg-indigo-500/10 flex items-center justify-center text-indigo-400 group-hover:bg-indigo-500 group-hover:text-white group-hover:scale-110 transition-all shadow-lg\">\n                      <atm.icon size={24} />\n                    </div>\n                    <div className=\"flex flex-col\">\n                      <span className=\"text-xs font-black uppercase text-white tracking-widest group-hover:text-indigo-400 transition-colors\">\n                        {atm.name}\n                      </span>\n                      <span className=\"text-[9px] font-mono text-slate-500 uppercase\">\n                        {atm.desc}\n                      </span>\n                    </div>\n                  </motion.button>\n                ))}\n              </motion.div>\n            )}\n\n            {activeTab === 'backdrop' && (\n              <motion.div\n                key=\"backdrop\"\n                initial={{ opacity: 0, y: 10 }}\n                animate={{ opacity: 1, y: 0 }}\n                exit={{ opacity: 0, y: -10 }}\n                className=\"space-y-6 text-center\"\n              >\n                <motion.div\n                  whileHover={{ scale: 1.02 }}\n                  className=\"p-6 border-2 border-dashed border-indigo-500/20 bg-indigo-500/5 rounded-3xl flex flex-col items-center gap-4 transition-colors\"\n                >\n                  <div className=\"w-16 h-16 rounded-full bg-indigo-600/10 flex items-center justify-center text-indigo-400\">\n                    <Monitor size={32} />\n                  </div>\n                  <div className=\"space-y-1\">\n                    <h3 className=\"text-sm font-black text-white uppercase tracking-widest\">\n                      Ambient_Synthesis\n                    </h3>\n                    <p className=\"text-[9px] font-mono text-slate-500 uppercase leading-relaxed\">\n                      Generate a 16:9 cinematic backdrop derived from the semantic DNA of this\n                      asset.\n                    </p>\n                  </div>\n                </motion.div>\n\n                <motion.button\n                  whileHover={{\n                    scale: 1.02,\n                    y: -2,\n                    backgroundColor: 'rgba(79, 70, 229, 1)',\n                    boxShadow: '0 10px 40px rgba(99, 102, 241, 0.5)',\n                  }}\n                  whileTap={{ scale: 0.98 }}\n                  transition={{ type: 'spring', stiffness: 400, damping: 17 }}\n                  onClick={handleBackgroundGen}\n                  disabled={neuralTemperature > 0}\n                  className=\"w-full py-4 bg-gradient-to-r from-indigo-600 to-indigo-700 hover:from-indigo-500 hover:to-indigo-600 text-white rounded-full flex items-center justify-center gap-3 text-[12px] font-black uppercase tracking-[0.3em] transition-all shadow-2xl disabled:opacity-30\"\n                >\n                  {neuralTemperature > 0 ? (\n                    <Loader2 size={18} className=\"animate-spin\" />\n                  ) : (\n                    <Sparkles size={18} />\n                  )}\n                  Generate_Backdrop\n                </motion.button>\n              </motion.div>\n            )}\n\n            {activeTab === 'upscale' && (\n              <motion.div\n                key=\"upscale\"\n                initial={{ opacity: 0, y: 10 }}\n                animate={{ opacity: 1, y: 0 }}\n                exit={{ opacity: 0, y: -10 }}\n                className=\"space-y-6 text-center\"\n              >\n                <motion.div\n                  whileHover={{ scale: 1.02 }}\n                  className=\"p-6 border-2 border-dashed border-indigo-500/20 bg-indigo-500/5 rounded-3xl flex flex-col items-center gap-4 transition-colors\"\n                >\n                  <div className=\"w-16 h-16 rounded-full bg-indigo-600/10 flex items-center justify-center text-indigo-400\">\n                    <Maximize2 size={32} />\n                  </div>\n                  <div className=\"space-y-1\">\n                    <h3 className=\"text-sm font-black text-white uppercase tracking-widest\">\n                      Neural_4K_Upscale\n                    </h3>\n                    <p className=\"text-[9px] font-mono text-slate-500 uppercase leading-relaxed\">\n                      Synthesize high-frequency detail using Gemini 3 Pro Vision.\n                    </p>\n                  </div>\n                </motion.div>\n\n                <div className=\"space-y-2 px-2\">\n                  <div className=\"flex justify-between items-center text-[9px] font-mono text-slate-500\">\n                    <span className=\"uppercase tracking-widest\">Detail_Synthesis</span>\n                    <span className=\"text-indigo-400 font-black\">\n                      {Math.round(upscaleCreativity * 100)}%\n                    </span>\n                  </div>\n                  <div className=\"h-1 bg-slate-800 rounded-full relative\">\n                    <input\n                      type=\"range\"\n                      min=\"0\"\n                      max=\"1\"\n                      step=\"0.1\"\n                      value={upscaleCreativity}\n                      onChange={e => setUpscaleCreativity(parseFloat(e.target.value))}\n                      className=\"absolute inset-0 w-full opacity-0 cursor-pointer z-10\"\n                      aria-label=\"Detail Synthesis Level\"\n                    />\n                    <div\n                      className=\"h-full bg-indigo-500 rounded-full transition-all duration-200 shadow-[0_0_10px_rgba(99,102,241,0.5)]\"\n                       \n                      style={{ width: `${upscaleCreativity * 100}%` }}\n                    />\n                    <div\n                      className=\"absolute top-1/2 -translate-y-1/2 w-3 h-3 bg-white rounded-full shadow-md pointer-events-none transition-all duration-200\"\n                       \n                      style={{\n                        left: `${upscaleCreativity * 100}%`,\n                        transform: 'translate(-50%, -50%)',\n                      }}\n                    />\n                  </div>\n                  <div className=\"flex justify-between text-[7px] text-slate-600 uppercase font-black tracking-widest pt-1\">\n                    <span>Strict Fidelity</span>\n                    <span>Hallucinate Detail</span>\n                  </div>\n                </div>\n\n                <motion.button\n                  whileHover={{\n                    scale: 1.02,\n                    y: -2,\n                    backgroundColor: 'rgba(79, 70, 229, 1)',\n                    boxShadow: '0 10px 40px rgba(99, 102, 241, 0.5)',\n                  }}\n                  whileTap={{ scale: 0.98 }}\n                  transition={{ type: 'spring', stiffness: 400, damping: 17 }}\n                  onClick={handleUpscaleTrigger}\n                  disabled={neuralTemperature > 0}\n                  className=\"w-full py-4 bg-gradient-to-r from-indigo-600 to-indigo-700 hover:from-indigo-500 hover:to-indigo-600 text-white rounded-full flex items-center justify-center gap-3 text-[12px] font-black uppercase tracking-[0.3em] transition-all shadow-2xl disabled:opacity-30\"\n                >\n                  {neuralTemperature > 0 ? (\n                    <Loader2 size={18} className=\"animate-spin\" />\n                  ) : (\n                    <Sparkles size={18} />\n                  )}\n                  Initiate_4K_Forge\n                </motion.button>\n              </motion.div>\n            )}\n          </AnimatePresence>\n        </div>\n\n        <div className=\"px-6 py-3 bg-indigo-500/5 flex items-center justify-between border-t border-white/5\">\n          <div className=\"flex items-center gap-3\">\n            <div\n              className={`w-2 h-2 rounded-full ${neuralTemperature > 0 ? 'bg-cyan-400 animate-pulse shadow-[0_0_8px_#22d3ee]' : 'bg-slate-600'}`}\n            />\n            <span className=\"text-[9px] font-black text-slate-500 uppercase tracking-widest\">\n              {neuralTemperature > 0 ? 'Neural_Synthesis_Active' : 'Forge_Standby'}\n            </span>\n          </div>\n        </div>\n      </div>\n      <div className=\"w-5 h-5 bg-black/95 border-r border-b border-indigo-500/30 rotate-45 absolute -bottom-2.5 left-1/2 -translate-x-1/2 z-[-1] shadow-2xl\" />\n    </motion.div>\n  );\n};\n\nconst TabItem = ({ active, onClick, icon: Icon, label }: any) => (\n  <motion.button\n    whileHover={{ backgroundColor: active ? 'rgba(79, 70, 229, 1)' : 'rgba(255,255,255,0.08)' }}\n    whileTap={{ scale: 0.9 }}\n    onClick={onClick}\n    className={`px-3 py-1.5 rounded-full text-[9px] font-black uppercase tracking-widest transition-all relative z-10 ${active ? 'bg-indigo-600 text-white shadow-lg' : 'text-slate-500 hover:text-slate-300'}`}\n  >\n    <span className=\"flex items-center gap-1.5 relative z-10\">\n      <Icon size={11} /> {label}\n    </span>\n    {active && (\n      <motion.div\n        layoutId=\"nano-active-tab\"\n        className=\"absolute inset-0 bg-indigo-600 rounded-full shadow-lg\"\n        transition={{ type: 'spring', stiffness: 500, damping: 30 }}\n      />\n    )}\n  </motion.button>\n);\n\nconst ToolBtn = ({ active, onClick, icon: Icon }: any) => (\n  <motion.button\n    whileHover={{\n      scale: 1.1,\n      backgroundColor: active ? 'rgba(79, 70, 229, 1)' : 'rgba(255,255,255,0.1)',\n    }}\n    whileTap={{ scale: 0.9 }}\n    onClick={onClick}\n    className={`p-2 rounded-md transition-all ${active ? 'bg-indigo-600 text-white shadow-md' : 'text-slate-500 hover:text-slate-300'}`}\n  >\n    <Icon size={14} />\n  </motion.button>\n);\n\nconst InpaintActionBtn = ({ icon: Icon, label, onClick, color, disabled }: any) => (\n  <motion.button\n    whileHover={{\n      backgroundColor: `rgba(${color === 'rose' ? '244, 63, 94' : '6, 182, 212'}, 0.15)`,\n      scale: 1.02,\n    }}\n    whileTap={{ scale: 0.95 }}\n    onClick={onClick}\n    disabled={disabled}\n    className={`p-3 bg-${color}-500/10 border border-${color}-500/20 rounded-xl transition-all flex items-center justify-center gap-3 group disabled:opacity-30 shadow-md`}\n  >\n    <Icon size={14} className={`text-${color}-400 group-hover:scale-110 transition-transform`} />\n    <span className={`text-[9px] font-black uppercase text-${color}-300 tracking-widest`}>\n      {label}\n    </span>\n  </motion.button>\n);\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\cweir\\Downloads\\neural-canvas\\components\\GooglePhotosBrowser.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Loader' is defined but never used. Allowed unused vars must match /^_/u.","line":12,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":12,"endColumn":9},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'ArrowRight' is defined but never used. Allowed unused vars must match /^_/u.","line":15,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":15,"endColumn":13},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'ExternalLink' is defined but never used. Allowed unused vars must match /^_/u.","line":18,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":18,"endColumn":15},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'loadAlbums'. Either include it or remove the dependency array.","line":44,"column":6,"nodeType":"ArrayExpression","endLine":44,"endColumn":25,"suggestions":[{"desc":"Update the dependencies array to be: [googlePhotosToken, loadAlbums]","fix":{"range":[1254,1273],"text":"[googlePhotosToken, loadAlbums]"}}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":56,"column":19,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":56,"endColumn":22,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1572,1575],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1572,1575],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'err' is defined but never used.","line":70,"column":14,"nodeType":null,"messageId":"unusedVar","endLine":70,"endColumn":17},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":70,"column":19,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":70,"endColumn":22,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1962,1965],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1962,1965],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'err' is defined but never used.","line":116,"column":14,"nodeType":null,"messageId":"unusedVar","endLine":116,"endColumn":17},{"ruleId":"react/no-unescaped-entities","severity":1,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":164,"column":36,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[5760,5834],"text":"\n                      If app is in &quot;Testing\" mode, add your email to the "},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[5760,5834],"text":"\n                      If app is in &ldquo;Testing\" mode, add your email to the "},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[5760,5834],"text":"\n                      If app is in &#34;Testing\" mode, add your email to the "},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[5760,5834],"text":"\n                      If app is in &rdquo;Testing\" mode, add your email to the "},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":1,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":164,"column":44,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[5760,5834],"text":"\n                      If app is in \"Testing&quot; mode, add your email to the "},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[5760,5834],"text":"\n                      If app is in \"Testing&ldquo; mode, add your email to the "},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[5760,5834],"text":"\n                      If app is in \"Testing&#34; mode, add your email to the "},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[5760,5834],"text":"\n                      If app is in \"Testing&rdquo; mode, add your email to the "},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":1,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":168,"column":51,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[6024,6041],"text":"&quot;Web application\""},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[6024,6041],"text":"&ldquo;Web application\""},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[6024,6041],"text":"&#34;Web application\""},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[6024,6041],"text":"&rdquo;Web application\""},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":1,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":168,"column":67,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[6024,6041],"text":"\"Web application&quot;"},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[6024,6041],"text":"\"Web application&ldquo;"},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[6024,6041],"text":"\"Web application&#34;"},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[6024,6041],"text":"\"Web application&rdquo;"},"desc":"Replace with `&rdquo;`."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":12,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { useStore } from '../store/useStore';\nimport {\n  authenticateGooglePhotos,\n  listAlbums,\n  getAlbumMedia,\n} from '../services/googlePhotosService';\nimport { GoogleAlbum } from '../types';\nimport {\n  X,\n  Cloud,\n  Loader,\n  Key,\n  AlertTriangle,\n  ArrowRight,\n  Loader2,\n  HelpCircle,\n  ExternalLink,\n} from 'lucide-react';\nimport { TiltCard } from './ui/TiltCard';\n\ninterface GooglePhotosBrowserProps {\n  onClose: () => void;\n}\n\nexport const GooglePhotosBrowser: React.FC<GooglePhotosBrowserProps> = ({ onClose }) => {\n  const { googlePhotosToken, setGooglePhotosToken, addImage } = useStore();\n  const [albums, setAlbums] = useState<GoogleAlbum[]>([]);\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n  const [clientId, setClientId] = useState(process.env.GOOGLE_CLIENT_ID || '');\n  const [importingAlbumId, setImportingAlbumId] = useState<string | null>(null);\n  const [importProgress, setImportProgress] = useState({\n    current: 0,\n    total: 0,\n  });\n  const [showHelp, setShowHelp] = useState(false);\n\n  // If we have a token, load albums on mount\n  useEffect(() => {\n    if (googlePhotosToken) {\n      loadAlbums();\n    }\n  }, [googlePhotosToken]);\n\n  const handleConnect = async () => {\n    if (!clientId.trim()) {\n      setError('Client ID is required.');\n      return;\n    }\n    setLoading(true);\n    setError(null);\n    try {\n      const token = await authenticateGooglePhotos(clientId);\n      setGooglePhotosToken(token);\n    } catch (err: any) {\n      setError(err.message || 'Authentication failed');\n      setLoading(false);\n      setShowHelp(true); // Auto-show help on error\n    }\n  };\n\n  const loadAlbums = async () => {\n    if (!googlePhotosToken) return;\n    setLoading(true);\n    setError(null);\n    try {\n      const fetchedAlbums = await listAlbums(googlePhotosToken);\n      setAlbums(fetchedAlbums);\n    } catch (err: any) {\n      setError('Failed to fetch albums. Token might be expired.');\n      setGooglePhotosToken(''); // Clear invalid token\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleImportAlbum = async (album: GoogleAlbum) => {\n    if (!googlePhotosToken) return;\n    setImportingAlbumId(album.id);\n    setImportProgress({ current: 0, total: 0 });\n\n    try {\n      const mediaItems = await getAlbumMedia(googlePhotosToken, album.id);\n      setImportProgress({ current: 0, total: mediaItems.length });\n\n      // Ingest sequentially or in batches to avoid overwhelming the canvas/Gemini\n      for (let i = 0; i < mediaItems.length; i++) {\n        const item = mediaItems[i];\n\n        // We assume we can access the baseUrl directly.\n        // For higher res: append =w2048-h2048\n        const highResUrl = `${item.baseUrl}=w2048-h2048`;\n\n        addImage({\n          id: Math.random().toString(36).substring(2, 11),\n          url: highResUrl, // Use URL directly\n          width: parseInt(item.mediaMetadata.width),\n          height: parseInt(item.mediaMetadata.height),\n          x: 100 + Math.random() * 200,\n          y: 100 + Math.random() * 200,\n          rotation: 0,\n          scale: 1,\n          tags: ['analyzing...', 'g_photos'],\n          analyzed: false,\n          timestamp: Date.now(),\n        });\n\n        setImportProgress(prev => ({ ...prev, current: i + 1 }));\n        // Slower delay (1s) to reduce burst rate on the API queue\n        await new Promise(r => setTimeout(r, 1000));\n      }\n\n      // Done\n      onClose();\n    } catch (err) {\n      setError('Failed to import media.');\n    } finally {\n      setImportingAlbumId(null);\n    }\n  };\n\n  return (\n    <div className=\"fixed inset-0 z-[100] flex items-center justify-center bg-black/80 backdrop-blur-sm p-8\">\n      <div className=\"w-full max-w-4xl h-[80vh] bg-black/90 border border-indigo-500/30 rounded-lg flex flex-col shadow-[0_0_50px_rgba(99,102,241,0.2)] animate-in fade-in zoom-in-95 duration-200\">\n        {/* HEADER */}\n        <div className=\"h-16 flex items-center justify-between px-6 border-b border-indigo-900/50 bg-indigo-950/20\">\n          <div className=\"flex items-center gap-3\">\n            <Cloud className=\"text-indigo-400\" />\n            <h2 className=\"text-lg font-mono font-bold text-indigo-100 tracking-widest uppercase\">\n              Quantum_Bridge // Cloud_Vault\n            </h2>\n          </div>\n          <button\n            onClick={onClose}\n            className=\"text-indigo-700 hover:text-white transition-colors\"\n            aria-label=\"Close Google Photos browser\"\n          >\n            <X />\n          </button>\n        </div>\n\n        {/* CONTENT */}\n        <div className=\"flex-1 overflow-hidden relative p-6 flex flex-col\">\n          {error && (\n            <div className=\"mb-6 bg-rose-900/20 border border-rose-500/50 p-3 rounded text-rose-300 font-mono text-xs flex flex-col gap-2 animate-in slide-in-from-top-2\">\n              <div className=\"flex items-center gap-2 font-bold\">\n                <AlertTriangle size={14} />\n                AUTH_FAILURE: {error}\n              </div>\n              {showHelp && (\n                <div className=\"pl-6 text-slate-400 leading-relaxed\">\n                  <p className=\"mb-1\">Troubleshooting New Credentials:</p>\n                  <ul className=\"list-disc pl-4 space-y-1\">\n                    <li>\n                      Ensure <strong>Authorized JavaScript origins</strong> in Google Cloud Console\n                      exactly matches:{' '}\n                      <code className=\"text-white bg-black/30 px-1 rounded\">\n                        {window.location.origin}\n                      </code>{' '}\n                      (Check http vs https and trailing slashes).\n                    </li>\n                    <li>\n                      If app is in \"Testing\" mode, add your email to the <strong>Test Users</strong>{' '}\n                      list in the OAuth Consent Screen.\n                    </li>\n                    <li>\n                      Ensure you selected <strong>\"Web application\"</strong> as the application\n                      type, not Desktop/Android.\n                    </li>\n                  </ul>\n                </div>\n              )}\n            </div>\n          )}\n\n          {!googlePhotosToken ? (\n            // AUTH SCREEN\n            <div className=\"flex flex-col items-center justify-center h-full space-y-6\">\n              <div className=\"w-20 h-20 bg-indigo-900/20 rounded-full flex items-center justify-center animate-pulse\">\n                <Key className=\"text-indigo-500\" size={32} />\n              </div>\n              <div className=\"text-center space-y-2\">\n                <h3 className=\"text-xl text-indigo-100 font-bold uppercase tracking-tighter\">\n                  Authentication_Required\n                </h3>\n                <p className=\"text-indigo-500/60 text-sm max-w-md\">\n                  To bridge the gap between Google Photos and the Neural Canvas, an OAuth 2.0 Access\n                  Token is required.\n                </p>\n              </div>\n\n              <div className=\"w-full max-w-md space-y-4\">\n                {!process.env.GOOGLE_CLIENT_ID && (\n                  <div className=\"space-y-1\">\n                    <div className=\"flex justify-between\">\n                      <label className=\"text-[10px] font-mono text-indigo-600 uppercase tracking-widest\">\n                        GCP_Client_ID\n                      </label>\n                      <button\n                        onClick={() => setShowHelp(!showHelp)}\n                        className=\"flex items-center gap-1 text-[9px] text-slate-500 hover:text-white transition-colors\"\n                      >\n                        <HelpCircle size={10} /> Configuration Help\n                      </button>\n                    </div>\n                    <input\n                      className=\"w-full bg-black border border-indigo-800 rounded p-2 text-indigo-100 outline-none focus:border-indigo-500 text-xs font-mono\"\n                      placeholder=\"Enter your Google Cloud Client ID\"\n                      value={clientId}\n                      onChange={e => setClientId(e.target.value)}\n                    />\n                  </div>\n                )}\n\n                <button\n                  onClick={handleConnect}\n                  disabled={loading || !clientId}\n                  className=\"w-full py-3 bg-indigo-600 hover:bg-indigo-500 text-white font-bold tracking-[0.2em] rounded transition-all disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2 uppercase text-xs\"\n                >\n                  {loading ? (\n                    <Loader2 className=\"animate-spin\" size={16} />\n                  ) : (\n                    'Initiate_OAuth_Sequence'\n                  )}\n                </button>\n              </div>\n            </div>\n          ) : (\n            // ALBUM GRID AREA\n            <div className=\"h-full overflow-hidden relative\">\n              {loading ? (\n                <div className=\"flex flex-col items-center justify-center h-full gap-4 text-indigo-400 animate-in fade-in\">\n                  <Loader2 className=\"animate-spin\" size={48} />\n                  <div className=\"flex flex-col items-center gap-1\">\n                    <span className=\"text-[10px] font-black tracking-[0.4em] uppercase\">\n                      Synchronizing_Quantum_Link...\n                    </span>\n                    <span className=\"text-[8px] font-mono text-slate-500 opacity-60\">\n                      Handshaking with Google Photos API\n                    </span>\n                  </div>\n                </div>\n              ) : albums.length === 0 ? (\n                <div className=\"flex flex-col items-center justify-center h-full gap-4 opacity-40\">\n                  <Cloud size={48} className=\"text-slate-600\" />\n                  <span className=\"text-xs font-mono uppercase tracking-[0.3em] text-slate-500\">\n                    No_Albums_Detected_In_Sector\n                  </span>\n                </div>\n              ) : (\n                <div className=\"h-full overflow-y-auto custom-scrollbar\">\n                  <div className=\"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4 pb-6\">\n                    {albums.map(album => (\n                      <TiltCard\n                        key={album.id}\n                        className=\"group cursor-pointer aspect-square rounded-xl\"\n                        onClick={() => handleImportAlbum(album)}\n                      >\n                        <div className=\"flex-1 relative overflow-hidden bg-black/40\">\n                          <img\n                            src={album.coverPhotoBaseUrl}\n                            alt={`Cover for ${album.title} album`}\n                            className=\"absolute inset-0 w-full h-full object-cover opacity-60 group-hover:opacity-100 transition-opacity duration-300\"\n                          />\n                          <div className=\"absolute inset-0 bg-gradient-to-t from-black via-transparent to-transparent opacity-80\" />\n\n                          {importingAlbumId === album.id && (\n                            <div className=\"absolute inset-0 bg-black/80 flex flex-col items-center justify-center z-20 backdrop-blur-sm\">\n                              <Loader2 className=\"text-indigo-400 animate-spin mb-2\" />\n                              <span className=\"text-[10px] text-indigo-300 font-mono\">\n                                INGESTING {importProgress.current}/{importProgress.total}\n                              </span>\n                              <div className=\"w-20 h-1 bg-indigo-900 rounded-full mt-2 overflow-hidden\">\n                                <div\n                                  className={`h-full bg-indigo-400 transition-all duration-200 w-[${Math.round(\n                                    (importProgress.current / Math.max(importProgress.total, 1)) *\n                                      100\n                                  )}%]`}\n                                />\n                              </div>\n                            </div>\n                          )}\n\n                          <div className=\"absolute bottom-3 left-3 right-3\">\n                            <div className=\"text-xs font-black text-white truncate uppercase tracking-tighter\">\n                              {album.title}\n                            </div>\n                            <div className=\"text-[8px] text-indigo-400 font-mono uppercase tracking-widest mt-1\">\n                              {album.mediaItemsCount} ITEMS\n                            </div>\n                          </div>\n                        </div>\n                      </TiltCard>\n                    ))}\n                  </div>\n                </div>\n              )}\n            </div>\n          )}\n        </div>\n      </div>\n    </div>\n  );\n};\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\cweir\\Downloads\\neural-canvas\\components\\HighlightConfigPanel.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'AppMode' is defined but never used. Allowed unused vars must match /^_/u.","line":3,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":3,"endColumn":17},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'motion' is defined but never used. Allowed unused vars must match /^_/u.","line":20,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":20,"endColumn":16},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'setMode' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":28,"column":5,"nodeType":null,"messageId":"unusedVar","endLine":28,"endColumn":12},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'togglePlayback' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":29,"column":5,"nodeType":null,"messageId":"unusedVar","endLine":29,"endColumn":19},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":37,"column":55,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":37,"endColumn":58,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[738,741],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[738,741],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":75,"column":66,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":75,"endColumn":69,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1594,1597],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1594,1597],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":6,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React from 'react';\nimport { useStore } from '../store/useStore';\nimport { AppMode, BezelTheme, ThemeConfig, PresentationMode } from '../types';\nimport {\n  X,\n  Play,\n  Zap,\n  Snowflake,\n  Gift,\n  Monitor,\n  Palette,\n  Wind,\n  Check,\n  Library,\n  Camera,\n  ArrowUpRight,\n  Maximize2,\n  MoveVertical,\n} from 'lucide-react';\nimport { motion } from 'framer-motion';\n\nexport const HighlightConfigPanel = ({ onClose }: { onClose: () => void }) => {\n  const {\n    playback,\n    setBezelTheme,\n    setPlaybackSpeed,\n    toggleQuadMode,\n    setMode,\n    togglePlayback,\n    playReel,\n    setSnowDensity,\n    savedThemes,\n    setCustomTheme,\n    setPresentationMode,\n  } = useStore();\n\n  const themes: { id: BezelTheme; name: string; icon: any; color: string; desc: string }[] = [\n    {\n      id: 'standard',\n      name: 'Standard',\n      icon: Monitor,\n      color: 'text-gray-400',\n      desc: 'Clean, minimalist bezel.',\n    },\n    {\n      id: 'christmas',\n      name: 'Holiday',\n      icon: Gift,\n      color: 'text-red-400',\n      desc: 'Decorations, snow, and warmth.',\n    },\n    {\n      id: 'frost',\n      name: 'Cryo',\n      icon: Snowflake,\n      color: 'text-cyan-300',\n      desc: 'Frozen glass and ice particles.',\n    },\n    {\n      id: 'gold',\n      name: 'Midas',\n      icon: Zap,\n      color: 'text-yellow-400',\n      desc: 'Luxurious gold leaf finish.',\n    },\n    {\n      id: 'candy',\n      name: 'Candy',\n      icon: Palette,\n      color: 'text-pink-400',\n      desc: 'Vibrant pop-art aesthetic.',\n    },\n  ];\n\n  const cameraModes: { id: PresentationMode; name: string; icon: any }[] = [\n    { id: 'flat', name: 'Flat', icon: Monitor },\n    { id: 'dutch', name: 'Dutch', icon: ArrowUpRight },\n    { id: 'low-angle', name: 'Low', icon: MoveVertical },\n    { id: 'overhead', name: 'Top', icon: MoveVertical }, // Reused icon but rotation handled in logic\n    { id: 'immersive', name: 'Wide', icon: Maximize2 },\n  ];\n\n  const handleLaunch = () => {\n    // Use playReel to ensure proper initialization of the orchestrator state\n    playReel();\n    onClose();\n  };\n\n  const handleCustomThemeSelect = (theme: ThemeConfig) => {\n    setCustomTheme(theme);\n  };\n\n  return (\n    <div className=\"fixed inset-0 z-[200] flex items-center justify-center bg-black/90 backdrop-blur-md p-6\">\n      <div className=\"w-full max-w-5xl h-[80vh] bg-[#050508] border border-white/10 rounded-3xl flex overflow-hidden shadow-[0_0_100px_rgba(0,0,0,0.8)]\">\n        {/* --- LEFT: VISUAL PREVIEW (Mini Theater) --- */}\n        <div className=\"w-[45%] bg-[#020202] relative border-r border-white/5 p-8 flex flex-col items-center justify-center gap-6\">\n          <div className=\"absolute top-6 left-6 text-[10px] font-black text-slate-600 uppercase tracking-widest\">\n            Pre-Flight Visualizer\n          </div>\n\n          {/* The Screen Representation */}\n          <div\n            className={`\n                    relative aspect-video w-full rounded-xl bg-black overflow-hidden shadow-2xl transition-all duration-500\n                    ${\n                      playback.bezelTheme === 'christmas'\n                        ? 'border-[8px] border-[#3f0e0e] shadow-red-900/20'\n                        : playback.bezelTheme === 'gold'\n                          ? 'border-[4px] border-yellow-700 shadow-yellow-900/20'\n                          : playback.bezelTheme === 'custom' && playback.activeThemeConfig\n                            ? ''\n                            : 'border-[4px] border-slate-800'\n                    }\n                `}\n             \n            style={{\n              ...(playback.bezelTheme === 'custom' && playback.activeThemeConfig\n                ? {\n                    border: `8px solid ${playback.activeThemeConfig.bezelColor}`,\n                    boxShadow: `0 0 40px ${playback.activeThemeConfig.accentColor}40`,\n                  }\n                : {}),\n              // Simulate the camera angle in preview (scaled down effect)\n              transform:\n                playback.presentationMode === 'dutch'\n                  ? 'rotateZ(-3deg) scale(0.95)'\n                  : playback.presentationMode === 'low-angle'\n                    ? 'perspective(800px) rotateX(10deg)'\n                    : playback.presentationMode === 'overhead'\n                      ? 'perspective(800px) rotateX(-10deg)'\n                      : playback.presentationMode === 'immersive'\n                        ? 'scale(1.05)'\n                        : 'none',\n            }}\n          >\n            {/* Simulated Content */}\n            <div className=\"absolute inset-0 flex items-center justify-center\">\n              <div className=\"text-white/10 font-mono text-4xl font-black tracking-tighter\">\n                PREVIEW\n              </div>\n            </div>\n\n            {/* Theme Overlays (Simplified for Preview) */}\n            {playback.bezelTheme === 'christmas' && (\n              <>\n                <div className=\"absolute top-0 w-full h-8 bg-gradient-to-b from-red-500/10 to-transparent\" />\n                <div className=\"absolute inset-0 bg-[url('https://www.transparenttextures.com/patterns/snow.png')] opacity-20\" />\n              </>\n            )}\n            {playback.bezelTheme === 'frost' && (\n              <div className=\"absolute inset-0 border-[20px] border-white/10 rounded-lg blur-md\" />\n            )}\n            {playback.bezelTheme === 'custom' &&\n              playback.activeThemeConfig?.bezelTexture !== 'none' && (\n                <div\n                  className=\"absolute inset-0 z-[50] pointer-events-none opacity-50 mix-blend-overlay\"\n                   \n                  style={{ backgroundImage: playback.activeThemeConfig?.bezelTexture }}\n                />\n              )}\n          </div>\n\n          <div className=\"text-center space-y-2 max-w-xs\">\n            <h2 className=\"text-2xl font-black text-white uppercase tracking-tighter\">\n              {playback.bezelTheme === 'custom' && playback.activeThemeConfig\n                ? playback.activeThemeConfig.name\n                : themes.find(t => t.id === playback.bezelTheme)?.name}{' '}\n              Mode\n            </h2>\n            <p className=\"text-xs font-mono text-slate-500 leading-relaxed\">\n              {playback.bezelTheme === 'custom' && playback.activeThemeConfig\n                ? playback.activeThemeConfig.description\n                : themes.find(t => t.id === playback.bezelTheme)?.desc}\n            </p>\n          </div>\n        </div>\n\n        {/* --- RIGHT: CONFIGURATION GRID --- */}\n        <div className=\"flex-1 flex flex-col bg-[#0a0a0a]\">\n          {/* Header */}\n          <div className=\"h-20 flex items-center justify-between px-8 border-b border-white/5\">\n            <div className=\"flex items-center gap-3\">\n              <Monitor size={20} className=\"text-indigo-500\" />\n              <span className=\"text-sm font-black text-white uppercase tracking-[0.2em]\">\n                Theater_Config\n              </span>\n            </div>\n            <button\n              onClick={onClose}\n              className=\"w-10 h-10 flex items-center justify-center rounded-full bg-white/5 hover:bg-white/10 text-slate-400 hover:text-white transition-colors\"\n              aria-label=\"Close panel\"\n            >\n              <X size={18} />\n            </button>\n          </div>\n\n          <div className=\"flex-1 overflow-y-auto custom-scrollbar p-8 space-y-10\">\n            {/* 1. Theme Grid */}\n            <div className=\"space-y-4\">\n              <label className=\"text-[10px] font-black text-slate-500 uppercase tracking-widest\">\n                System Presets\n              </label>\n              <div className=\"grid grid-cols-3 gap-3\">\n                {themes.map(t => {\n                  const isActive = playback.bezelTheme === t.id;\n                  return (\n                    <button\n                      key={t.id}\n                      onClick={() => setBezelTheme(t.id)}\n                      className={`\n                                            relative h-28 rounded-2xl border flex flex-col items-center justify-center gap-3 transition-all group\n                                            ${\n                                              isActive\n                                                ? 'bg-indigo-500/10 border-indigo-500 ring-1 ring-indigo-500/50'\n                                                : 'bg-black border-white/10 hover:border-white/30 hover:bg-white/5'\n                                            }\n                                        `}\n                    >\n                      <div\n                        className={`p-2 rounded-full ${isActive ? 'bg-indigo-500 text-white' : 'bg-white/5 text-slate-500 group-hover:text-white'}`}\n                      >\n                        <t.icon size={20} />\n                      </div>\n                      <span\n                        className={`text-[10px] font-black uppercase tracking-widest ${isActive ? 'text-white' : 'text-slate-500'}`}\n                      >\n                        {t.name}\n                      </span>\n                      {isActive && (\n                        <div className=\"absolute top-3 right-3 bg-indigo-500 text-white rounded-full p-0.5\">\n                          <Check size={10} />\n                        </div>\n                      )}\n                    </button>\n                  );\n                })}\n              </div>\n            </div>\n\n            {/* 2. Custom Themes */}\n            {savedThemes.length > 0 && (\n              <div className=\"space-y-4\">\n                <label className=\"text-[10px] font-black text-slate-500 uppercase tracking-widest flex items-center gap-2\">\n                  <Library size={10} /> My Themes\n                </label>\n                <div className=\"grid grid-cols-3 gap-3\">\n                  {savedThemes.map(t => {\n                    const isActive =\n                      playback.bezelTheme === 'custom' && playback.activeThemeConfig?.id === t.id;\n                    return (\n                      <button\n                        key={t.id}\n                        onClick={() => handleCustomThemeSelect(t)}\n                        className={`\n                                                relative h-28 rounded-2xl border flex flex-col items-center justify-center gap-3 transition-all group\n                                                ${\n                                                  isActive\n                                                    ? 'bg-emerald-500/10 border-emerald-500 ring-1 ring-emerald-500/50'\n                                                    : 'bg-black border-white/10 hover:border-emerald-500/30 hover:bg-white/5'\n                                                }\n                                        `}\n                      >\n                        <div className=\"flex gap-1 absolute top-3 left-3\">\n                          <div\n                            className=\"w-2 h-2 rounded-full\"\n                             \n                            style={{ backgroundColor: t.bezelColor }}\n                          />\n                          <div\n                            className=\"w-2 h-2 rounded-full\"\n                             \n                            style={{ backgroundColor: t.accentColor }}\n                          />\n                        </div>\n                        <span\n                          className={`text-[10px] font-black uppercase tracking-widest mt-4 ${isActive ? 'text-white' : 'text-slate-500'}`}\n                        >\n                          {t.name}\n                        </span>\n                        {isActive && (\n                          <div className=\"absolute top-3 right-3 bg-emerald-500 text-white rounded-full p-0.5\">\n                            <Check size={10} />\n                          </div>\n                        )}\n                      </button>\n                    );\n                  })}\n                </div>\n              </div>\n            )}\n\n            {/* 3. Camera & View */}\n            <div className=\"grid grid-cols-1 gap-8\">\n              <div className=\"space-y-4\">\n                <label className=\"text-[10px] font-black text-slate-500 uppercase tracking-widest flex items-center gap-2\">\n                  <Camera size={12} /> Camera Perspective\n                </label>\n                <div className=\"flex bg-black p-1 rounded-xl border border-white/10 overflow-x-auto\">\n                  {cameraModes.map(mode => (\n                    <button\n                      key={mode.id}\n                      onClick={() => setPresentationMode(mode.id)}\n                      className={`\n                                            flex-1 py-3 px-2 rounded-lg flex flex-col items-center gap-2 transition-all min-w-[70px]\n                                            ${\n                                              playback.presentationMode === mode.id\n                                                ? 'bg-white text-black shadow-lg'\n                                                : 'text-slate-500 hover:text-white hover:bg-white/5'\n                                            }\n                                        `}\n                    >\n                      <mode.icon size={16} />\n                      <span className=\"text-[9px] font-black uppercase tracking-wider\">\n                        {mode.name}\n                      </span>\n                    </button>\n                  ))}\n                </div>\n              </div>\n            </div>\n\n            {/* 4. Parameters */}\n            <div className=\"grid grid-cols-2 gap-8\">\n              <div className=\"space-y-4\">\n                <div className=\"flex justify-between\">\n                  <label className=\"text-[10px] font-black text-slate-500 uppercase tracking-widest\">\n                    Slide Duration\n                  </label>\n                  <span className=\"text-[10px] font-mono text-indigo-400 font-bold\">\n                    {playback.speed}s\n                  </span>\n                </div>\n                <input\n                  type=\"range\"\n                  min=\"2\"\n                  max=\"15\"\n                  value={playback.speed}\n                  onChange={e => setPlaybackSpeed(parseInt(e.target.value))}\n                  className=\"w-full h-1.5 bg-slate-800 rounded-full appearance-none cursor-pointer accent-indigo-500\"\n                  aria-label=\"Slide Duration\"\n                />\n              </div>\n\n              <div className=\"space-y-4\">\n                <label className=\"text-[10px] font-black text-slate-500 uppercase tracking-widest\">\n                  View Mode\n                </label>\n                <div className=\"flex bg-black p-1 rounded-xl border border-white/10\">\n                  <button\n                    onClick={() => {\n                      if (playback.quadMode) toggleQuadMode();\n                    }}\n                    className={`flex-1 py-2 rounded-lg text-[10px] font-black uppercase tracking-wider transition-all ${!playback.quadMode ? 'bg-indigo-600 text-white shadow-lg' : 'text-slate-500 hover:text-slate-300'}`}\n                  >\n                    Single\n                  </button>\n                  <button\n                    onClick={() => {\n                      if (!playback.quadMode) toggleQuadMode();\n                    }}\n                    className={`flex-1 py-2 rounded-lg text-[10px] font-black uppercase tracking-wider transition-all ${playback.quadMode ? 'bg-indigo-600 text-white shadow-lg' : 'text-slate-500 hover:text-slate-300'}`}\n                  >\n                    Quad\n                  </button>\n                </div>\n              </div>\n            </div>\n\n            {/* 5. Conditional: Snow Density */}\n            {playback.bezelTheme === 'christmas' && (\n              <div className=\"p-4 rounded-xl bg-red-950/20 border border-red-900/30 space-y-4 animate-in fade-in slide-in-from-top-2\">\n                <div className=\"flex justify-between items-center text-red-300\">\n                  <div className=\"flex items-center gap-2\">\n                    <Wind size={14} />\n                    <span className=\"text-[10px] font-black uppercase tracking-widest\">\n                      Blizzard Intensity\n                    </span>\n                  </div>\n                  <span className=\"text-[10px] font-mono\">{playback.snowDensity}%</span>\n                </div>\n                <input\n                  type=\"range\"\n                  min=\"0\"\n                  max=\"100\"\n                  value={playback.snowDensity}\n                  onChange={e => setSnowDensity(parseInt(e.target.value))}\n                  className=\"w-full h-1.5 bg-red-900/30 rounded-full appearance-none cursor-pointer accent-red-500\"\n                  aria-label=\"Blizzard Intensity\"\n                />\n              </div>\n            )}\n          </div>\n\n          {/* Footer */}\n          <div className=\"p-8 border-t border-white/5 bg-white/[0.02]\">\n            <button\n              onClick={handleLaunch}\n              className=\"w-full py-4 bg-white text-black rounded-xl font-black text-sm uppercase tracking-[0.2em] flex items-center justify-center gap-3 hover:bg-indigo-50 hover:scale-[1.01] transition-all shadow-xl shadow-white/5\"\n            >\n              <Play size={18} fill=\"black\" /> Launch Experience\n            </button>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n};\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\cweir\\Downloads\\neural-canvas\\components\\HomeScreen.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Upload' is defined but never used. Allowed unused vars must match /^_/u.","line":6,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":6,"endColumn":9},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Hexagon' is defined but never used. Allowed unused vars must match /^_/u.","line":13,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":13,"endColumn":10},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Disc' is defined but never used. Allowed unused vars must match /^_/u.","line":15,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":15,"endColumn":7},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":331,"column":72,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":331,"endColumn":75,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[12563,12566],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[12563,12566],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":4,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useRef, useState } from 'react';\nimport { motion, useMotionValue, useTransform, useSpring, AnimatePresence } from 'framer-motion';\nimport { useStore } from '../store/useStore';\nimport { AppMode } from '../types';\nimport {\n  Upload,\n  Camera,\n  Layers,\n  Snowflake,\n  Activity,\n  Grid,\n  Cloud,\n  Hexagon,\n  Aperture,\n  Disc,\n} from 'lucide-react';\nimport { GooglePhotosBrowser } from './GooglePhotosBrowser';\nimport { NeuralLogo } from './ui/NeuralLogo';\n\nexport const HomeScreen: React.FC = () => {\n  const { setMode, addImage, holidaySpirit, neuralTemperature, setCameraOpen } = useStore();\n  const fileInputRef = useRef<HTMLInputElement>(null);\n  const [isDragging, setIsDragging] = useState(false);\n  const [showGooglePhotos, setShowGooglePhotos] = useState(false);\n\n  // --- 3D PARALLAX ENGINE ---\n  const x = useMotionValue(0);\n  const y = useMotionValue(0);\n\n  const mouseXSpring = useSpring(x, { stiffness: 50, damping: 20 });\n  const mouseYSpring = useSpring(y, { stiffness: 50, damping: 20 });\n\n  const rotateX = useTransform(mouseYSpring, [-0.5, 0.5], ['8deg', '-8deg']);\n  const rotateY = useTransform(mouseXSpring, [-0.5, 0.5], ['-8deg', '8deg']);\n\n  const bgMoveX = useTransform(mouseXSpring, [-0.5, 0.5], ['-30px', '30px']);\n  const bgMoveY = useTransform(mouseYSpring, [-0.5, 0.5], ['-30px', '30px']);\n\n  const handleMouseMove = (e: React.MouseEvent) => {\n    const rect = e.currentTarget.getBoundingClientRect();\n    x.set((e.clientX - rect.left) / rect.width - 0.5);\n    y.set((e.clientY - rect.top) / rect.height - 0.5);\n  };\n\n  const handleFileUpload = (e: React.ChangeEvent<HTMLInputElement> | React.DragEvent) => {\n    let files: FileList | null = null;\n    if ('files' in e.target && e.target.files) {\n      files = e.target.files;\n    } else if ('dataTransfer' in e && e.dataTransfer.files) {\n      files = e.dataTransfer.files;\n    }\n\n    if (files && files.length > 0) {\n      const fileList = Array.from(files).filter(f => f.type.startsWith('image/'));\n\n      // GRID LAYOUT CONSTANTS\n      const COLS = 6;\n      const ITEM_WIDTH = 250;\n      const GAP = 40;\n      const GRID_WIDTH = Math.min(fileList.length, COLS) * (ITEM_WIDTH + GAP);\n\n      // Start centered\n      const START_X = -(GRID_WIDTH / 2) + ITEM_WIDTH / 2;\n      const START_Y = -200;\n\n      fileList.forEach((file: File, i) => {\n        const col = i % COLS;\n        const row = Math.floor(i / COLS);\n        const x = START_X + col * (ITEM_WIDTH + GAP);\n        const y = START_Y + row * (ITEM_WIDTH + GAP);\n\n        const reader = new FileReader();\n        reader.onload = ev => {\n          const src = ev.target?.result as string;\n          const imgObj = new window.Image();\n          imgObj.src = src;\n          imgObj.onload = () => {\n            addImage({\n              id: Math.random().toString(36).substring(2, 11),\n              url: src,\n              file: file,\n              width: ITEM_WIDTH,\n              height: ITEM_WIDTH * (imgObj.height / imgObj.width),\n              x: x,\n              y: y,\n              rotation: 0,\n              scale: 1,\n              tags: ['analyzing...'],\n              analyzed: false,\n              timestamp: Date.now(),\n            });\n          };\n        };\n        reader.readAsDataURL(file);\n      });\n      setMode(AppMode.CANVAS);\n    }\n  };\n\n  // --- STAR FIELD MEMOIZATION ---\n  const stars = React.useMemo(() => {\n    return Array.from({ length: 40 }).map((_, i) => ({\n      id: i,\n      style: {\n        top: `${Math.random() * 100}%`,\n        left: `${Math.random() * 100}%`,\n        width: `${Math.random() * 2 + 1}px`,\n        height: `${Math.random() * 2 + 1}px`,\n        opacity: Math.random() * 0.5,\n        animationDuration: `${Math.random() * 3 + 2}s`,\n      },\n    }));\n  }, []);\n\n  return (\n    <div className=\"w-full h-full relative bg-[#020205] overflow-hidden\">\n      <AnimatePresence>\n        {showGooglePhotos && <GooglePhotosBrowser onClose={() => setShowGooglePhotos(false)} />}\n      </AnimatePresence>\n\n      {/* Background Atmosphere - Fixed relative to container */}\n      <motion.div\n        style={{ x: bgMoveX, y: bgMoveY }}\n        className=\"absolute inset-[-50px] pointer-events-none opacity-30 z-0\"\n      >\n        <div className=\"absolute inset-0 bg-[url('https://www.transparenttextures.com/patterns/pinstriped-suit.png')] mix-blend-screen opacity-50\" />\n        <div className=\"absolute inset-0 bg-[radial-gradient(circle_at_center,rgba(99,102,241,0.15),transparent_70%)]\" />\n\n        {/* Animated Star Field - CSS custom properties require style attribute */}\n        {stars.map(star => (\n           \n          <div\n            key={star.id}\n            className=\"star-field-item animate-pulse\"\n            style={\n              {\n                '--star-top': star.style.top,\n                '--star-left': star.style.left,\n                '--star-width': star.style.width,\n                '--star-height': star.style.height,\n                '--star-opacity': star.style.opacity,\n                '--star-duration': star.style.animationDuration,\n              } as React.CSSProperties\n            }\n          />\n        ))}\n      </motion.div>\n\n      {/* Scrollable Viewport Wrapper */}\n      <div\n        className=\"absolute inset-0 w-full h-full overflow-y-auto overflow-x-hidden custom-scrollbar perspective-1000 z-10\"\n        onMouseMove={handleMouseMove}\n        onDragOver={e => {\n          e.preventDefault();\n          setIsDragging(true);\n        }}\n        onDragLeave={() => setIsDragging(false)}\n        onDrop={e => {\n          e.preventDefault();\n          setIsDragging(false);\n          handleFileUpload(e);\n        }}\n      >\n        {/* Flex container to center content but allow scrolling */}\n        <div className=\"min-h-full w-full flex flex-col items-center justify-center py-24\">\n          <motion.div\n            style={{ rotateX, rotateY, transformStyle: 'preserve-3d' }}\n            className=\"relative z-10 flex flex-col items-center gap-16\"\n          >\n            {/* 1. TITLE / LOGO (TOP) */}\n            <div className=\"flex flex-col items-center translate-z-60\">\n              <div className=\"flex justify-between items-center w-full max-w-2xl px-8 mb-6 opacity-60\">\n                <div className=\"flex items-center gap-2\">\n                  <Activity size={12} className=\"text-indigo-400\" />\n                  <span className=\"text-[10px] font-mono text-indigo-300\">\n                    NEURAL_TEMP: {neuralTemperature.toFixed(0)}%\n                  </span>\n                </div>\n                <div className=\"flex items-center gap-2\">\n                  <Snowflake size={12} className=\"text-rose-400\" />\n                  <span className=\"text-[10px] font-mono text-rose-300\">\n                    SPIRIT: {holidaySpirit.toFixed(0)}%\n                  </span>\n                </div>\n              </div>\n\n              <NeuralLogo />\n              <p className=\"text-[10px] font-mono text-slate-500 uppercase tracking-[0.6em] opacity-60 mt-2\">\n                North_Star_v3 // Neural_Orchestrator\n              </p>\n            </div>\n\n            {/* 2. THE INGESTION IRIS (CENTERPIECE) */}\n            <div className=\"relative translate-z-40\">\n              {/* Orbital Satellites */}\n              <SatelliteButton\n                icon={Cloud}\n                label=\"Cloud_Link\"\n                angle={-45}\n                onClick={() => setShowGooglePhotos(true)}\n                color=\"text-sky-400\"\n              />\n              <SatelliteButton\n                icon={Camera}\n                label=\"Optic_Sensor\"\n                angle={45}\n                onClick={() => setCameraOpen(true)}\n                color=\"text-rose-400\"\n              />\n              <SatelliteButton\n                icon={Layers}\n                label=\"Constellation\"\n                angle={135}\n                onClick={() => setMode(AppMode.CANVAS)}\n                color=\"text-indigo-400\"\n              />\n              <SatelliteButton\n                icon={Grid}\n                label=\"Vault\"\n                angle={225}\n                onClick={() => setMode(AppMode.ASSETS)}\n                color=\"text-emerald-400\"\n              />\n\n              {/* The Iris Core */}\n              <motion.button\n                whileHover=\"hover\"\n                whileTap=\"tap\"\n                onClick={() => fileInputRef.current?.click()}\n                className=\"relative w-64 h-64 flex items-center justify-center outline-none group\"\n              >\n                {/* Outer Spinner */}\n                <motion.div\n                  className=\"absolute inset-0 rounded-full border border-dashed border-slate-700 opacity-60\"\n                  animate={{ rotate: 360 }}\n                  transition={{\n                    duration: 60,\n                    repeat: Infinity,\n                    ease: 'linear',\n                  }}\n                />\n\n                {/* Mid Spinner (Interactive) */}\n                <motion.div\n                  className=\"absolute inset-4 rounded-full border-2 border-indigo-500/30 border-t-transparent border-l-transparent\"\n                  animate={{ rotate: -360 }}\n                  transition={{\n                    duration: 20,\n                    repeat: Infinity,\n                    ease: 'linear',\n                  }}\n                  variants={{\n                    hover: {\n                      scale: 1.05,\n                      borderColor: 'rgba(99, 102, 241, 0.6)',\n                    },\n                  }}\n                />\n\n                {/* Data Rings */}\n                <div className=\"absolute inset-8 rounded-full border border-white/5 bg-black/40 backdrop-blur-md\" />\n\n                {/* The Core Pupil */}\n                <motion.div\n                  className=\"relative w-32 h-32 bg-[#0a0a0a] rounded-full border border-white/10 flex items-center justify-center shadow-[0_0_50px_rgba(0,0,0,0.5)] z-20 group-hover:border-indigo-500/50 transition-colors\"\n                  variants={{ hover: { scale: 1.1 } }}\n                >\n                  <div className=\"absolute inset-0 rounded-full bg-indigo-500/5 animate-pulse\" />\n                  <Aperture\n                    size={48}\n                    className=\"text-slate-600 group-hover:text-indigo-400 transition-colors\"\n                    strokeWidth={1}\n                  />\n\n                  <div className=\"absolute -bottom-10 text-[10px] font-black text-slate-600 uppercase tracking-[0.3em] group-hover:text-indigo-400 transition-colors\">\n                    Upload\n                  </div>\n                </motion.div>\n\n                {/* Hover Glow */}\n                <motion.div\n                  className=\"absolute inset-0 bg-indigo-500/20 rounded-full blur-[60px] opacity-0\"\n                  variants={{ hover: { opacity: 1 } }}\n                />\n              </motion.button>\n            </div>\n\n            <input\n              type=\"file\"\n              ref={fileInputRef}\n              className=\"hidden\"\n              multiple\n              accept=\"image/*\"\n              onChange={handleFileUpload}\n              aria-label=\"Select images to upload\"\n            />\n          </motion.div>\n        </div>\n      </div>\n\n      {/* Ingestion Suction Overlay - Fixed to viewport */}\n      <AnimatePresence>\n        {isDragging && (\n          <motion.div\n            initial={{ opacity: 0, scale: 0.8 }}\n            animate={{ opacity: 1, scale: 1 }}\n            exit={{ opacity: 0, scale: 0.8 }}\n            className=\"absolute inset-0 z-50 flex flex-col items-center justify-center pointer-events-none\"\n          >\n            <div className=\"absolute inset-0 bg-indigo-900/40 backdrop-blur-sm\" />\n            <motion.div\n              animate={{ rotate: 360 }}\n              transition={{ duration: 4, repeat: Infinity, ease: 'linear' }}\n              className=\"w-[600px] h-[600px] border-[2px] border-dashed border-cyan-400/50 rounded-full absolute\"\n            />\n            <motion.div\n              animate={{ rotate: -360 }}\n              transition={{ duration: 6, repeat: Infinity, ease: 'linear' }}\n              className=\"w-[400px] h-[400px] border-[4px] border-indigo-500/50 rounded-full absolute\"\n            />\n            <div className=\"relative z-10 text-3xl font-black text-white uppercase tracking-[0.3em] animate-pulse drop-shadow-[0_0_20px_rgba(99,102,241,1)]\">\n              Initiate_Ingestion\n            </div>\n          </motion.div>\n        )}\n      </AnimatePresence>\n    </div>\n  );\n};\n\nconst SatelliteButton = ({ icon: Icon, label, angle, onClick, color }: any) => {\n  const radius = 180; // Distance from center\n  const x = Math.cos((angle * Math.PI) / 180) * radius;\n  const y = Math.sin((angle * Math.PI) / 180) * radius;\n\n  /* MEMOIZED STYLE TO PREVENT LINT WARNINGS */\n  const buttonStyle = React.useMemo(\n    () => ({\n      left: '50%',\n      top: '50%',\n      x,\n      y,\n      marginLeft: -32, // half width\n      marginTop: -32, // half height\n    }),\n    [x, y]\n  );\n\n  return (\n    <motion.button\n      onClick={onClick}\n      whileHover={{ scale: 1.1 }}\n      whileTap={{ scale: 0.95 }}\n      className=\"absolute flex flex-col items-center gap-2 group z-30\"\n      style={buttonStyle}\n    >\n      <div\n        className={`w-16 h-16 rounded-full bg-[#0a0a0a] border border-white/10 flex items-center justify-center shadow-xl group-hover:border-white/30 transition-colors relative overflow-hidden`}\n      >\n        <div\n          className={`absolute inset-0 opacity-0 group-hover:opacity-10 bg-current transition-opacity ${color}`}\n        />\n        <Icon\n          size={24}\n          className={`${color} opacity-70 group-hover:opacity-100 group-hover:scale-110 transition-all`}\n        />\n      </div>\n      <span className=\"text-[9px] font-mono text-slate-600 uppercase tracking-widest bg-black/80 px-2 py-0.5 rounded border border-white/5 group-hover:text-white transition-colors\">\n        {label}\n      </span>\n    </motion.button>\n  );\n};\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\cweir\\Downloads\\neural-canvas\\components\\InfiniteCanvas.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\cweir\\Downloads\\neural-canvas\\components\\InspectorPanel.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Layers' is defined but never used. Allowed unused vars must match /^_/u.","line":5,"column":5,"nodeType":null,"messageId":"unusedVar","endLine":5,"endColumn":11},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'ChevronUp' is defined but never used. Allowed unused vars must match /^_/u.","line":5,"column":13,"nodeType":null,"messageId":"unusedVar","endLine":5,"endColumn":22},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'ChevronDown' is defined but never used. Allowed unused vars must match /^_/u.","line":5,"column":24,"nodeType":null,"messageId":"unusedVar","endLine":5,"endColumn":35},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'FlipHorizontal' is defined but never used. Allowed unused vars must match /^_/u.","line":5,"column":37,"nodeType":null,"messageId":"unusedVar","endLine":5,"endColumn":51},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'FlipVertical' is defined but never used. Allowed unused vars must match /^_/u.","line":5,"column":53,"nodeType":null,"messageId":"unusedVar","endLine":5,"endColumn":65},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Trash2' is defined but never used. Allowed unused vars must match /^_/u.","line":5,"column":67,"nodeType":null,"messageId":"unusedVar","endLine":5,"endColumn":73},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Hash' is defined but never used. Allowed unused vars must match /^_/u.","line":6,"column":5,"nodeType":null,"messageId":"unusedVar","endLine":6,"endColumn":9},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Tag' is defined but never used. Allowed unused vars must match /^_/u.","line":6,"column":11,"nodeType":null,"messageId":"unusedVar","endLine":6,"endColumn":14},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Filter' is defined but never used. Allowed unused vars must match /^_/u.","line":6,"column":16,"nodeType":null,"messageId":"unusedVar","endLine":6,"endColumn":22},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Maximize2' is defined but never used. Allowed unused vars must match /^_/u.","line":6,"column":24,"nodeType":null,"messageId":"unusedVar","endLine":6,"endColumn":33},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Crop' is defined but never used. Allowed unused vars must match /^_/u.","line":6,"column":54,"nodeType":null,"messageId":"unusedVar","endLine":6,"endColumn":58},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Monitor' is defined but never used. Allowed unused vars must match /^_/u.","line":6,"column":60,"nodeType":null,"messageId":"unusedVar","endLine":6,"endColumn":67},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Captions' is defined but never used. Allowed unused vars must match /^_/u.","line":6,"column":69,"nodeType":null,"messageId":"unusedVar","endLine":6,"endColumn":77},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Sliders' is defined but never used. Allowed unused vars must match /^_/u.","line":6,"column":79,"nodeType":null,"messageId":"unusedVar","endLine":6,"endColumn":86},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'neuralTemperature' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":18,"column":76,"nodeType":null,"messageId":"unusedVar","endLine":18,"endColumn":93},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'handleAddTag' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":25,"column":11,"nodeType":null,"messageId":"unusedVar","endLine":25,"endColumn":23},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":241,"column":40,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":241,"endColumn":43,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[14515,14518],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[14515,14518],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":17,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\nimport React, { useState } from 'react';\nimport { useStore } from '../store/useStore';\nimport { \n    Layers, ChevronUp, ChevronDown, FlipHorizontal, FlipVertical, Trash2, \n    Hash, Tag, Filter, Maximize2, Zap, BrainCircuit, Crop, Monitor, Captions, Sliders,\n    Grid3x3, Activity, Gauge, Film, Wand2, PlusCircle, LayoutGrid, Focus, Ratio, RotateCcw, RotateCw\n} from 'lucide-react';\nimport { motion, AnimatePresence } from 'framer-motion';\n\nconst TagChip: React.FC<{ label: string, color: string }> = ({ label, color }) => (\n    <span className={`text-[8px] px-1.5 py-0.5 rounded uppercase tracking-tight font-bold ${color}`}>\n        {label}\n    </span>\n);\n\nexport const InspectorPanel: React.FC = () => {\n    const { images, selectedIds, updateImage, removeImage, performUpscale, neuralTemperature, reanalyzeImage, addToReel, autoStyleImage, resetFilters, applyCompositionRule } = useStore();\n    const activeImage = images.find(img => selectedIds.includes(img.id));\n    const [newTag, setNewTag] = useState('');\n    const [isHoveringPreview, setIsHoveringPreview] = useState(false);\n\n    if (!activeImage) return <div className=\"p-8 text-center text-slate-600 font-mono text-[10px] uppercase\">No Selection Detected</div>;\n\n    const handleAddTag = () => {\n        if (!newTag.trim()) return;\n        updateImage(activeImage.id, { tags: [...activeImage.tags, newTag.trim().toLowerCase()] });\n        setNewTag('');\n    };\n\n    const hasComposition = !!activeImage.composition;\n\n    return (\n        <div className=\"flex flex-col gap-6 p-5\">\n            {/* PREVIEW CONTAINER */}\n            <div \n                className=\"bg-black/60 border border-white/10 rounded-2xl overflow-hidden shadow-xl aspect-video relative group\"\n                onMouseEnter={() => setIsHoveringPreview(true)}\n                onMouseLeave={() => setIsHoveringPreview(false)}\n            >\n                <div className=\"absolute inset-0 overflow-hidden\">\n                    <img \n                        src={activeImage.url} \n                        className=\"w-full h-full object-cover opacity-30 blur-xl scale-125\" \n                        style={{ transform: `rotate(${activeImage.rotation || 0}deg)` }}\n                    />\n                </div>\n                <img \n                    src={activeImage.url} \n                    className=\"absolute inset-0 w-full h-full object-contain z-10\" \n                    style={{ transform: `rotate(${activeImage.rotation || 0}deg)` }}\n                />\n                \n                {/* Overlay Action Button */}\n                <motion.button \n                    whileHover={{ scale: 1.1 }}\n                    whileTap={{ scale: 0.9 }}\n                    onClick={(e) => { e.stopPropagation(); addToReel([activeImage.id]); }}\n                    className=\"absolute top-3 right-3 z-30 bg-emerald-500 text-white p-2 rounded-full shadow-lg border border-emerald-400/50 hover:bg-emerald-400 transition-colors opacity-0 group-hover:opacity-100\"\n                    title=\"Quick Add to Reel\"\n                >\n                    <PlusCircle size={16} />\n                </motion.button>\n\n                {/* COMPOSITION OVERLAYS */}\n                <AnimatePresence>\n                    {isHoveringPreview && hasComposition && (\n                        <motion.div \n                            initial={{ opacity: 0 }} \n                            animate={{ opacity: 1 }} \n                            exit={{ opacity: 0 }}\n                            className=\"absolute inset-0 z-20 pointer-events-none\"\n                        >\n                            {/* Rule of Thirds Grid */}\n                            <div className=\"absolute inset-0 grid grid-cols-3 grid-rows-3\">\n                                {[...Array(9)].map((_, i) => (\n                                    <div key={i} className=\"border border-white/20\" />\n                                ))}\n                            </div>\n\n                            {/* Tension Points */}\n                            {activeImage.composition?.tensionPoints?.map((tp, idx) => (\n                                <motion.div\n                                    key={idx}\n                                    initial={{ scale: 0 }}\n                                    animate={{ scale: 1 }}\n                                    className=\"absolute w-4 h-4 -ml-2 -mt-2 flex items-center justify-center\"\n                                    style={{ left: `${tp.x * 100}%`, top: `${tp.y * 100}%` }}\n                                >\n                                    <div className=\"absolute inset-0 bg-rose-500 rounded-full animate-ping opacity-50\" />\n                                    <div className=\"w-1.5 h-1.5 bg-rose-400 rounded-full shadow-[0_0_10px_rgba(244,63,94,1)] relative z-10\" />\n                                </motion.div>\n                            ))}\n                        </motion.div>\n                    )}\n                </AnimatePresence>\n\n                {hasComposition && (\n                    <div className=\"absolute bottom-2 right-2 px-2 py-1 bg-black/60 backdrop-blur-md rounded border border-white/10 text-[8px] font-black text-white/50 z-30 uppercase tracking-widest\">\n                        Hover for Analysis\n                    </div>\n                )}\n            </div>\n\n            {/* NEURAL DNA */}\n            <div className=\"space-y-4\">\n                <div className=\"flex items-center gap-2 pb-1 border-b border-white/5\">\n                    <BrainCircuit size={12} className=\"text-emerald-400\" />\n                    <span className=\"text-[9px] font-black text-slate-500 uppercase tracking-widest\">Neural DNA</span>\n                </div>\n                \n                {/* Transform Controls */}\n                <div className=\"flex items-center justify-between p-3 bg-white/5 rounded-lg border border-white/10 mt-2\">\n                    <span className=\"text-[9px] font-black text-slate-500 uppercase tracking-widest flex items-center gap-2\">\n                        <RotateCw size={12} /> Transform\n                    </span>\n                    <div className=\"flex items-center gap-3\">\n                        <input \n                            type=\"range\" \n                            min=\"-180\" max=\"180\" \n                            value={activeImage.rotation || 0}\n                            onChange={(e) => updateImage(activeImage.id, { rotation: parseInt(e.target.value) })}\n                            className=\"w-24 h-1 bg-slate-800 rounded-full appearance-none cursor-pointer accent-indigo-500\"\n                        />\n                        <button \n                            onClick={() => updateImage(activeImage.id, { rotation: (activeImage.rotation || 0) + 90 })}\n                            className=\"p-1.5 bg-white/10 hover:bg-white/20 rounded text-slate-300 transition-colors\"\n                            title=\"Rotate +90┬░\"\n                        >\n                            <RotateCw size={12} />\n                        </button>\n                    </div>\n                </div>\n\n                <div className=\"flex flex-wrap gap-1\">\n                    {activeImage.tags.map(t => <TagChip key={t} label={t} color=\"bg-indigo-500/20 text-indigo-300\" />)}\n                </div>\n            </div>\n\n            {/* COMPOSITIONAL INTELLIGENCE */}\n            {hasComposition && (\n                <div className=\"space-y-4\">\n                    <div className=\"flex items-center gap-2 pb-1 border-b border-white/5\">\n                        <Grid3x3 size={12} className=\"text-fuchsia-400\" />\n                        <span className=\"text-[9px] font-black text-slate-500 uppercase tracking-widest\">Composition AI</span>\n                    </div>\n                    \n                    <div className=\"grid grid-cols-2 gap-3\">\n                        <div className=\"bg-white/5 p-2 rounded-lg border border-white/5\">\n                            <div className=\"flex items-center gap-2 mb-1 opacity-60\">\n                                <Gauge size={10} />\n                                <span className=\"text-[8px] uppercase font-bold\">Balance</span>\n                            </div>\n                            <div className=\"text-lg font-mono text-fuchsia-300 font-bold\">\n                                {(activeImage.composition?.aestheticScore || 0) * 10}/10\n                            </div>\n                        </div>\n                        <div className=\"bg-white/5 p-2 rounded-lg border border-white/5\">\n                            <div className=\"flex items-center gap-2 mb-1 opacity-60\">\n                                <Activity size={10} />\n                                <span className=\"text-[8px] uppercase font-bold\">Entropy</span>\n                            </div>\n                            <div className=\"text-lg font-mono text-cyan-300 font-bold\">\n                                {Math.round((activeImage.composition?.semanticEnergy || 0) * 100)}%\n                            </div>\n                        </div>\n                    </div>\n\n                    <div className=\"space-y-2\">\n                        <div className=\"flex justify-between items-center text-[9px] font-mono text-slate-400 border border-dashed border-white/10 p-2 rounded\">\n                            <span className=\"uppercase\">Detected Rule:</span>\n                            <span className=\"text-white font-bold uppercase tracking-wider\">{activeImage.composition?.dominant_rule || 'Unstructured'}</span>\n                        </div>\n                        \n                        {activeImage.composition?.improvementAdvisory && (\n                            <div className=\"p-3 bg-indigo-500/10 border border-indigo-500/20 rounded-lg\">\n                                <div className=\"flex items-center gap-2 mb-1\">\n                                    <Sparkles size={10} className=\"text-indigo-400\" />\n                                    <span className=\"text-[8px] font-black uppercase text-indigo-300 tracking-widest\">AI Advisory</span>\n                                </div>\n                                <p className=\"text-[9px] text-indigo-100/80 font-mono leading-relaxed\">\n                                    {activeImage.composition.improvementAdvisory}\n                                </p>\n                            </div>\n                        )}\n                        \n                        <div className=\"grid grid-cols-3 gap-2 mt-2\">\n                            <button \n                                onClick={() => applyCompositionRule(activeImage.id, 'thirds')}\n                                className=\"flex flex-col items-center justify-center gap-1 py-2 bg-white/5 hover:bg-white/10 border border-white/10 rounded-lg text-[8px] font-black uppercase text-slate-300 hover:text-white transition-colors\"\n                            >\n                                <LayoutGrid size={14} /> Thirds\n                            </button>\n                            <button \n                                onClick={() => applyCompositionRule(activeImage.id, 'center')}\n                                className=\"flex flex-col items-center justify-center gap-1 py-2 bg-white/5 hover:bg-white/10 border border-white/10 rounded-lg text-[8px] font-black uppercase text-slate-300 hover:text-white transition-colors\"\n                            >\n                                <Focus size={14} /> Center\n                            </button>\n                            <button \n                                onClick={() => applyCompositionRule(activeImage.id, 'golden')}\n                                className=\"flex flex-col items-center justify-center gap-1 py-2 bg-white/5 hover:bg-white/10 border border-white/10 rounded-lg text-[8px] font-black uppercase text-slate-300 hover:text-white transition-colors\"\n                            >\n                                <Ratio size={14} /> Golden\n                            </button>\n                        </div>\n                    </div>\n                </div>\n            )}\n\n            {/* NEURAL FORGE */}\n            <div className=\"space-y-3\">\n                <div className=\"flex items-center gap-2 pb-1 border-b border-white/5\">\n                    <Zap size={12} className=\"text-indigo-400\" />\n                    <span className=\"text-[9px] font-black text-slate-500 uppercase tracking-widest\">Neural Forge</span>\n                </div>\n                <div className=\"grid grid-cols-2 gap-2\">\n                    <button onClick={() => performUpscale(activeImage.id)} className=\"py-2 bg-indigo-600 rounded-lg text-[9px] font-black uppercase text-white hover:bg-indigo-500\">Upscale 4K</button>\n                    <button onClick={() => reanalyzeImage(activeImage.id)} className=\"py-2 bg-white/5 border border-white/10 rounded-lg text-[9px] font-black uppercase text-slate-300 hover:text-white\">Deep Analyze</button>\n                    <button onClick={() => autoStyleImage(activeImage.id)} className=\"col-span-1 py-3 bg-gradient-to-r from-fuchsia-600/20 to-purple-600/20 border border-fuchsia-500/30 rounded-lg text-[9px] font-black uppercase text-fuchsia-300 hover:text-white hover:bg-fuchsia-600/30 flex items-center justify-center gap-2\">\n                        <Wand2 size={12} /> Auto-Filter\n                    </button>\n                    <button onClick={() => resetFilters(activeImage.id)} className=\"col-span-1 py-3 bg-white/5 border border-white/10 rounded-lg text-[9px] font-black uppercase text-slate-300 hover:text-white flex items-center justify-center gap-2\">\n                        <RotateCcw size={12} /> Reset Filters\n                    </button>\n                </div>\n            </div>\n\n            <button \n                onClick={() => addToReel([activeImage.id])} \n                className=\"w-full py-3 bg-gradient-to-r from-cyan-600/20 to-indigo-600/20 border border-cyan-500/30 text-cyan-300 hover:text-white rounded-xl text-[10px] font-black uppercase tracking-widest transition-all flex items-center justify-center gap-2 hover:bg-cyan-600/30\"\n            >\n                <Film size={14} /> Add to Reel\n            </button>\n\n            <button onClick={() => removeImage(activeImage.id)} className=\"mt-2 py-3 bg-rose-500/5 border border-rose-500/20 text-rose-500 hover:bg-rose-500 hover:text-white rounded-xl text-[10px] font-black uppercase tracking-widest transition-all\">Delete Asset</button>\n        </div>\n    );\n};\n\nconst Sparkles = ({ size, className }: any) => (\n    <svg width={size} height={size} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\" className={className}>\n        <path d=\"m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z\" />\n        <path d=\"M5 3v4\" />\n        <path d=\"M9 5H5\" />\n        <path d=\"M19 21v-4\" />\n        <path d=\"M15 19h4\" />\n    </svg>\n);\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\cweir\\Downloads\\neural-canvas\\components\\LiveDirector.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\cweir\\Downloads\\neural-canvas\\components\\OrbitalFrame.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Activity' is defined but never used. Allowed unused vars must match /^_/u.","line":7,"column":20,"nodeType":null,"messageId":"unusedVar","endLine":7,"endColumn":28},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Snowflake' is defined but never used. Allowed unused vars must match /^_/u.","line":7,"column":30,"nodeType":null,"messageId":"unusedVar","endLine":7,"endColumn":39},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Maximize' is defined but never used. Allowed unused vars must match /^_/u.","line":8,"column":5,"nodeType":null,"messageId":"unusedVar","endLine":8,"endColumn":13},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Minimize' is defined but never used. Allowed unused vars must match /^_/u.","line":8,"column":15,"nodeType":null,"messageId":"unusedVar","endLine":8,"endColumn":23},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Settings' is defined but never used. Allowed unused vars must match /^_/u.","line":8,"column":25,"nodeType":null,"messageId":"unusedVar","endLine":8,"endColumn":33},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Bell' is defined but never used. Allowed unused vars must match /^_/u.","line":8,"column":35,"nodeType":null,"messageId":"unusedVar","endLine":8,"endColumn":39},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'HighlightConfigPanel' is defined but never used. Allowed unused vars must match /^_/u.","line":14,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":14,"endColumn":30},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'deleteReel' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":45,"column":9,"nodeType":null,"messageId":"unusedVar","endLine":45,"endColumn":19},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement. Only these console methods are allowed: warn, error, debug.","line":64,"column":41,"nodeType":"MemberExpression","messageId":"limited","endLine":64,"endColumn":52},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement. Only these console methods are allowed: warn, error, debug.","line":67,"column":25,"nodeType":"MemberExpression","messageId":"limited","endLine":67,"endColumn":36,"suggestions":[{"fix":{"range":[2287,2325],"text":""},"messageId":"removeConsole","data":{"propertyName":"log"},"desc":"Remove the console.log()."}]},{"ruleId":"no-case-declarations","severity":2,"message":"Unexpected lexical declaration in case block.","line":106,"column":33,"nodeType":"VariableDeclaration","messageId":"unexpected","endLine":106,"endColumn":93,"suggestions":[{"messageId":"addBrackets","fix":{"range":[4631,5269],"text":"{ const targets = args.ids || useStore.getState().selectedIds;\n                                if (targets.length === 0) return \"No assets selected.\";\n                                targets.forEach((id: string) => updateImage(id, {\n                                    brightness: args.brightness,\n                                    contrast: args.contrast,\n                                    saturation: args.saturation,\n                                    blur: args.blur,\n                                    hue: args.hue\n                                }));\n                                return `Modified ${targets.length} assets.`; }"},"desc":"Add {} brackets around the case block."}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has missing dependencies: 'clearReel', 'generateCustomTheme', 'loadReel', 'saveReel', 'setBezelTheme', 'setLiveStatus', 'setPlaybackMode', 'setPlaybackSpeed', 'setSelectedIds', and 'updateImage'. Either include them or remove the dependency array.","line":141,"column":8,"nodeType":"ArrayExpression","endLine":141,"endColumn":45,"suggestions":[{"desc":"Update the dependencies array to be: [ui.isLiveActive, images, savedReels, setLiveStatus, setBezelTheme, setPlaybackSpeed, setPlaybackMode, generateCustomTheme, saveReel, loadReel, clearReel, setSelectedIds, updateImage]","fix":{"range":[6071,6108],"text":"[ui.isLiveActive, images, savedReels, setLiveStatus, setBezelTheme, setPlaybackSpeed, setPlaybackMode, generateCustomTheme, saveReel, loadReel, clearReel, setSelectedIds, updateImage]"}}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":11,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\nimport React, { useEffect, useRef } from 'react';\nimport { useStore } from '../store/useStore';\nimport { AppMode } from '../types';\nimport { motion, AnimatePresence } from 'framer-motion';\nimport { \n    Play, Palette, Activity, Snowflake, Menu, \n    Maximize, Minimize, Settings, Bell, Search, Mic, MicOff\n} from 'lucide-react';\nimport { NavigationDock } from './ui/NavigationDock';\nimport { InspectorPanel } from './InspectorPanel';\nimport { StudioSequencer } from './StudioSequencer';\nimport { ThemeStudio } from './ThemeStudio';\nimport { HighlightConfigPanel } from './HighlightConfigPanel';\nimport { LiveDirector } from './LiveDirector';\nimport { CameraCapture } from './CameraCapture';\nimport { CouncilLogs } from './CouncilLogs';\nimport { LiveDirectorSession } from '../services/liveService';\n\ninterface OrbitalFrameProps {\n    children: React.ReactNode;\n}\n\nconst TelemetryItem = ({ label, value, color }: { label: string, value: string, color: string }) => (\n    <div className=\"flex flex-col items-center\">\n        <span className=\"text-[7px] font-black text-slate-500 uppercase tracking-widest mb-0.5\">{label}</span>\n        <span className={`text-xs font-mono font-bold ${color}`}>{value}</span>\n    </div>\n);\n\nexport const OrbitalFrame: React.FC<OrbitalFrameProps> = ({ children }) => {\n    const { \n        mode, \n        ui, \n        toggleUiPanel, \n        neuralTemperature, \n        holidaySpirit, \n        reel, \n        playReel,\n        isCameraOpen,\n        setCameraOpen,\n        setLiveStatus,\n        saveReel,\n        loadReel,\n        deleteReel,\n        clearReel,\n        savedReels,\n        setBezelTheme,\n        setPlaybackSpeed,\n        setPlaybackMode,\n        setSelectedIds,\n        updateImage,\n        generateCustomTheme,\n        images\n    } = useStore();\n\n    const sessionRef = useRef<LiveDirectorSession | null>(null);\n\n    // --- LIVE DIRECTOR SESSION MANAGEMENT ---\n    useEffect(() => {\n        if (ui.isLiveActive) {\n            if (!sessionRef.current) {\n                sessionRef.current = new LiveDirectorSession({\n                    onMessage: (msg) => console.log('Director:', msg),\n                    onStatusChange: (status) => setLiveStatus(status),\n                    onToolCall: async (name, args) => {\n                        console.log('Tool Call:', name, args);\n                        switch (name) {\n                            case 'manage_reel':\n                                if (args.action === 'SAVE') {\n                                    saveReel(args.name || `Reel_${Date.now()}`);\n                                    return `Saved reel as ${args.name || 'Untitled'}`;\n                                } else if (args.action === 'LOAD') {\n                                    const target = savedReels.find(r => r.name.toLowerCase().includes(args.name.toLowerCase()));\n                                    if (target) {\n                                        loadReel(target.id);\n                                        return `Loaded reel: ${target.name}`;\n                                    }\n                                    return `Could not find reel named ${args.name}`;\n                                } else if (args.action === 'CLEAR') {\n                                    clearReel();\n                                    return \"Reel cleared.\";\n                                }\n                                return \"Action not recognized.\";\n\n                            case 'adjust_environment':\n                                if (args.theme) setBezelTheme(args.theme);\n                                if (args.speed) setPlaybackSpeed(args.speed);\n                                if (args.mode) setPlaybackMode(args.mode);\n                                return \"Environment adjusted.\";\n\n                            case 'select_assets':\n                                // Mock semantic selection logic (normally would use vector search)\n                                if (args.action === 'SELECT') {\n                                    const allIds = images.map(i => i.id);\n                                    setSelectedIds(allIds.slice(0, 5)); // Just select first 5 for now\n                                    return \"Selected assets.\";\n                                }\n                                if (args.action === 'DESELECT') {\n                                    setSelectedIds([]);\n                                    return \"Deselected all.\";\n                                }\n                                return \"Selection updated.\";\n\n                            case 'modify_assets':\n                                const targets = args.ids || useStore.getState().selectedIds;\n                                if (targets.length === 0) return \"No assets selected.\";\n                                targets.forEach((id: string) => updateImage(id, {\n                                    brightness: args.brightness,\n                                    contrast: args.contrast,\n                                    saturation: args.saturation,\n                                    blur: args.blur,\n                                    hue: args.hue\n                                }));\n                                return `Modified ${targets.length} assets.`;\n\n                            case 'generate_theme':\n                                await generateCustomTheme(args.prompt);\n                                return \"Theme generated and applied.\";\n\n                            default:\n                                return \"Tool not implemented.\";\n                        }\n                    }\n                });\n                sessionRef.current.start();\n            }\n        } else {\n            if (sessionRef.current) {\n                sessionRef.current.stop();\n                sessionRef.current = null;\n            }\n        }\n        return () => {\n            // Cleanup on unmount\n            if (sessionRef.current) {\n                sessionRef.current.stop();\n                sessionRef.current = null;\n            }\n        };\n    }, [ui.isLiveActive, images, savedReels]);\n\n    return (\n        <div className=\"relative w-screen h-screen overflow-hidden bg-black text-white flex flex-col\">\n            \n            {/* --- COMMAND DECK (HEADER) --- */}\n            {mode !== AppMode.PLAYER && (\n                <div className=\"h-14 border-b border-white/10 bg-[#050505]/80 backdrop-blur-md flex items-center justify-between px-6 z-50 shrink-0\">\n                    \n                    {/* LEFT: SYSTEM STATUS */}\n                    <div className=\"flex items-center gap-6 w-1/3\">\n                        <div className=\"flex items-center gap-2\">\n                            <Menu size={18} className=\"text-slate-400 hover:text-white cursor-pointer\" onClick={() => toggleUiPanel('isSidebarOpen')} />\n                            <span className=\"text-[10px] font-black tracking-[0.2em] uppercase text-white/80\">Studio.OS</span>\n                        </div>\n                        <div className=\"h-4 w-px bg-white/10\" />\n                        <div className=\"flex items-center gap-2 px-3 py-1 bg-white/5 rounded-full border border-white/5\">\n                            <div className={`w-1.5 h-1.5 rounded-full ${neuralTemperature > 0 ? 'bg-indigo-500 animate-pulse' : 'bg-emerald-500'}`} />\n                            <span className=\"text-[8px] font-mono text-slate-400 uppercase\">\n                                {neuralTemperature > 0 ? 'Processing...' : 'System_Ready'}\n                            </span>\n                        </div>\n                    </div>\n\n                    {/* CENTER: SEARCH / ORMNI-BAR */}\n                    <div className=\"flex-1 flex justify-center\">\n                        <div className=\"relative w-96 group\">\n                            <div className=\"absolute inset-0 bg-indigo-500/20 rounded-full blur-xl opacity-0 group-hover:opacity-100 transition-opacity\" />\n                            <div className=\"relative bg-black/50 border border-white/10 rounded-full flex items-center px-4 py-2 gap-3 transition-colors group-hover:border-indigo-500/30\">\n                                <Search size={14} className=\"text-slate-500\" />\n                                <input \n                                    type=\"text\" \n                                    placeholder=\"Search assets, tags, or neural commands...\" \n                                    className=\"bg-transparent border-none outline-none text-[10px] font-mono text-white placeholder-slate-600 w-full\"\n                                />\n                                <div className=\"text-[8px] font-black text-slate-700 border border-slate-800 px-1.5 rounded bg-black\">ΓîÿK</div>\n                            </div>\n                        </div>\n                    </div>\n\n                    {/* RIGHT: ACTIONS & TELEMETRY */}\n                    <div className=\"flex items-center justify-end gap-4 w-1/3\">\n                        \n                        <div className=\"hidden md:flex items-center gap-4 bg-black/40 px-4 py-1.5 rounded-full border border-white/5\">\n                             <TelemetryItem label=\"NEURAL\" value={`${Math.round(neuralTemperature)}%`} color=\"text-indigo-400\" />\n                             <div className=\"w-px h-3 bg-white/10\" />\n                             <TelemetryItem label=\"SPIRIT\" value={`${Math.round(holidaySpirit)}%`} color=\"text-rose-400\" />\n                        </div>\n\n                        <div className=\"flex items-center gap-2\">\n                            {/* LIVE DIRECTOR TOGGLE */}\n                            <motion.button\n                                onClick={() => toggleUiPanel('isLiveActive')}\n                                whileHover={{ scale: 1.05 }}\n                                className={`p-2 rounded-full transition-colors border ${ui.isLiveActive ? 'bg-rose-500/10 text-rose-400 border-rose-500/50 animate-pulse' : 'bg-white/5 text-slate-400 border-white/10 hover:text-white'}`}\n                            >\n                                {ui.isLiveActive ? <Mic size={16} /> : <MicOff size={16} />}\n                            </motion.button>\n\n                            <motion.button\n                                onClick={() => toggleUiPanel('isThemeStudioOpen')}\n                                whileHover={{ scale: 1.05 }}\n                                className=\"p-2 text-indigo-300 hover:text-white bg-indigo-500/10 hover:bg-indigo-500/20 rounded-full transition-colors border border-indigo-500/20\"\n                            >\n                                <Palette size={16} />\n                            </motion.button>\n                            \n                            <motion.button\n                                onClick={() => { if(reel.length > 0) playReel(); }}\n                                whileHover={{ scale: 1.05 }}\n                                whileTap={{ scale: 0.95 }}\n                                disabled={reel.length === 0}\n                                className={`\n                                    flex items-center gap-2 px-4 py-2 rounded-full transition-all shadow-lg\n                                    ${reel.length > 0 \n                                        ? 'bg-emerald-500/10 border border-emerald-500 text-emerald-400 hover:bg-emerald-500 hover:text-white shadow-[0_0_20px_rgba(16,185,129,0.2)]' \n                                        : 'bg-white/5 border border-white/10 text-slate-600 cursor-not-allowed'}\n                                `}\n                            >\n                                <Play size={12} fill=\"currentColor\" />\n                                <span className=\"text-[9px] font-black uppercase tracking-widest\">Play</span>\n                            </motion.button>\n                        </div>\n                    </div>\n                </div>\n            )}\n\n            {/* --- MAIN VIEWPORT --- */}\n            <div className=\"flex-1 relative overflow-hidden flex\">\n                \n                {/* CANVAS/CONTENT */}\n                <div className=\"flex-1 relative z-0\">\n                    {children}\n                </div>\n\n                {/* RIGHT SIDEBAR (INSPECTOR) */}\n                <AnimatePresence>\n                    {ui.isInspectorOpen && mode === AppMode.CANVAS && (\n                        <motion.div \n                            initial={{ width: 0, opacity: 0 }}\n                            animate={{ width: 320, opacity: 1 }}\n                            exit={{ width: 0, opacity: 0 }}\n                            className=\"h-full border-l border-white/10 bg-[#050505] z-10 flex flex-col shadow-2xl relative\"\n                        >\n                            <div className=\"absolute top-0 left-0 bottom-0 w-px bg-indigo-500/20 shadow-[0_0_10px_#6366f1]\" />\n                            <InspectorPanel />\n                        </motion.div>\n                    )}\n                </AnimatePresence>\n            </div>\n\n            {/* --- SEQUENCER (BOTTOM PANEL) --- */}\n            <AnimatePresence>\n                {ui.isTimelineOpen && mode === AppMode.CANVAS && (\n                    <motion.div \n                        initial={{ height: 0 }}\n                        animate={{ height: 220 }}\n                        exit={{ height: 0 }}\n                        className=\"border-t border-white/10 bg-[#08080a] z-20 shrink-0 relative shadow-[0_-10px_30px_rgba(0,0,0,0.5)]\"\n                    >\n                        <StudioSequencer />\n                        <button \n                            onClick={() => toggleUiPanel('isTimelineOpen')}\n                            className=\"absolute -top-3 left-1/2 -translate-x-1/2 w-12 h-3 bg-[#08080a] rounded-t-lg border-t border-l border-r border-white/10 flex items-center justify-center hover:bg-white/5 cursor-pointer\"\n                        >\n                            <div className=\"w-6 h-0.5 bg-slate-600 rounded-full\" />\n                        </button>\n                    </motion.div>\n                )}\n            </AnimatePresence>\n\n            {/* --- FLOATING UI ELEMENTS --- */}\n            \n            {/* Live Director (Always present, state controlled) */}\n            <LiveDirector />\n\n            {/* Council Logs Terminal */}\n            {mode !== AppMode.PLAYER && <CouncilLogs />}\n\n            {/* Navigation Dock (Floating Bottom) */}\n            {mode !== AppMode.PLAYER && !isCameraOpen && <NavigationDock />}\n\n            {/* --- MODALS & OVERLAYS --- */}\n            <AnimatePresence>\n                {ui.isThemeStudioOpen && <ThemeStudio onClose={() => toggleUiPanel('isThemeStudioOpen')} />}\n            </AnimatePresence>\n\n            {isCameraOpen && <CameraCapture onClose={() => setCameraOpen(false)} />}\n\n        </div>\n    );\n};\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\cweir\\Downloads\\neural-canvas\\components\\QuadMonitorView.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\cweir\\Downloads\\neural-canvas\\components\\SelectionToolbar.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Play' is defined but never used. Allowed unused vars must match /^_/u.","line":5,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":5,"endColumn":14},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Sparkles' is defined but never used. Allowed unused vars must match /^_/u.","line":5,"column":33,"nodeType":null,"messageId":"unusedVar","endLine":5,"endColumn":41},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":180,"column":88,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":180,"endColumn":91,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[8181,8184],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[8181,8184],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":195,"column":57,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":195,"endColumn":60,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[8820,8823],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[8820,8823],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":4,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\nimport React, { useState } from 'react';\nimport { motion, AnimatePresence } from 'framer-motion';\nimport { useStore } from '../store/useStore';\nimport { Play, Plus, Trash2, X, Sparkles, Film, Layers, Tag, BrainCircuit, Crop, Wand2, Check } from 'lucide-react';\n\nexport const SelectionToolbar: React.FC = () => {\n    const { \n        selectedIds, setSelectedIds, addToReel, playSelectedAssets, removeImage,\n        batchAddTags, batchAnalyze, batchSmartCrop, batchEdit\n    } = useStore();\n\n    const [showBatchMenu, setShowBatchMenu] = useState(false);\n    const [batchMode, setBatchMode] = useState<'none' | 'tag' | 'edit'>('none');\n    const [inputValue, setInputValue] = useState('');\n\n    if (selectedIds.length === 0) return null;\n\n    const handleClear = () => {\n        setSelectedIds([]);\n        setShowBatchMenu(false);\n        setBatchMode('none');\n        setInputValue('');\n    };\n    \n    const handleAddToReel = () => {\n        addToReel(selectedIds);\n        handleClear();\n    };\n\n    const handleInstantHighlight = () => {\n        playSelectedAssets();\n    };\n\n    const handleDelete = () => {\n        if (confirm(`Purge ${selectedIds.length} assets from neural memory?`)) {\n            selectedIds.forEach(id => removeImage(id));\n            handleClear();\n        }\n    };\n\n    const executeBatch = async () => {\n        if (!inputValue.trim() && (batchMode === 'tag' || batchMode === 'edit')) return;\n        \n        if (batchMode === 'tag') {\n            batchAddTags(selectedIds, inputValue);\n        } else if (batchMode === 'edit') {\n            await batchEdit(selectedIds, inputValue);\n        }\n        \n        setInputValue('');\n        setBatchMode('none');\n        setShowBatchMenu(false);\n    };\n\n    return (\n        <AnimatePresence>\n            <div className=\"fixed bottom-32 left-1/2 z-[300] -translate-x-1/2 flex flex-col items-center gap-2\">\n                \n                {/* BATCH MENU DROPDOWN */}\n                <AnimatePresence>\n                    {showBatchMenu && (\n                        <motion.div \n                            initial={{ opacity: 0, y: 10, scale: 0.95 }}\n                            animate={{ opacity: 1, y: 0, scale: 1 }}\n                            exit={{ opacity: 0, y: 10, scale: 0.95 }}\n                            className=\"bg-black/90 backdrop-blur-xl border border-white/10 rounded-2xl p-2 mb-2 shadow-2xl min-w-[300px]\"\n                        >\n                            {batchMode === 'none' ? (\n                                <div className=\"grid grid-cols-4 gap-1\">\n                                    <BatchActionBtn \n                                        icon={Tag} label=\"Tag\" \n                                        onClick={() => setBatchMode('tag')} \n                                    />\n                                    <BatchActionBtn \n                                        icon={BrainCircuit} label=\"Analyze\" \n                                        onClick={() => { batchAnalyze(selectedIds); setShowBatchMenu(false); }} \n                                    />\n                                    <BatchActionBtn \n                                        icon={Crop} label=\"Crop\" \n                                        onClick={() => { batchSmartCrop(selectedIds); setShowBatchMenu(false); }} \n                                    />\n                                    <BatchActionBtn \n                                        icon={Wand2} label=\"Remix\" \n                                        onClick={() => setBatchMode('edit')} \n                                    />\n                                </div>\n                            ) : (\n                                <div className=\"flex items-center gap-2 p-1\">\n                                    <button \n                                        onClick={() => setBatchMode('none')}\n                                        className=\"p-2 hover:bg-white/10 rounded-lg text-slate-400\"\n                                    >\n                                        <X size={14} />\n                                    </button>\n                                    <input \n                                        autoFocus\n                                        value={inputValue}\n                                        onChange={(e) => setInputValue(e.target.value)}\n                                        onKeyDown={(e) => e.key === 'Enter' && executeBatch()}\n                                        placeholder={batchMode === 'tag' ? \"Enter tag to apply...\" : \"Describe transformation...\"}\n                                        className=\"bg-transparent border-none outline-none text-xs text-white font-mono flex-1 placeholder-slate-600\"\n                                    />\n                                    <button \n                                        onClick={executeBatch}\n                                        disabled={!inputValue.trim()}\n                                        className=\"p-1.5 bg-indigo-600 hover:bg-indigo-500 text-white rounded-lg disabled:opacity-50\"\n                                    >\n                                        <Check size={14} />\n                                    </button>\n                                </div>\n                            )}\n                        </motion.div>\n                    )}\n                </AnimatePresence>\n\n                {/* MAIN TOOLBAR */}\n                <motion.div \n                    initial={{ y: 100, opacity: 0 }}\n                    animate={{ y: 0, opacity: 1 }}\n                    exit={{ y: 100, opacity: 0 }}\n                    className=\"flex items-center gap-2 p-2 bg-black/80 backdrop-blur-2xl border border-indigo-500/30 rounded-2xl shadow-[0_20px_50px_rgba(0,0,0,0.5),0_0_20px_rgba(99,102,241,0.2)]\"\n                >\n                    <div className=\"flex items-center gap-3 px-4 border-r border-white/10 mr-1\">\n                        <div className=\"w-6 h-6 rounded-full bg-indigo-500 flex items-center justify-center text-[10px] font-black text-white shadow-[0_0_10px_rgba(99,102,241,0.5)]\">\n                            {selectedIds.length}\n                        </div>\n                        <span className=\"text-[10px] font-black text-white uppercase tracking-widest hidden md:block\">Selected</span>\n                    </div>\n\n                    <ActionButton \n                        icon={Layers} \n                        label=\"Batch Ops\" \n                        onClick={() => setShowBatchMenu(!showBatchMenu)} \n                        color={showBatchMenu ? \"text-white bg-white/10\" : \"text-cyan-400\"}\n                        hoverBg=\"hover:bg-cyan-900/20\"\n                    />\n\n                    <div className=\"w-px h-6 bg-white/10 mx-1\" />\n\n                    <ActionButton \n                        icon={Plus} \n                        label=\"Add to Reel\" \n                        onClick={handleAddToReel} \n                        color=\"text-indigo-400\"\n                        hoverBg=\"hover:bg-indigo-500/10\"\n                    />\n\n                    <ActionButton \n                        icon={Film} \n                        label=\"Instant Highlight\" \n                        onClick={handleInstantHighlight} \n                        color=\"text-emerald-400\"\n                        hoverBg=\"hover:bg-emerald-500/10\"\n                        primary\n                    />\n\n                    <div className=\"w-px h-6 bg-white/10 mx-1\" />\n\n                    <ActionButton \n                        icon={Trash2} \n                        label=\"\" \n                        onClick={handleDelete} \n                        color=\"text-rose-500\"\n                        hoverBg=\"hover:bg-rose-500/10\"\n                    />\n\n                    <button \n                        onClick={handleClear}\n                        className=\"p-2 text-slate-500 hover:text-white transition-colors\"\n                    >\n                        <X size={18} />\n                    </button>\n                </motion.div>\n            </div>\n        </AnimatePresence>\n    );\n};\n\nconst ActionButton = ({ icon: Icon, label, onClick, color, hoverBg, primary = false }: any) => (\n    <motion.button\n        whileHover={{ scale: 1.02 }}\n        whileTap={{ scale: 0.98 }}\n        onClick={onClick}\n        className={`\n            flex items-center gap-2 px-3 py-2 rounded-xl transition-all duration-300 group\n            ${primary ? 'bg-indigo-600 text-white shadow-lg shadow-indigo-500/20' : `bg-white/5 ${hoverBg} ${color}`}\n        `}\n    >\n        <Icon size={16} className={primary ? 'text-white' : ''} />\n        {label && <span className=\"text-[10px] font-black uppercase tracking-widest hidden sm:block\">{label}</span>}\n    </motion.button>\n);\n\nconst BatchActionBtn = ({ icon: Icon, label, onClick }: any) => (\n    <button \n        onClick={onClick}\n        className=\"flex flex-col items-center justify-center gap-1 p-2 rounded-xl hover:bg-white/10 transition-colors group\"\n    >\n        <div className=\"p-2 bg-white/5 rounded-lg group-hover:bg-indigo-500 group-hover:text-white text-slate-400 transition-colors\">\n            <Icon size={16} />\n        </div>\n        <span className=\"text-[9px] font-mono text-slate-500 group-hover:text-white uppercase tracking-tighter\">{label}</span>\n    </button>\n);\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\cweir\\Downloads\\neural-canvas\\components\\StudioSequencer.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'e' is defined but never used.","line":224,"column":14,"nodeType":null,"messageId":"unusedVar","endLine":224,"endColumn":15},{"ruleId":"react/no-unescaped-entities","severity":1,"message":"`'` can be escaped with `&apos;`, `&lsquo;`, `&#39;`, `&rsquo;`.","line":455,"column":36,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&apos;"},"fix":{"range":[16814,16851],"text":"\n                      A reel named &apos;"},"desc":"Replace with `&apos;`."},{"messageId":"replaceWithAlt","data":{"alt":"&lsquo;"},"fix":{"range":[16814,16851],"text":"\n                      A reel named &lsquo;"},"desc":"Replace with `&lsquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#39;"},"fix":{"range":[16814,16851],"text":"\n                      A reel named &#39;"},"desc":"Replace with `&#39;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rsquo;"},"fix":{"range":[16814,16851],"text":"\n                      A reel named &rsquo;"},"desc":"Replace with `&rsquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":1,"message":"`'` can be escaped with `&apos;`, `&lsquo;`, `&#39;`, `&rsquo;`.","line":455,"column":50,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&apos;"},"fix":{"range":[16864,16902],"text":"&apos; already exists.\n                    "},"desc":"Replace with `&apos;`."},{"messageId":"replaceWithAlt","data":{"alt":"&lsquo;"},"fix":{"range":[16864,16902],"text":"&lsquo; already exists.\n                    "},"desc":"Replace with `&lsquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#39;"},"fix":{"range":[16864,16902],"text":"&#39; already exists.\n                    "},"desc":"Replace with `&#39;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rsquo;"},"fix":{"range":[16864,16902],"text":"&rsquo; already exists.\n                    "},"desc":"Replace with `&rsquo;`."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect, useRef, useCallback } from 'react';\nimport { useStore } from '../store/useStore';\nimport {\n  Play,\n  Pause,\n  X,\n  Film,\n  Sparkles,\n  UploadCloud,\n  Download,\n  Plus,\n  Save,\n  FolderOpen,\n  Trash2,\n  Cloud,\n  Eye,\n  AlertTriangle,\n  CheckCircle2,\n  Palette,\n  Wand2,\n  Loader2,\n} from 'lucide-react';\nimport { motion, AnimatePresence, Reorder } from 'framer-motion';\nimport { GooglePhotosBrowser } from './GooglePhotosBrowser';\nimport { ThemePreviewModal } from './ThemePreviewModal';\nimport { ExportModal } from './ExportModal';\nimport { SequencerItem } from './sequencer/SequencerItem';\n\n// Constants for Virtualization\nconst ITEM_WIDTH = 192; // w-48\nconst ITEM_GAP = 16; // gap-4\nconst ITEM_STRIDE = ITEM_WIDTH + ITEM_GAP;\nconst OVERSCAN = 5; // Number of items to render outside viewport\n\nimport { Music } from 'lucide-react';\nimport { AudioWaveform } from './AudioWaveform';\nimport { analyzeAudio } from '../services/audioService';\n\nexport const StudioSequencer = () => {\n  const {\n    images,\n    reel,\n    savedReels,\n    playback,\n    togglePlayback,\n    orchestrator,\n    removeFromReel,\n    reorderReel,\n    performUpscale,\n    duplicateImage,\n    performImageEdit,\n    updateImage,\n    applySmartCrop,\n    reanalyzeImage,\n    addImage,\n    addToReel,\n    saveReel,\n    loadReel,\n    deleteReel,\n    playReel,\n    toggleUiPanel,\n    orchestrateReel,\n    neuralTemperature,\n  } = useStore();\n\n  const [localReel, setLocalReel] = useState(reel);\n  const [isDraggingFile, setIsDraggingFile] = useState(false);\n  const [isLibraryOpen, setIsLibraryOpen] = useState(false);\n\n  // Save State\n  const [isSaving, setIsSaving] = useState(false);\n  const [newReelName, setNewReelName] = useState('');\n  const [overwriteTargetId, setOverwriteTargetId] = useState<string | null>(null);\n  const [saveStatus, setSaveStatus] = useState<'idle' | 'success' | 'error'>('idle');\n\n  const [showGooglePhotos, setShowGooglePhotos] = useState(false);\n  const [showPreview, setShowPreview] = useState(false);\n  const [showExportModal, setShowExportModal] = useState(false);\n\n  // Virtualization State\n  const scrollContainerRef = useRef<HTMLDivElement>(null);\n  const [visibleRange, setVisibleRange] = useState({ start: 0, end: 15 });\n\n  useEffect(() => {\n    setLocalReel(reel);\n  }, [reel]);\n\n  const handleReorder = (newOrder: string[]) => {\n    setLocalReel(newOrder);\n    reorderReel(newOrder);\n  };\n\n  const handleScroll = useCallback(() => {\n    if (!scrollContainerRef.current) return;\n    const { scrollLeft, clientWidth } = scrollContainerRef.current;\n\n    const start = Math.floor(scrollLeft / ITEM_STRIDE);\n    const visibleCount = Math.ceil(clientWidth / ITEM_STRIDE);\n    const end = start + visibleCount;\n\n    setVisibleRange({\n      start: Math.max(0, start - OVERSCAN),\n      end: end + OVERSCAN,\n    });\n  }, []);\n\n  // Initial calculation on mount/resize\n  useEffect(() => {\n    handleScroll();\n    window.addEventListener('resize', handleScroll);\n    return () => window.removeEventListener('resize', handleScroll);\n  }, [handleScroll]);\n\n  const handleDurationChange = useCallback(\n    (id: string, duration: number) => {\n      updateImage(id, { duration: Math.max(1, duration) });\n    },\n    [updateImage]\n  );\n\n  const handleMenuAction = useCallback(\n    async (id: string, action: string) => {\n      const img = useStore.getState().images.find(i => i.id === id);\n      if (!img) return;\n      switch (action) {\n        case 'analyze':\n          await reanalyzeImage(id);\n          break;\n        case 'upscale':\n          await performUpscale(id);\n          break;\n        case 'crop':\n          applySmartCrop(id);\n          break;\n        case 'copy':\n          await duplicateImage(id);\n          break;\n        case 'rotate':\n          updateImage(id, { rotation: (img.rotation || 0) + 90 });\n          break;\n        case 'remove_bg':\n          await performImageEdit(id, 'Remove background.', 'edit');\n          break;\n        case 'flip':\n          updateImage(id, { flipX: !img.flipX });\n          break;\n      }\n    },\n    [reanalyzeImage, performUpscale, applySmartCrop, duplicateImage, updateImage, performImageEdit]\n  );\n\n  // --- DRAG HANDLERS ---\n  const handleDragOver = (e: React.DragEvent) => {\n    e.preventDefault();\n    setIsDraggingFile(true);\n  };\n  const handleDragLeave = (e: React.DragEvent) => {\n    if (!e.currentTarget.contains(e.relatedTarget as Node)) setIsDraggingFile(false);\n  };\n\n  // FIX: Added explicit File casting to handle drop correctly in TypeScript\n  const handleDrop = async (e: React.DragEvent) => {\n    e.preventDefault();\n    setIsDraggingFile(false);\n    const files = Array.from(e.dataTransfer.files as FileList).filter((f: File) =>\n      f.type.startsWith('image/')\n    );\n    if (files.length > 0) {\n      const newIds: string[] = [];\n      for (const file of files as File[]) {\n        const id = Math.random().toString(36).substring(2, 11);\n        newIds.push(id);\n        const reader = new FileReader();\n        reader.onload = async ev => {\n          const src = ev.target?.result as string;\n          const imgObj = new window.Image();\n          imgObj.src = src;\n          imgObj.onload = () => {\n            addImage({\n              id,\n              url: src,\n              file: file,\n              width: 400,\n              height: 400 * (imgObj.height / imgObj.width),\n              x: 0,\n              y: 0,\n              rotation: 0,\n              scale: 1,\n              tags: ['sequencer_drop', 'analyzing...'],\n              analyzed: false,\n              timestamp: Date.now(),\n              duration: 5,\n            });\n          };\n        };\n        reader.readAsDataURL(file);\n      }\n      addToReel(newIds);\n    }\n  };\n\n  const handleSaveRequest = () => {\n    const name = newReelName.trim();\n    if (!name) return;\n\n    const existing = savedReels.find(r => r.name.toLowerCase() === name.toLowerCase());\n    if (existing) {\n      setOverwriteTargetId(existing.id);\n    } else {\n      performSave(name);\n    }\n  };\n\n  const performSave = (name: string, id?: string) => {\n    try {\n      saveReel(name, id);\n      setSaveStatus('success');\n      setTimeout(() => {\n        setIsSaving(false);\n        setSaveStatus('idle');\n        setNewReelName('');\n        setOverwriteTargetId(null);\n      }, 1500);\n    } catch (e) {\n      setSaveStatus('error');\n    }\n  };\n\n  const isReelEmpty = localReel.length === 0;\n\n  return (\n    <div\n      className=\"w-full h-full flex flex-col text-slate-300 select-none bg-[#050508] relative\"\n      onDragOver={handleDragOver}\n      onDragLeave={handleDragLeave}\n      onDrop={handleDrop}\n    >\n      <AnimatePresence>\n        {showGooglePhotos && <GooglePhotosBrowser onClose={() => setShowGooglePhotos(false)} />}\n        {showPreview && <ThemePreviewModal onClose={() => setShowPreview(false)} />}\n        {showExportModal && <ExportModal onClose={() => setShowExportModal(false)} />}\n      </AnimatePresence>\n\n      <AnimatePresence>\n        {isDraggingFile && (\n          <motion.div\n            initial={{ opacity: 0 }}\n            animate={{ opacity: 1 }}\n            exit={{ opacity: 0 }}\n            className=\"absolute inset-0 z-50 bg-indigo-500/20 backdrop-blur-sm border-2 border-dashed border-indigo-400 flex flex-col items-center justify-center pointer-events-none\"\n          >\n            <UploadCloud size={48} className=\"text-indigo-300 animate-bounce mb-2\" />\n            <span className=\"text-sm font-black text-white uppercase tracking-[0.2em]\">\n              Drop to Append to Reel\n            </span>\n          </motion.div>\n        )}\n      </AnimatePresence>\n\n      {/* HEADER */}\n      <div className=\"h-14 border-b border-indigo-500/10 flex items-center justify-between px-8 bg-black/40 backdrop-blur-3xl shrink-0 z-20 relative\">\n        <div className=\"flex items-center gap-6\">\n          <div className=\"flex items-center gap-2\">\n            <Sparkles size={16} className=\"text-indigo-400 animate-pulse\" />\n            <span className=\"text-[11px] font-black text-white tracking-[0.4em] uppercase\">\n              Aurora_Sequencer\n            </span>\n          </div>\n\n          <div className=\"flex items-center bg-white/5 rounded-full p-1 px-3 gap-3 border border-white/5\">\n            <button\n              onClick={togglePlayback}\n              className=\"text-indigo-400 hover:text-white transition-colors\"\n            >\n              {playback.isPlaying ? <Pause size={16} /> : <Play size={16} />}\n            </button>\n            <span className=\"text-[10px] font-mono text-slate-500 tracking-widest\">\n              {localReel.length} PACKETS\n            </span>\n          </div>\n\n          <div className=\"h-6 w-px bg-white/10\" />\n\n          <div className=\"flex items-center gap-2\">\n            <button\n              onClick={() => setIsLibraryOpen(!isLibraryOpen)}\n              className={`flex items-center gap-2 px-3 py-1.5 rounded-lg transition-all ${\n                isLibraryOpen ? 'bg-indigo-600 text-white' : 'hover:bg-white/5 text-slate-400'\n              }`}\n            >\n              <FolderOpen size={14} />{' '}\n              <span className=\"text-[9px] font-black uppercase tracking-wider\">Library</span>\n            </button>\n            <button\n              onClick={() => setShowGooglePhotos(true)}\n              className=\"flex items-center gap-2 px-3 py-1.5 rounded-lg hover:bg-white/5 text-slate-400 transition-all\"\n            >\n              <Cloud size={14} />{' '}\n              <span className=\"text-[9px] font-black uppercase tracking-wider\">Cloud</span>\n            </button>\n            <button\n              onClick={() => setIsSaving(true)}\n              className=\"flex items-center gap-2 px-3 py-1.5 rounded-lg hover:bg-white/5 text-slate-400 transition-all\"\n              disabled={localReel.length === 0}\n            >\n              <Save size={14} />{' '}\n              <span className=\"text-[9px] font-black uppercase tracking-wider\">Save</span>\n            </button>\n            <button\n              onClick={() => setShowExportModal(true)}\n              className=\"flex items-center gap-2 px-3 py-1.5 rounded-lg hover:bg-white/5 text-slate-400 transition-all\"\n              disabled={localReel.length === 0}\n            >\n              <Download size={14} />{' '}\n              <span className=\"text-[9px] font-black uppercase tracking-wider\">Export</span>\n            </button>\n          </div>\n        </div>\n\n        <div className=\"flex items-center gap-4\">\n          {/* AUDIO CONTROLS */}\n          <div className=\"flex items-center gap-2 bg-white/5 rounded-full p-1 border border-white/5 pr-4\">\n            <label\n              className=\"cursor-pointer hover:text-indigo-400 text-slate-500 transition-colors p-1.5\"\n              title=\"Upload Audio Track\"\n            >\n              <Music size={14} />\n              <input\n                type=\"file\"\n                accept=\"audio/*\"\n                className=\"hidden\"\n                aria-label=\"Upload Audio Track\"\n                onChange={async e => {\n                  const file = e.target.files?.[0];\n                  if (file) {\n                    const url = URL.createObjectURL(file);\n                    useStore.getState().setAudioSrc(url);\n                    // Analyze\n                    const analysis = await analyzeAudio(url);\n                    useStore.getState().setBeatMarkers(analysis.peaks);\n                    useStore\n                      .getState()\n                      .addCouncilLog(`Audio Loaded: ${Math.round(analysis.bpm)} BPM`, 'success');\n                  }\n                }}\n              />\n            </label>\n            {playback.audioSrc && (\n              <>\n                <button\n                  onClick={() => useStore.getState().setIsAudioPlaying(!playback.isAudioPlaying)}\n                  className={playback.isAudioPlaying ? 'text-indigo-400' : 'text-slate-500'}\n                  aria-label={playback.isAudioPlaying ? 'Pause Audio' : 'Play Audio'}\n                  title={playback.isAudioPlaying ? 'Pause Audio' : 'Play Audio'}\n                >\n                  {playback.isAudioPlaying ? <Pause size={14} /> : <Play size={14} />}\n                </button>\n                <div className=\"h-4 w-px bg-white/10 mx-1\" />\n                <button\n                  onClick={() => useStore.getState().setBeatSyncMode(!playback.beatSyncMode)}\n                  className={`text-[9px] font-black uppercase tracking-wider px-2 py-0.5 rounded ${\n                    playback.beatSyncMode\n                      ? 'bg-indigo-500 text-white'\n                      : 'text-slate-500 hover:text-indigo-400'\n                  }`}\n                >\n                  Beat_Sync\n                </button>\n                {/* Mini Waveform */}\n                <div className=\"w-24 h-6 opacity-50\">\n                  <AudioWaveform\n                    audioSrc={playback.audioSrc}\n                    height={24}\n                    waveColor=\"#818cf8\"\n                    progressColor=\"#c7d2fe\"\n                  />\n                </div>\n              </>\n            )}\n          </div>\n\n          {/* NEW: AI DIRECTOR BUTTON */}\n          <button\n            onClick={() => orchestrateReel()}\n            disabled={localReel.length < 2 || neuralTemperature > 0}\n            className=\"flex items-center gap-2 px-4 py-1.5 bg-gradient-to-r from-indigo-500/20 to-fuchsia-500/20 border border-indigo-500/30 rounded-full text-indigo-300 hover:text-white transition-all disabled:opacity-50\"\n          >\n            {neuralTemperature > 0 ? (\n              <Loader2 size={14} className=\"animate-spin\" />\n            ) : (\n              <Wand2 size={14} />\n            )}\n            <span className=\"text-[9px] font-black tracking-wider uppercase\">AI Director</span>\n          </button>\n\n          <button\n            onClick={() => toggleUiPanel('isThemeStudioOpen')}\n            className=\"flex items-center gap-2 px-4 py-1.5 bg-white/5 hover:bg-white/10 text-indigo-300 rounded-full border border-indigo-500/20 transition-all\"\n          >\n            <Palette size={14} />\n            <span className=\"text-[9px] font-black tracking-wider uppercase\">Themes</span>\n          </button>\n          <button\n            onClick={() => setShowPreview(true)}\n            className=\"flex items-center gap-2 px-4 py-1.5 bg-slate-800 hover:bg-slate-700 text-cyan-400 rounded-full border border-cyan-500/30 transition-all\"\n            disabled={localReel.length === 0}\n          >\n            <Eye size={14} />\n            <span className=\"text-[9px] font-black tracking-wider uppercase\">Preview_Opener</span>\n          </button>\n          <button\n            onClick={playReel}\n            disabled={isReelEmpty}\n            className={`\n                            text-[10px] font-black tracking-[0.2em] px-8 py-2 rounded-full transition-all uppercase shadow-[0_0_30px_rgba(79,70,229,0.3)]\n                            ${\n                              isReelEmpty\n                                ? 'bg-slate-800 text-slate-500 cursor-not-allowed border border-white/5 opacity-50'\n                                : 'bg-indigo-600 hover:bg-indigo-500 text-white cursor-pointer'\n                            }\n                        `}\n          >\n            Initiate_Theater\n          </button>\n        </div>\n      </div>\n\n      {/* SAVE DIALOG */}\n      <AnimatePresence>\n        {isSaving && (\n          <motion.div\n            initial={{ opacity: 0, y: -10, scale: 0.95 }}\n            animate={{ opacity: 1, y: 0, scale: 1 }}\n            exit={{ opacity: 0, y: -10, scale: 0.95 }}\n            className=\"absolute top-16 left-1/2 -translate-x-1/2 z-50 bg-[#0a0a0a] border border-white/10 rounded-2xl p-6 shadow-2xl w-96 flex flex-col gap-4 overflow-hidden\"\n          >\n            {saveStatus === 'success' ? (\n              <motion.div\n                initial={{ scale: 0.8, opacity: 0 }}\n                animate={{ scale: 1, opacity: 1 }}\n                className=\"flex flex-col items-center justify-center py-6 text-emerald-500\"\n              >\n                <CheckCircle2 size={48} className=\"mb-2\" />\n                <span className=\"text-xs font-black uppercase tracking-widest\">Reel Secure</span>\n              </motion.div>\n            ) : overwriteTargetId ? (\n              <div className=\"flex flex-col gap-4\">\n                <div className=\"flex items-center gap-3 text-amber-500 bg-amber-500/10 p-3 rounded-lg border border-amber-500/20\">\n                  <AlertTriangle size={20} />\n                  <div className=\"flex flex-col\">\n                    <span className=\"text-[10px] font-black uppercase tracking-widest\">\n                      Conflict Detected\n                    </span>\n                    <span className=\"text-[9px] font-mono opacity-80\">\n                      A reel named '{newReelName}' already exists.\n                    </span>\n                  </div>\n                </div>\n                <div className=\"flex gap-2\">\n                  <button\n                    onClick={() => setOverwriteTargetId(null)}\n                    className=\"flex-1 py-2 rounded-lg bg-white/5 hover:bg-white/10 text-xs font-bold text-slate-400 transition-colors\"\n                  >\n                    Cancel\n                  </button>\n                  <button\n                    onClick={() => performSave(newReelName, overwriteTargetId)}\n                    className=\"flex-1 py-2 rounded-lg bg-amber-600 hover:bg-amber-500 text-xs font-bold text-white transition-colors\"\n                  >\n                    Overwrite\n                  </button>\n                </div>\n              </div>\n            ) : (\n              <>\n                <div className=\"flex justify-between items-center text-[10px] font-black uppercase text-slate-500 tracking-widest\">\n                  <span>Persist Sequence</span>\n                  <button\n                    onClick={() => setIsSaving(false)}\n                    className=\"hover:text-white\"\n                    aria-label=\"Close save dialog\"\n                  >\n                    <X size={14} />\n                  </button>\n                </div>\n                <input\n                  autoFocus\n                  type=\"text\"\n                  placeholder=\"Enter unique designation...\"\n                  value={newReelName}\n                  onChange={e => setNewReelName(e.target.value)}\n                  onKeyDown={e => e.key === 'Enter' && handleSaveRequest()}\n                  className=\"bg-black border border-white/10 rounded-xl p-3 text-xs font-mono text-white focus:border-indigo-500 outline-none shadow-inner\"\n                />\n                <button\n                  onClick={handleSaveRequest}\n                  disabled={!newReelName.trim()}\n                  className=\"w-full py-3 bg-indigo-600 hover:bg-indigo-500 disabled:opacity-50 disabled:cursor-not-allowed text-white text-[10px] font-black uppercase tracking-[0.2em] rounded-xl shadow-lg shadow-indigo-500/20 transition-all\"\n                >\n                  Confirm Save\n                </button>\n              </>\n            )}\n          </motion.div>\n        )}\n      </AnimatePresence>\n\n      {/* LIBRARY DRAWER */}\n      <AnimatePresence>\n        {isLibraryOpen && (\n          <motion.div\n            initial={{ height: 0, opacity: 0 }}\n            animate={{ height: 160, opacity: 1 }}\n            exit={{ height: 0, opacity: 0 }}\n            className=\"bg-[#020202] border-b border-white/10 overflow-hidden relative z-40\"\n          >\n            <div className=\"flex gap-4 p-6 overflow-x-auto custom-scrollbar h-full items-center\">\n              {savedReels.length === 0 ? (\n                <div className=\"text-slate-600 text-xs font-mono uppercase tracking-widest w-full text-center\">\n                  No Saved Reels Found\n                </div>\n              ) : (\n                savedReels.map(reel => (\n                  <div\n                    key={reel.id}\n                    className=\"group relative shrink-0 w-40 cursor-pointer\"\n                    onClick={() => loadReel(reel.id)}\n                  >\n                    <div className=\"aspect-video bg-slate-900 rounded-lg border border-white/10 overflow-hidden group-hover:border-indigo-500/50 transition-colors\">\n                      {reel.thumbnailUrl ? (\n                        <img\n                          src={reel.thumbnailUrl}\n                          alt={`Thumbnail for ${reel.name} reel`}\n                          className=\"w-full h-full object-cover opacity-60 group-hover:opacity-100 transition-opacity\"\n                        />\n                      ) : (\n                        <div className=\"w-full h-full flex items-center justify-center text-slate-700\">\n                          <Film size={24} />\n                        </div>\n                      )}\n                    </div>\n                    <div className=\"mt-2 flex justify-between items-start\">\n                      <div>\n                        <div className=\"text-[10px] font-bold text-slate-300 group-hover:text-white truncate max-w-[120px]\">\n                          {reel.name}\n                        </div>\n                        <div className=\"text-[8px] font-mono text-slate-600\">\n                          {reel.itemIds.length} Items\n                        </div>\n                      </div>\n                      <button\n                        onClick={e => {\n                          e.stopPropagation();\n                          deleteReel(reel.id);\n                        }}\n                        className=\"text-slate-600 hover:text-rose-500 transition-colors\"\n                        aria-label={`Delete ${reel.name} reel`}\n                      >\n                        <Trash2 size={12} />\n                      </button>\n                    </div>\n                  </div>\n                ))\n              )}\n            </div>\n          </motion.div>\n        )}\n      </AnimatePresence>\n\n      {/* TIMELINE */}\n      <div\n        ref={scrollContainerRef}\n        onScroll={handleScroll}\n        className=\"flex-1 overflow-x-auto custom-scrollbar flex items-center px-12 py-4 relative z-10 bg-[#08080a]\"\n      >\n        <Reorder.Group\n          axis=\"x\"\n          values={localReel}\n          onReorder={handleReorder}\n          className=\"flex items-center gap-4 h-full min-w-full\"\n        >\n          {localReel.map((id, idx) => {\n            const img = images.find(i => i.id === id);\n            if (!img) return null;\n\n            const isVisible = idx >= visibleRange.start && idx <= visibleRange.end;\n\n            return (\n              <SequencerItem\n                key={id}\n                id={id}\n                idx={idx}\n                img={img}\n                isCurrent={orchestrator.currentImageId === id}\n                isVisible={isVisible}\n                onRemove={removeFromReel}\n                onMenuAction={handleMenuAction}\n                onDurationChange={handleDurationChange}\n              />\n            );\n          })}\n          {isReelEmpty ? (\n            <div className=\"flex-1 flex flex-col items-center justify-center opacity-20 py-20 min-w-[300px]\">\n              <Film size={48} className=\"mb-4\" />\n              <span className=\"text-[10px] font-mono uppercase tracking-[0.4em]\">\n                Sequencer_Empty // Drag_Assets_Here\n              </span>\n            </div>\n          ) : (\n            <div className=\"h-32 w-16 border-2 border-dashed border-white/10 rounded-xl flex items-center justify-center text-slate-600 hover:text-white hover:border-white/30 transition-colors shrink-0 cursor-pointer\">\n              <Plus size={24} />\n            </div>\n          )}\n        </Reorder.Group>\n      </div>\n    </div>\n  );\n};\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\cweir\\Downloads\\neural-canvas\\components\\ThemePreviewModal.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'BezelGlitter' is defined but never used. Allowed unused vars must match /^_/u.","line":6,"column":45,"nodeType":null,"messageId":"unusedVar","endLine":6,"endColumn":57},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'SnowGlobe' is defined but never used. Allowed unused vars must match /^_/u.","line":6,"column":76,"nodeType":null,"messageId":"unusedVar","endLine":6,"endColumn":85}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\nimport React from 'react';\nimport { useStore } from '../store/useStore';\nimport { X, Gift, Snowflake, Zap, Palette, Monitor, Film } from 'lucide-react';\nimport { AuroraBorealis, BlizzardProtocol, ChimneyVents, IcicleFormation, YuleFireplace, DigitalFrost } from './quad-view/Atmosphere';\nimport { FestiveStringLights, BezelGarland, BezelGlitter, TreeDecorations, SnowGlobe } from './quad-view/Decorations';\nimport { NeuralSentimentScanner, PolarTelemetry, GiftUnboxOverlay } from './quad-view/HUD';\nimport { BezelTheme } from '../types';\n\ninterface ThemePreviewModalProps {\n    onClose: () => void;\n}\n\nexport const ThemePreviewModal: React.FC<ThemePreviewModalProps> = ({ onClose }) => {\n    const { reel, images, playback } = useStore();\n    \n    // Get the first image of the reel\n    const firstImageId = reel[0];\n    const firstImage = images.find(i => i.id === firstImageId);\n    const theme = playback.bezelTheme || 'standard';\n    const customConfig = playback.activeThemeConfig;\n    \n    // Determine Bezel Styles\n    const getBezelStyles = () => {\n        if (theme === 'christmas') return { border: '12px solid #3f0e0e', boxShadow: '0 0 100px rgba(220,38,38,0.3)' };\n        if (theme === 'gold') return { border: '6px solid #b45309', boxShadow: '0 0 50px rgba(234,179,8,0.4)' };\n        if (theme === 'frost') return { border: '4px solid #155e75', boxShadow: '0 0 50px rgba(34,211,238,0.3)' };\n        if (theme === 'candy') return { border: '8px solid #ec4899', boxShadow: '0 0 50px rgba(236,72,153,0.4)' };\n        if (theme === 'custom' && customConfig) {\n            return {\n                border: `12px solid ${customConfig.bezelColor}`,\n                boxShadow: `0 0 100px ${customConfig.accentColor}60`\n            };\n        }\n        return { border: '4px solid #222', boxShadow: '0 25px 50px -12px rgba(0, 0, 0, 0.25)' };\n    };\n\n    const getThemeIcon = (t: BezelTheme) => {\n        switch (t) {\n            case 'christmas': return <Gift className=\"text-red-400\" />;\n            case 'frost': return <Snowflake className=\"text-cyan-400\" />;\n            case 'gold': return <Zap className=\"text-yellow-400\" />;\n            case 'candy': return <Palette className=\"text-pink-400\" />;\n            default: return <Monitor className=\"text-slate-400\" />;\n        }\n    };\n\n    return (\n        <div className=\"fixed inset-0 z-[300] flex items-center justify-center bg-black/95 backdrop-blur-xl p-8 animate-in fade-in zoom-in-95 duration-300\">\n            <div className=\"w-full max-w-6xl h-[85vh] bg-[#050508] border border-white/10 rounded-3xl overflow-hidden shadow-2xl flex flex-col relative\">\n                \n                {/* Header */}\n                <div className=\"absolute top-0 left-0 right-0 h-16 z-50 flex items-center justify-between px-8 bg-gradient-to-b from-black/80 to-transparent pointer-events-none\">\n                    <div className=\"flex items-center gap-3 pointer-events-auto\">\n                        <div className=\"bg-white/10 p-2 rounded-full backdrop-blur-md border border-white/5\">\n                            {getThemeIcon(theme)}\n                        </div>\n                        <div>\n                            <div className=\"text-sm font-black text-white uppercase tracking-[0.2em]\">Opening_Shot_Preview</div>\n                            <div className=\"text-[9px] font-mono text-slate-400 uppercase\">Rendering Theme: {theme === 'custom' ? customConfig?.name : theme}</div>\n                        </div>\n                    </div>\n                    <button \n                        onClick={onClose} \n                        className=\"w-10 h-10 flex items-center justify-center rounded-full bg-white/10 hover:bg-white/20 text-white transition-all pointer-events-auto\"\n                    >\n                        <X size={18} />\n                    </button>\n                </div>\n\n                {/* --- STATIC RENDER ENGINE --- */}\n                <div className=\"flex-1 relative flex items-center justify-center bg-[#020205] overflow-hidden\">\n                    {/* Background Atmospherics */}\n                    <AuroraBorealis theme={theme} />\n                    <YuleFireplace theme={theme} config={customConfig} />\n                    \n                    {/* The Screen Container */}\n                    <div \n                        className=\"relative aspect-video w-[80%] bg-black rounded-xl overflow-hidden z-10 transition-all duration-500\"\n                        style={getBezelStyles()}\n                    >\n                        {/* Custom Bezel Texture Overlay */}\n                        {theme === 'custom' && customConfig?.bezelTexture && customConfig.bezelTexture !== 'none' && (\n                            <div className=\"absolute inset-0 z-[60] pointer-events-none border-[12px] border-transparent rounded-xl\"\n                                 style={{ \n                                     borderImageSource: customConfig.bezelTexture.startsWith('url') ? customConfig.bezelTexture : 'none',\n                                     borderImageSlice: 1,\n                                     background: customConfig.bezelTexture.includes('gradient') ? `border-box ${customConfig.bezelTexture}` : 'none',\n                                     maskImage: 'linear-gradient(black, black), linear-gradient(black, black)',\n                                     maskClip: 'content-box, border-box',\n                                     maskComposite: 'exclude',\n                                     WebkitMaskComposite: 'xor'\n                                 }}\n                            />\n                        )}\n                        \n                        {firstImage ? (\n                            <img src={firstImage.url} className=\"w-full h-full object-cover\" alt=\"Opening Shot\" />\n                        ) : (\n                            <div className=\"w-full h-full flex flex-col items-center justify-center bg-[#111]\">\n                                <Film size={48} className=\"text-slate-700 mb-4\" />\n                                <span className=\"text-xs font-mono text-slate-500 uppercase tracking-widest\">No Media in Reel</span>\n                            </div>\n                        )}\n\n                        {/* Overlays (Static where possible, mostly decorative) */}\n                        <div className=\"absolute inset-0 z-20 pointer-events-none\">\n                            <DigitalFrost active={true} />\n                            {firstImage && <NeuralSentimentScanner theme={theme} asset={firstImage} />}\n                            <PolarTelemetry theme={theme} />\n                            <GiftUnboxOverlay theme={theme} assetId={firstImage?.id} />\n                            \n                            {/* Decorations */}\n                            <TreeDecorations theme={theme} />\n                            <BlizzardProtocol theme={theme} density={playback.snowDensity} config={customConfig} />\n                            <ChimneyVents theme={theme} config={customConfig} />\n                            {/* Static Snow Globe placeholder since interactive requires drag */}\n                            {theme === 'christmas' && (\n                                <div className=\"absolute bottom-12 left-12 opacity-80 scale-90 grayscale-[0.3]\">\n                                    <div className=\"w-40 h-40 rounded-full border-2 border-white/30 bg-white/5 backdrop-blur-sm\" />\n                                </div>\n                            )}\n                        </div>\n\n                        {/* Bezel Decorations */}\n                        <div className=\"absolute inset-0 z-30 pointer-events-none overflow-visible\">\n                            <FestiveStringLights theme={theme} />\n                            <IcicleFormation theme={theme} config={customConfig} />\n                        </div>\n                    </div>\n\n                    {/* Outer Bezel Decor */}\n                    <div className=\"absolute inset-0 pointer-events-none z-40\">\n                        {theme === 'christmas' && (\n                            <>\n                                {/* Simulated Bezel Glitters */}\n                                <div className=\"absolute top-[10%] bottom-[10%] left-[10%] w-[10px] bg-gradient-to-b from-transparent via-yellow-500/20 to-transparent\" />\n                                <div className=\"absolute top-[10%] bottom-[10%] right-[10%] w-[10px] bg-gradient-to-b from-transparent via-yellow-500/20 to-transparent\" />\n                            </>\n                        )}\n                        <BezelGarland theme={theme} orientation=\"horizontal\" />\n                    </div>\n                </div>\n\n                {/* Footer Controls */}\n                <div className=\"h-16 bg-[#0a0a0a] border-t border-white/10 flex items-center justify-center gap-4 px-8\">\n                    <span className=\"text-[9px] font-mono text-slate-500 uppercase tracking-widest\">\n                        Preview Mode // Animations may differ in realtime playback\n                    </span>\n                </div>\n            </div>\n        </div>\n    );\n};\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\cweir\\Downloads\\neural-canvas\\components\\ThemeStudio.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\cweir\\Downloads\\neural-canvas\\components\\TransitionPicker.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]}]
